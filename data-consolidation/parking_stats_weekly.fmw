#! <?xml version="1.0" encoding="UTF-8" ?>
#! <WORKSPACE
#    Command line to run this workspace:
#        "C:\Program Files\FME\fme.exe" C:\!Capstone\repo\TL16\data-consolidation\parking_stats_weekly.fmw
#          --FME_LAUNCH_VIEWER_APP "YES"
#    
#!   A0_PREVIEW_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAACcCAIAAADeaGpUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAgAElEQVR4nOy9Z2Ab15X+fWYGHUQHSJAgwU5RItV7s6plO3bkJicusRPHdtbpbZNNNtndZJO82eSfTdnspu06cdxlO7YsW1alREkURVEiRVLsBNF7731m3g8jQSAIkpBNRRY0vw8SOLhz58xg5sy95977HIQkSaChoaG5GUBvtAE0NDQ0hUI7LBoampsG2mHR0NDcNNAOi4aG5qaBdlg0NPMDQY9fXX8YN9qAm49ILPHCwfOeUEQKIXFjZeWV7WazGSorwWyuvLrt6vYrmxAA8rYN6+bFkr1HLky6gkouwU75kKqqSrPZDFCADVP+RAEh5s+kW5Z9p/rbe8Y5LLSGF0kmUwDgcjoVpaXUv9klXU4nlJYqAACAx+GEY7GvPfv0jTD5pgShpzVcK4e6hg51jaXTCQGbYT5/EVu2W6DbbwoAyq7gJ5IYU2NJNbTc+Ri0fafXVVHXXO4dHY4tXFR+diC4dOuWT24gnN4qxPyJ+3d/SDM0Rvsf37sY9DmEMoUierbzNAGNIFZW+E9bQ7ivStwoblV7GXboSwb9E+KtO/A+I8a8NOSqaLls0vbmaK+pH1/886/Ina7FTdXbmyXzcn1uTX74l6MWixnBsEqW/qwDZ42Laja4u94wK7dXgk0uLt9QJ9t7rINX17xcILebBq0hv1/gFyz5xTcUNnNtddU9y0rnPgbNLeKwSJIkSRJBkNfbetkshkGnA1WVcloxNgMLx2Kfumv97LWdH9K+ePQiQoJAwC9VlAGCZH/rtoN8etWX7QCphE8C8/Hbaj7gmWThC4Z/9vKJUDjCZDGaGxqT+Ny/Yx7bEJLPQpgckaP/4Le+8oUPb9Uty5/f7ezX2Ph8PivpY/G4RCo95y4YxkCBaF2x9q5l5ShKB2cKovgdVjQa1Wg0GIa1d3R6AsOH33EqNt0viPaGeBXCswPBpVtX7NlBvd1EWNzudPGDI5/7zOPZNQQCwOOlbDZb5loNTpoddjvJtoycZnliVhkoZPc+vkw9hyV8FhpLEXe0iD/8SaXTaYvFMmmyWVz+saH34u5SkxOvEsgLMSMbMZfhj6VViG1Jy8IPb9Uthd1uTyQS1GeSJGOxmMMfHrzUH7JbLTxl+K2L8u//dMesvwV18UtCY5vXr/17WFwUFLnDIklSq9XW19dTf/7s1//t8gVHBgfwEkHJ1JIYn2Bi7Jba5m995QsMxtXQHkEQoVCIwWDweDzkSmMqmUyGwuEXXnuT4Mh8Loe8rLwQYzAMLStXfWLnqsyWdDqdTCaTyeRLJzXc+gZxkgAAm0kLVQBnADbWUfXyGHggHHt4w+XbX6MBDsesUqlwHA+HwwKB4Lcv7vc47bLSmZp2M8JiMZLJ9Nc+c3/O9ng8HgwGhy5avQp1wK6PKmumnyEJkE7EUIzxiTVlOV9FIhGb3T4y7PHKa0UcLBDHpx8aRSAeDWEM1pObVcjUVmoGgiCi0ajd4Xi710NW1qpQSBMAAA6zrqyy1mHWQWVt5thiNunyBfmB4UceyO1uJ5PJaDTq9fnfvODk1zeUJHCHWQcAmd2zq0IBScRCDCb7M5srppuk0UB9PanT6crLy7lc7vQCDz7+dAmf53DYSwTCvCeVgcfjRaPRV577PYvJnL0kTYYid1hms7mioiK7vf1S+6hxeGi8vR8BaKpbXPqp26m7su3Sr7lx/tqy1sb6OjabjaIodWX4fL5cLs9b+eF+y9jRI5ESnWeI4Xak/RLF2uXK0k2357nNAQCAz0J14wMt5dxVK1cGAiAUkmNjY2w2++jx9uGTmpKVFYNtQ+jWJ5YpL/Q+Z0VViPrO5dBv18OqR++ttDiciO3C177wOQDQaDQNDQ2Zan/4s19Wr7jde+A/hvEF6QLMyEbMZdhcnpih+7FPPqTRaAAaDAZNa6sgEAjoTaaT/RcjOm86hpqTBDARSMlqWtVQublZBQCAIBD1O5gszpO3VfJ5vLY2TXU1xOMqgcCZTqetNvvB8+eiWkhbB7RrVzHeG0Dv+eyda2szh0YRJBpwMljsp7eoORw2dV6UAVu31lLjBwRBMBiMMc1kh7Ff2+ZgsZjuZApALla6/XY5MFkCXhLjmbQjCSY07P7uJwinJzJ+4vvf+hp1CI0GBAJHPB5PJBJ8Pv/9o21DXh7X0jfikoJ/VPzwLrF9szT9H+++5VRtudroDi/btnjXEgWT87ltVSwWK+eK5Vz8HDq6useDHIHl9LneEY9DKtu+cnL/oTU//+myGS6+JxRzDx39zGOPFvBb0QAUvcMymUxVVVXZW472Gk16TXl1XU5JnbcvHcU/d8fdiURCJBIVUjmOE3c98BAiEgsKM4ZZinBQ3h9//AsAiMVi2Uc51HYizVM5rGaoqasAiMeAc+XlbfQPJCKpSoRz545tXC7XarWKRKKSkikNxAcffyoRj6W53Jxm45zwFOxIPPLSL/6AYZjhmMHYZNQ/r9/y46cyT+ShthNpfpXTZowr6mqz2hMpIjlgaa9MiaUl4jt3bGWxWG3PvaAPK2rubtyR9Tz3Dw4bopyQ25FW16uyjptOxc/p94X73A/ec++yxS1MJjMYDE4cmQitDOUYQDGhM5670CusXhJwO4ipVVFoPedDfu/iksr1a1ZxuVyfz8dms51OZ45z6R8ctsR4LocVahqmVwIAyVTsvP6d6ID3gbt3L21dxGKx4vG43+9PJpMIguA4rlQqeTzeLJf03XO6gNuCq5vy1p8NBuk0gTaI4rU1NXOVpblMMU9riMfjzGmNbV8Mt9tPnnq9HdzpBb/+dubVZw9quQT/fG+XuqQOlhTksdoGHStvW207F12wvcLDeHjHXBMDjg3+SpIu6zx7VlVRkdNqu3PHtre6DAjL6zgwPmKxguq+hQ/UUU0kW9iAJdB6QYPT6QSA8vJyNpudve8Pf/bL3Z/ecOr/ehCRUrz0K3Oakc2FiVcjMdcbb++7bcN6rBnbWr0V+zGWXSAQCCbRdInoTOf32rWPrJSpt1AxMpSM2vxjVaIti5rq9Xo9h8PZ9uSnpkeOHR5fBFEyOW0nvnhQnLU7jqZcIfuGNVsrlKVms5nNZotEotWfWI0gCPw4j52Nteo3979fXRp09RqGX7hQv1UNV6qi8IbcaSJGEHgwGPR6vQqFgsfjCYW5nbKlrYv0500kYrW9NXBp6nWmwNG4K2Rf2bKmokxhsViYTCaXy5XL5dObWnnpHRgKRpmnXn6FkM39W/C5PG8kca6ns7amRqOBmdttNFcp5haWwWCorq7O2RgIhmKx2PSgCTWMWHZ5fkxB9Or9Tn80O+A1O4O245w097FN2wlCMN0jJlNpr9ebzzBAEJjdsPfOG3gcNoFc80iT2d/v8tg/uWJrMlE10wPjcLpIIBGYYhhBAjqXVbcgg2OaQSfiOvNqPylPv9uv+JfZ4u7OyMWRyQsrec177v347D1NmgzF3MLKG8oVCQUiYYF9uDkIRFMazV59B7fAgUJvyCEkpCaLVVWuBMj1WCwmQ1n2QSbj/PBnv2xaT3S+FhuzpGpFBY1XZpnkipKhi5cGW5oSAPkfGNorFU7rgoaukdMVa+9OGgzwg9VlMOm2zFjY6bURccbytS0AQHurAilmh0UQxHWtHwFALTjePGh+wYvdWZH+5c+P71m+cPOM0e4di5+0mfUEjns8ngLDZIWAogiCrMDx50BU7/GNed550euzyf7t23kDvTmsb9rt8odQ5wA9D2he6OjqRnkiQv/W6YPjmEQKJumqJYuhBvKOgdTXL/CE4yc7DoZDoaVLl94Ac29CirlLaDQa1eprmZV0jfTq/aE4zmCaLIb6ytyuZx5YDNTrda+uFTEwTCCYn1YeACSSyY5xv7DErtPWFmJGNjwmFozG1dyQXCbLCeTTfDDeajsn4HFica3NUlU+NfBOwpRnjctmRuPJO9Yv5nA4M03soMmhaB0WjuN2u12lmnOshoaG5qahaDsCdru9tJRen0VDU1QUrcNKpVLT5zTQ0NDc1BStw6KDAjQ0xUfROiwaGprig3ZYNDQ0Nw1F67Cu9yQsGhqavz/FPHH0+hEMBgEgGovyuDySJNvPnV6/fE2pgh6UpKG5vhRtC+u68ifD/5Ak2RPtprRMf7v//37zwu9utFE0NMVP0U4cvX7T3MfthIITmb4e+Li20JnitVJ8RQ3dtqWhuWaK9rG5fjGs7snYue4TLBbK5krTCA+pqLuiFBNyW7VQUQdWrbwiV2/LbdXKK+pwnCTxuNMvWVEzb/Z0XBwHgE3Lm+atRpoPSnvPuCMQX1Ynryy9ZiFs/qwyWzQUxemwCILAMGzuch8Ij13HYpBBr4PFDgU6TjC27rL29YZALlaycLsNK18OZO/YCblYyRIj4IdVYtnevvNCNTfl8CtEn7+/NuUe7joB2x+eF2MOnx060qstEUmO9+lFrSuVJi1U1dlNWqiqA5NWWTXFb1LblVO3KKvqAMhULIIyWI9uKEjrmSYvA+PGA92aWDQ8YqlCbV8+0LNtQWzAIm6uEJnCCS4Zb61pZUkr7dp2JeBn9CCsSqWw8hXiaFJyz2oZiT20QkALY8xJcTqsUCjE5/OvU+USaZnGMMkXSn2+yHCahLbDQAKAy+gGAEiZDzM5V/8E6AcAgPBgBBDUU7Zv7xhacs/uT8yXMYEEbjdOYBizSiG68Nv/DJWDWL8C7ztuDzYoN7Bk+05DK+tS57BA2CBWquuW2Xu/87b4qQqY+sxIYinBjhY5kx2PSym1YpoPAE4Q8Vg4EvQhBNGy9ndPrgWAh6YXK30MADZnS/ulon6CnuZcGMUZwzKbzWVlZfO+NAfHcZPJdHhC2G9mlMSHFSVnHT0hjQ1vEBeUriaWRDlMon1MVCcnn906P8Mddk/g1cM9oaBv5aqVTAwl59LwS8SBzZmyBSFIEkG8ur6qirJN61bPi1W3GolEIhgMxuPxjkt6t88vEQ4MtOEGR7papJDd9/iKWW4MBAGSFHGQJhmI509xqIgpToeVV2v0wzM8PLxw4cI3epAL+ssXrZY/6bKZy9W5Eau8pNI4BrgmUFWvZD27JfeVqtFoDg2NqjAUx3Ojb3abtUxZTpKAosiee++hNl66FOXz7dQKJI1W131mJKJmWA9Z5KLFC79cUAYKChaGJnFCJWYtqZwWQ9Fo/qvtZMDnS0ok2X0VKpsxjhMIijAw7EvPPDlL/f/1o58ipQryygBFTiZkLocTKTj18b/86KfMSpU4mcpUlUmhnKmZIHAEQb86c4UajeavbSerOexoPOFyOgEgu5JMPVwOOxKLz2SYRgOlpcGMQiyLxRKJRBwOJx6Pm8zmQ+2dFQvWOWzGsvI5XmLU0M2CusolVbS2T0EUZ5dwTrp7LhIEQanWTU9UAQAkAAKwZuXyzBafj2hqaspeosiO9AlkPFfP/567WFC6mlgSjbk0zMgYwGIAoBLnGI3GcDhsslhGXfZg1+hYutLEMItrd9fpOr3r1VTWnBUyuXdhrSjkAhJxutylCjkAcLnWurrLMpW1tbUp2ULn2VfTCpC1es786JeUMWWbb59TXgdFSQYJPZ1H6+/e2dVlq97RELp4kcFgaA2G7vHRK1lzvNlZc6QBnb+5tgyBRNBJosxINMrn8TQajQEaqkFTV1dnMpni8TiGYSc7OydYodgrgfTdCW1HggkNizdtYzbXZjyWiEPG7ZbDA647llx2Gm1tmuodDaDRqNVqKhdkOBwmAU51duknTKLUAijpP31WpKwEqGqEQaPpStYcqmZ5xIuTiFZvqKupBgCNRlNXV2c0GhEECQaDLrf71PkzzMrmtv97y115T0tryM/YXScwa/svGX13qRv29p2vX6w0DrVzWn/0UJnbeXzEt31h3oTYGqGwYbpmPI/HW9DUFGFVtL32Cim1nDvTNXs6JRQBgoTh/nMKVmt5WW62NJrpFGcLS6/X10zLREKSpE6nwzCsu+fiUNSkP1WeE/uUXsmoCgBiVspqcwrCI8888Ri1xefzSSQSAHj9AlAtrN7Dv37yccX+X5/hKsvFS7+8bc0cVvVZ9rGjLHdkfalc9sklfh6Pr1DIASCdTsfj8T+8sHfBxgeM4/1miwXKKrJzVJAEQSJQ17AQQdEHVikBIBqN5uRuOdhrmRztJ1W115qbEENRnCCGzx747je/evrUq9XJVOcFa8X3v7+dJH/9+/9dtuPhc6ePup1OHyhqZVN2jBORjRt2MRms21vlcDlJl8Hw6ruWVXdsuOuuhisJt9vHQwjAvtefRxTlsqkr0kmUJPHkytVb7ll19YXR1vYCZYPqX/5lB1WMJAEAQZDjowGjdmygt5uQl021BQCAIMgkRDds2MVAmVfcn+bgbyYav3pXw5V6SJJEUfT4aKC745jL4cBliun1AACgBEmkV6y6Ldswikgk4vV6p7/hppwXSX7/579HKipK55rnSBI4gmLrW6tXL6cVRwuiOB3W9EaT3+93u93V1dU4jrs9npNmNgD4PU4SCGTaXUWSIOQiOMp+cuvlvp7X68VxXKFQQJbD6j/63x+/ayOLIywwDcWA4YCipNQb3VRbpvjSxzjTCxw4fMyFlvGxs+f2E2C1wme+QaUwSCZjb3f+yzrFzo2LWjAM4/F4HA5HqZzimv7WpR/pfVvTPilvvV22akvhsu7JZOCdzp9tqdi1YUlrOpWqq6vLzsqz9613YoI6HrbvyA9T2WlvEin/6yf/bWvpneuXLEYABAKBbGbN0sP9lrGR45HxiGdqopo+05tGw8gKzuItGzYAAJvNRhCkqqpqFqWNl9tHU+EhW6/LMy3nDUHie09+Z6Vw4/rmFh6PS2m6qlSq6VlCRsYmOnXREkbX+ffI7Ouc4ZzmRZ/TsozbumHNagzDsoOhPB6Pug1moUcfeunlX6JhGRL2wqy5c6gWlmu8846NK8voFlYBFKfDymlhxeNxl8uV48LOjnvfeedA0uM3dI6v2nBbJqMqAHRPPk94kU3q1trqaiaTSZIkn8/P3KYZh1WSHK4tf7fnrZTJVVD2h+MjfyiJCBLp9dU1df+wM/88nZ/84jc8Pi8WjWVvxAk8wvZ/9+lvlrD5CILk1V8/0Dmk1WqIa/8xcSKlcfd/74nPy4UynQ5rbs59vP/80mtMJiOVSmdvJIEM4oEvf+ppBlaQt/6/F15BECTXE2HpaCr2pSeeKdzak10X9DodjudJJU0QRIgIfv6xT3OYeRIy5/Dnl16jsl7n/ZZkpGPJ+JeeKCiylmd3knzwiWdQFJnz2SIInCEn/vSTX0n4EjrTVyHcEg4rbw/x7QNHekb1ZWXlCJo7Y8viHeWyS77x6GOxaHT66zTjsACAML/r97iQ0vK8cY4cXKFRdWVTlHNHfRljetD9Q/L6mUnt0YPuSob7mPWa4u6xhPfNUz/cXnH3g3fs8rjddPqWD0+vPny0/VXEbD83OMebLJmI7u/599XCbfdt2xoOheiLPyfFGXTPnjU6PdxDoahfkRru054eMF4SrvrTlBwz+sFuLJy+0NNVK24MKKYl5LpCJd8pbMEu7Dtuc9anfF5EskDms8n+dcZ0NbHkpoBlYMzaaw6xYUshSW2ugf7jb04adb5+HwiEoZhN9/MjBe6IIJAgiEefvYfL4UrE1zw/m2Y67Qdebl19p1tu2b2bSlKdgBmWXTCZ6CPrfth99FWhQCCX5Y+n0WRTnC2s7IWEsywq/P1zfyVIAp02dymJxZkY8wuPfzbvXu1j5Knxy5/72/9KIs6Ir7SkgCcdwbDyqiZFzZqlVXDvsnluYb3RqQ33vdOPTg694K2+87aSU0bGnuULZx6yzEBNa/BrupqqyxY0NtK5cz48vfpw++u/tYjjnh4SfLqQuar2ify/BRXDilgGF1VJKyoqxPQLYy6K02HpdLra2lrqs9lsrqysvLH2/B0IRaKj4+MImEwm9axDWLkQBImiyCp6lGpeSaVSCDL3w0WVoZMPFE5xOqxM0ArHcYfDUVFR+DxKGhqajy7FqYeViWFZrdbycnpBLw1NkVCcDitDnqF0Ghqam5Yid1hF2eGlobllKU6HlXdiIQ0Nzc1OcTqsTMOK9lw0NMVEcTosKm6VTCZZLNaNtoWGhmbeKMKZ7oFAIIaiAOB0Oq/3EGEkljjRO8FlYTtWL7yuByoEu8d/ftSqFHFWtxakz0Vz/fCHIu90DEdjiXXN8hI2GwAMBn11dU3WB73hJMCWmmzZNgRIEpDG+tobYvNNQRHOwwoEAkKhEEGQ6yTjl82Lh3vP9o8qqxqRuI/RuCyjTuM066CyFsy60spaAJ2zC2BdbXbaQhEXc7nccqn4oTXztkb/P187oTFYKmqa2OkwXt1aatY5AaCythTAedmSqzjNOqgEmGaYjIfZnK4Glez2xbS++AfnzfbBY529AomcnzZ2m9JNSqW3/UiOvjt47CADf4fNX02KA75gcPO27+/CrZYaVdl9K69VJehWoQhbWCKRiOoMFuKLNQc13UJXJSAk5C+MAJAAWzauz/ttIkV4HOZIwFcrY47/qX1s2Qqizxj0T4i37sDfP4MxNcdTDapytRjs0Hl+7PKtCbBs93KLHrYsSqWTeUzSaLodLhUlITgVi9lcoVIhCLJs6RJRSa5ofTSeDPk8k5GeJpGv+80+wfqJiH8H//13zgGAsqLmlXf0W1dU6XpNgax8GWAXXzXMFwxu3v697Xg6SUw/Ns21wETIZDIe8DlE6gW7F9aTKMCyGfTSVl3+HyERSTrpZbGZzCJ8KueLImxhwRU9rLwiDQCQSCTsdns8HrfZHQMWg98ccOnQEMPsD8hrRBNG0+ZlX7+q5CfhYlaLUaGQf2rT5QWJgQBQ6tskSWrN9qMXJiNe25K121gYmSamCD+kUpB30QUDxdMEquYEsxv/FoslEoloDYY+uyPZPWxLMjUxUcudG6RnO73rWf52Jd5Q2Qha7m27MLtJIBA9s+Nyv4+SJSFJsndYe27ckfZbW9ZsY6JEipgjb9B085gIniIxNSdA90o+AARBuN3uWCwGAMkUfn7MHPU7nZOOcGHS1WIu5o/hmLN/1/YtfzebbzqK02FRC56ndwnj8bjZbObxeBUVFclk0uvzDXsYrghEvBadXo8o1dN6QSSXhbG4AplEcPfSyyKggUBAJBIZjUZKvpLJZA6NjnUe749WM6xHrDJRS/Pnt88eOSthoeEk0SxONNaqASAQgEjEKpPJSJIMBIPnbMxYkvC7LGajHimfYhKJkCwGVlIi5HB5e1ZfdqoajUYulwcCAQRBeDzeuQu9F8+esfIUkXcuyb7z79uuZV2hkIME4+TaKlap/LJeDqXSiSDIX37/Er95scNiRFTqTHfFbjEqVWoA4LAZwXD0kdtX5dXqykh9vvHSu9y6+lgilbM7BROFaCL56K7ZEmFQ6Sa1Wu1BU6SGyYwnk5mqIGMYgtgtRnVNbSQaC1rHnv3Mp2aq56f//bxw8UoFSbgsJgAAFUA3wJqr9VDG4wQe9nmeeWhXXpM0GuBwzDiOIwgil8spaRCSJOPxuM1uH7KnfG6n1WIqK59jQSuLhSWT+JP3bp692C1OcTosqm2VozsajUadTuf0NtfhtnY7lJ75vxOE3FMyEi/79VV9mEBy9PCpF5eyWh+45+5oNMrlckmSLC8vz9bkBACH03V8LABjB3v6xzwOqWz7ysn9h9b8/KczKciIuFgghk92vPH5Zz6LYRjlAbML/Pr3/ytdsNFz7m9D/eL6rWrI6HwS1n3tv12Qanr4gftjsSifz+dyuaWl2TEo6OjqNsTFLN3Rc70jhRiTjZiLuUPxwOiJdatWUALtFouloqLibPeFbvOl8AE3PLsLP9QbYiKQIsXK3WK5Vrp2RymAjIvYrEZVedmDa6vgii67oa1t3bp1brc7GAwGQ6HTXYeG2+3ipp1o6cFjL8QanvjaCtDC2quNWQ4e8oejjRzX3bt2AEBGJB4AZDJZMBgEgGAwqDeadH73RNcoIq1EY4TenhSIAKpYoUFpTevRTM3CbbcjFpNUJn188+VfXKPRKBQKv9+fSqVwHO/tHxiL2yaP2cMgJ/2j4od3ie2bpco3vG3gXwD+9zrQmjXqO9VwKCn5xGIxYI9vrJBK8qgpaDSaWXSs9nZoYgPvDY54ZS0VY8etlrBr+wy/BdXCMpx7+9mnZkvqcYtTzA4ru4VFkqRGo2lsbMxb/j///GbY7xFKS3O2R5M+R8zy75/5Co/LjUQilKZ7Xv7w+rFQ0IPLy3OryAeDhSUTqTvXNFaqVHClyZZT5qIhyGYx0/iUXyeeCo04e+5pWifgl2AYNlOy2D+8fiwcdKflFYUYkw0TQxKp9N0bFkbCYQCD4dVOy6pVlED7z3793wRBnOw4AwIBGkWyFcaYHBQ4RGtVyz997UsYhiEI0tb2QnVS0XnhQkaXneJnv/7v/sHhoN+X5ueq2KACYmnTEjSNfPurX6TO64pI/FUbILeqoaDfP70qAGCwEeDgS6qXULUhCJKj707x89/8D0mSbSdPYUJR3jSWCEKCAF9cu5hBYt/5+pez24/RaNRut0ul0tk1Yb7z418M9V9McXlzqvbw+ZxIJP7an38/XdOZJkNxOqzpXUK9Xl9VVZX3CT/c1m7BpV1/+YWHXL2qRpmtleyIXDx29uXVrJVf+oeHzUMh8RJ1XjE/h9N1qN/hNJwYOtLNqPj6+qfrZleHcMb6jp1+ZRVnxe677ojFYhKJZB6nX3R0dY8HOV3P/4GQKcWzCopPZ8j6zuTk4Ereku2bN2IYltOh7hh1d/ceSE7G3OYpeuoa1/EhzcmlsORju3YmEgk2m11ZWZn3UjucroP9djZypuc9yBFTP3DxJ+Xp6s2NyxQyGdWrml09/eiJk5a0lI91ntufR5fdGbl4ovuV5djK++6+i1JwZLPZOSr4FP3m6KFjLyNmwmmy5IjEA0A6FX7z7L+tF+/cvHQJiqLZSpDT27bKy6QAACAASURBVLZ5ee20RnvpvfF2zZxa+1daWH979qmn5qz2lqU4HRalgZXjsPIG4Cmef2Uvk8lKpaaN2aFEOB3+0qfmFh3f8+mnORxOPJ4oxDyMjyaw8Ov/+RcMw0IhVCye5yG5PZ9+msvjx6LRa90RE0ESj+391Z91OqypCZ2+bvxQ2wmSIJCpgSoSyEQycd9ddxVyiENtJzAUwaeJzydTia2bNwuvJV/3obYTVMqf6V8hCBmNx+//2McKrIckIe8aeZIgY6n4/Xfd9YGX0B/rMyeTcUDmGAABgEDSYnBOfm7Lx6VSKa3vPhPF7LAyMn5Wq1WhUFw/mTSH0/V+n81/odNSCoVIqttDPe0X9q5krPji554Jh8PT+4Mfho6u7vEAJ3Jxfz8hT7/XL//+T3cUnEHnovFNi21sFXvp5nXraH3xeeH1MzrdsQMu1dxa+wbP6Unbxaao+pnPfmb2uNitTBE6rHQ67XK5ysvLM+LI2QKk14l3z44zGZjFbISqmrnVAok0Dsi6eolUIsk7rPbhjWFgiNViLsiYLEg8iZPoxgVysUh0PQy7BTnYa3F3/27fCR0qaahTleOnTNie5S2bd05PcMvGiASOiuP6SlUFnfJrJoowvBeLxbhcLlwZuoYrSwuvHw6nyx8nGJMvvXtEg0kaalUV6Vkl1alRwlffeH3T2tXLly/PV+SD09HV7YsJuIa97x4cxyRSMElXLVkMNTBLSuoMEi7mDsbeO3h4WeuiJUuWzK9htygIVr3tH7+41WAx1KmqAR6asSCbzUzGiWQ6Ta/Yn4UibGG5XC6BQMBgMBwOh0qlCofD8XhcLpfPveeHwGq3AyAA2kIac1TEpCJfDHi+jEFIhEQKMiYbhERIhLx+htHQfEiK0GGZzWaVSmWz2RGRsJzPnz3cTkNDcxNRhF3CdDqNIAifzxPx+QBAx2JoaIqG4n+Y6YgADU3RUIQOi5qy6PP5brQhNDQ080wROixqcDAzMkh3CWloioYifJizhxEIgrjeDisSS+B4nsnWN4RQJHajTaC5zKDGNKgx3Wgrio0iDLpTHopqZ7lcLqlUWsheGo3mf/a9V8XlmkwmkMtl0wpwOOxoNPav3/5G9sZTFzVvHu/h8vik81KKz83s5XG7QS4Ht1sml2f/mam5hM8LhsI5tX1IXj/ae2pAw2WhDM94vIQnc7s9ANQRPVcsyZBtUrZhPC4vHJlnw25B2rpH3zs3KhDJTo96KquqAcBm1Jar63I+gLoOjFpQ11FLSblMJBAKP7h2DiGaW5kidFjZLaxoNJp30nA0GnW73VRhv9+vMxgvasZJA9JjNSvWEvozTp3HLb7ns3Vrr8oHS3io3aJ/5Yzx0Y1Xl7qMWALhkD/g89SXVkxcGPNlK472GTGmd9AqVZWziJEUuolBDDuDYsIH4PfLF3/nY2Vux/ER7/aFBfnTQhg1e5PRcCyEq/nIyBnCvd4T8e/gD/TqAEBZQZ6yTlUcJTGS4R9xRoBs2UTqzxBkpVtvkC/+1u0Sl/t///rSM5/OIyNFUyCeKO40az12M1HKfPdURz6JZK+3Y8AGipZNMs8bf8MA/H75ku88JLE7fv6bd7791S/e6DP4iFKE87CoNc/UvzmSWADg9/u9Xi+fz5/uyH7ws19qJnV+v5eYpliCMAFhk40VjZ9+9JF6tQpBEEp39PiFsbdP9fP5fN35QwgQBJ7O3isSBn5JnmSuGMZgMrGaavWPvvut+TprAHjp8Lnzw2YWA7VcOk4SBD7VmOlQ5kGWi0dRjMNmV1dV/vs//+M8GnYLMmlyvnK0NxaL1FeVKWRypJC4BJ7GAdIe7Z5777n+Bt6sFGELi4J6CDkcbgAgs7bYbDZzOJy6uvxJZZYvblEv39n1/GmiJFfJzxzsOn3+LRmDj+LJkZERuVzOZrP9frJSiHxm28LhkUFB5cJ4PWY6MLcSLgCIuIxALF0B1pkK+AMB6hTyLiqitouzlkxHIhGXy7WiSrCofMG5c13SSoWFpwy/dfGaVj4DgICNhRL4lnr29K9GjhwjqqpMJhPkTeyBAJCwcEF+ubHsSmC2tCAkADJnJQCg0Wg0OFlN6e0DAIDBYJhm2Ny1HTpyDKqrqwjCZDIBAFRXw5V6MhWSQCIz10PJKgQCAZ/Pl/1jITj+6JbGkYmJgXN9k9XMQiSShVwsGMPXNkyPRtBcpQhbWNTUdmrBc7Y2nt1uZ7PZs4jwAcA7HSMOm7G8Mnc9SyTt0rnGvnj7Q0KBIK/e3tunhphM1Go2l1fOnacHIXGCRHYuV2f0lQIBEApJl8uF4/ioRnPKcNH3ut2/qcI/mKyZIusOjZCUbN9F2B0VCtlDa5UAoNGAUhkuyWoU7js9zGAgBRqTY1gymbx3c6tOp6PUPq1Wa21tbc/FvmPDneH3PVMVR1eI5cnLiqM8NObrE0hb719VDtMUR2OxGEGQ7x56cajdnaU4umcFJLMVR3lk3BcKN7Dt0xVHlUqlx+MBgEQi4fb5enUTY2eGZ1Yc3bMCksJtt5M2a6lM9tjGyyEhjUZTV1dns9ni8TiDwRgeGz9nH5mqOFqJpztDHW68GkIGLYqu4VeBun4To4ZVJ5N9enMetWlKVsHn8810Xx28aGUzMLPFpFLPkXuNgeChSHRxKVKtvpaXzC1GEbawqBcd9a/X66WcSzqdjsVieSXcMrzz/mE/u+rC2y97iFwlv2jQZA6MvPjKa59/Zo/fEIIlUzyWw+kK4xhj/Oh4/9jZgiSSGQ6Pb//7hx7e88CVbQGvN81ms0mSZGGMUtWesm9iAABrAQBgT20pADx2uagMwDal5aUpKbkqRdLR1R1MlnA1x8d7RwoxJhsBGzOZdJ1nu8qVZdXQZnj13U7eDskqWWNTk0+2DjZDPBaGT6102UCRURtIRUkSwZlYElGyWRkBn044eLJ7n5Xcvn1ndXUikfD5/bvveap0rZCHxr2R1QtWZO0OAAAkCewSFjfN2bB6bcYeyoZu4R33faG6Wa1GECQWizFZrDpWLb/qDi4a84WJBciVN+4KAFh/pWZEkIjFuHwOO5NJVzNxYCL8ZGlLaSmGYfF4vCaesPOXVddDPB4mCUAQgFIAuB8ytgEAIHwWEosn2fm0iXAcp+6oWd6C8WTKdubVS8Ne46Ly8ZM2a9i99Sc/XJr34nOwaCTq8iRohzULRdjCotpWVPQqozCj1Wpra2vnlG3QaPWQ1dHIQG1rqKuZacd3zhsiHkda3TBdNmQ6Jn+P1Wn4eOP6yoqKdDpNkmSOdmU0Fus3hnoGjsRHI06LFVT3LXrwshJmIDVxfuDIqpKWzevWRCIRBoPB5XJz4nH7LxjDbnuBxmQzZDuaDqfvWbhaKpUiCCKTTemenB33dve9HxsL5yiOuuJ9F/qOL0JqPn7nHdFolM1mq1SqmRRHj48FIHFsuuLomYn/FUQkWxqXyKQSKl83n8+fZcn60RMnnWgFCz+eV3E0guuOd73amK596N6PRyIRDoczi+Jo26k30tp4XsXRaNpw7NyL9fHqhx+8PxQKZSuOkiSJYVhlZeXsN9XfuoxjvW8Vojgq5GI2u0MYN+7asX2WCm9xirCFRTF9+mghIjOzuKRZSCST4XDEoO8cfe43WNkX1z1ZO3sMy+/3pIiky+3hcxUSCXO6KDiPy21//7llWx8QrRDkzPEKRUmRRN5cXScQCBQKxXT9b7fXHwwE259/DpeUiZd+fvtsOWimGRbws3FOOBJxuwWrV+c6i1MHX938sUeYa9g5Hj0ZL2ldtPKu6lVSqVSpVM6kNA8AZaWKSi8iKnmioSF35lqFsF6pVC5atJDFZHI4nDlNvX3bljNjHiH/UzVfy/PGZUS4Lc0r723YJJNKlUrlLCrppuGutSvv4Wxi5xMuhXCc39yw4sHmLXPWMxNkPFBRuUL56AoAgOSATTNjSRcDiUVjO3atoeVGZ6E4W1hqtdrhcFRUVFBjhX6/H0GQ+RX2zMbhdLWNBhwdxwpUHNV62oz6iVWCBbt2bJ93qzq6uvUxke/cGx9EcdT0asKD39m4RiGT0oqX88LeDo2+7VAhiqOnx/5IBPCNZcsWLmiiL/5MFJvDIgjCYrEwGAy5XI6iqNVqraqq0mq1M40Mzhd/eP0oj8+1GI1QrpozM4HdPxnHY1+595OK66PS9cc3jvG5HJOpIGOy0bkGeJySr9z/UEmeTDQ0H4R//dlvJsZHfT4PCISzX1OEQ6ZT+FvP/eV6603e1BSbw3I6nQKBwOVyqdVqm80mk8lYLNb1lsSisuawDK/vLVRxlGF3eaP6s63NC5YtKyQafg1QWXMElrdevnbFUQEbM2jHlayQQialFUfnhddOa+KXnt/Xrp3zxhByMaNBzwnra9VV835XFA3F5rAo30TF2qm4eyAQCBCEetbZDB+en/7yv7hcbjxu8rgVsrmaTTweLxKJfPurXywwsvYBjOHz+dGooRBjsmFz2Mlk6ttf+QJcf13pW4TBUY3JZCTBbLWoKmYdBEFRlCCIj92+Y7ZCtzzF7LCoAFbeaVM0NDQ3I8Wm1kD5X+pfqo2QSqVusE00NDTzRLE5LGrgOdttRSKRG2wTDQ3NPFFsDoskyWg0WlJSEolEqGl+dCyGhqZo+OhOHA1GYvtODUVjcbUgyWUxLAAbp430UfmyaqvVWVtIp9NZU1NDBbNIkiTyzgikoaG5CfnoOqxjvZOdfSMiqdxu9fqlPn278lzDQKBjCG1uAbu07qkdpQASVtrm9jCOtH3pmScBwOVyKRQKSuiKwmKxqFTXukCFhobmI8pH12ExgEwl416Xrbq6YYFya/MjAACw+v7LXxNpIEmSADaLu3Dx5cWksVhMoVCQJBkOh6n+YCqVYuZbtkpDQ3Mz8lGc1hAMBn0+XzKFX5iwhb02l8YRrmZMVxQScLBQHN+oxoRCAbXFaDRSc9zNZnNdXZ3D4eByuUKh8EadCM0tjtnhSabSdZV5NG9pPhgfIYdlt9vj8TiCIAKBgNLriMViNrt9MsBw2MwWs7msYorWNRODFA5P3rOB+jOdTtvtdhzHS0pKUBRls9kulyuv2Nz80j9hevXoBQRlsII6TC7OLIVxOh1QWgZOR2lpGfUn9YHFYsXjiS88/enrYcyJnvH3OgbZTIwb0ZMySanT4QSA0rLSLAMy5FjIwLBUOv35p66LYbcgPSP6V9v6WdySugoFdR9ajFpKFWv6BwzBY/Hk3ctnkz+igY+Ow9JoNEqlMu8SttfPaKP97wyO+GQtFWPHrX6JYu1yZemm2xdwMJNeK0fct+/YAQBGoxFFURaLlUgk+Hy+3++/3usHKV46NnDidBfGZqkEDM35YSxX1l1jSTWoytV1st6LZ0HUtHv57nLC4SoJjV4P0fRfvXF6eEyDAFlZgk/06kLlPhTbwTf3hgBAWVEzmiPrbsPKl4tlvYazIGra3XKHjBmOLpVEtm3eMO+G3YLsOz38btsZnEgrZawBSyyfrDtLCpfviqV3lyG+QA3Dft/dd95owz/SfCQclsVikUqlXC4377ff/fH/u9R/Mc3j5TgzjpAVj8X+/MvfJBIJDoczMTFBkiSKoiKRSCQSZbScAoEAzDrVPZFIRCKRt09dklYvLmGj4UT+UUUeC/X5A6USwfZFU9JGtHWP7jvVVyKSs3E/i8mCqdfT6wZp1uIYBEGZDGRBy/KPr7ouQwGvHb3QOaDlCUTMuItXIiLnGiHNmEeS5NoNmxPJFP2Sny+0Vudz75xNpQkyYDBohomZHzQMxVhs1vpVK69Tu7uYuPEOKxAALjdJabblZW/HpGZg/0T7ZI4E2onh3zLCTJ4TLnR1VVRUlJeXNzQ0LFmyhM/nw5WVWQiC8Hh8hUJuNBozs0kpwaZMCvt4PG60WEb6+nr6PaINDyiCachKlpNBwkOtZoOyTPnIhkrKbJEIjEZjKpXS29xWk8Ew6ozVMS0HZ1Pvzoim82bwzh8YHMeNRmMikTC5AvrJMZdBZ+UvZ0xcYMDcGvMAwMJQDIWtC2aL93l8fhzHSZJAkHzT90gCELQ0T4K0KTjdnnwKiZehvpqzkkxVlHD77MXkUsksuSkjsXgkEpmpmgLtoTRCsifQIAiC43gqlRrVaNwJ7dgppjN6CQtsWf/9PL8Fl4Wl0sTti+gFZHMzDw7L7vb5QtGFtR+wyTCLHjbF8X5zLB6DaQ+JIXgJj+L/cOfHYzEW1YIyGo3BYJDFYtXU1MziAWdi/8HDIKxxWg1kdX3OXRVOuvSukWpcdO/dd7FYLBRFfT6/VDrF7Mc+9yWSILxeT4lgxseew2Ylk6nXn//TTAXS6XQ4HDaaze8NhIjKOjUTi6fwnDJOs66hocHpdEokosc3qgBAowGZzCcWizOzZB984mk+j+t0OmcxJhsUQT731Gd3bl5H/ZkRZd+8ebPdbkcQRGcwvtFxFrN4g0HES5JwWdZ9t1iupWTdJVws6h3miOofWa/KrmHbtm0ej8fj8ZSUlOw7cKj7QLeoaSdWera3I8GEhsWblNIsWXcJG7e5vJLw8Kcf+USOJdu3bw+FQsFgMBqNJlOpEz2d4+d1qLQSyS/r/rUVoOVvuZ3hcgkEgs9uuSzHTkmwx+Nxl8tFEITFZjuhOTd6xBFHFRwBiXHdoNxdl+7UDLrRZbvr0iDY2oA5nWKx8IlN+XMFUmJ7ZrO5oqJiJrfYrfH4QzGrxahS5+YKoEBIgsCTm5rLshVNafLyYac1jOotr53UcEWSI31WIQcDdV2eFwgT9QWC1bzYspY8qUc8Hs/sDssTSWuPHp4ugWa36hlJrONs18plS6nMOGq12uPxkCRpMBgqKytn6mPOBEmCP453vz1ByLpysuZE0wZzcJQXrfN6vS6XSyKRlJeXZ++L48Qdj3wRxo4MDE14ZlZSF7Axk2Gy/eSprVtuy2wMBIDPT1ssFgAgSZLBYAQDASJtJN5493ScqU+IWqbkoahsBK2toQGIVFaPTyORXJV8G53Q7H78axxj+/k+chZjsmFhqH2yb3h4ZNGihQCQEWUPLFt2d1lZMpnkuVyL1j6KoBiGIThOOi1QevkNdfkhRBAkjXCz3iuXa0ht3ryZxxMIBIFAgMcv2fDNH8lLmO7wlua104wAIAFIAF6JIGvb5Xoia9ZsxnGlUplMJi0WS4mosWXP7jIh0xFMNWfKrgWAHVdqri0B8EypXjNxYCLylLIsHFYqlfF43Ov3K6oekj2F8ZhINJV5c9eWXrFNBOCY+ZVOEEQ0OgiwpLJyttSnTn/UevaUhzk2eJjhdqQzQdjMk8JlYQ6TVm9MLGpunqUeGvjwLawj3SOd416LblQiFyRjTu2+DkbNGvWdjzVntbekXEh5u6TlG+9amqt1Mj4+Xl1dzWbnySuV4WCfzXX2t++061FJfZ2qHD9lxvYsa9m8swYj/V5fazlDwOcrFIpM+cnJydra2omJiQULFlzr6bzTpdv/q+8H0bVrapRlj+/MnEQgrr+oaX+w+fali6uMl4LiJerpzff3zus9djNZPZuS+oSrE4+SD63ZVMLnl5SUJBIJh8NRUiLIaawBgC8Qemv/e/JGfPLo5OiwpHFrFVRvWaEGAAglrefHD26VrVq5fGksFkulUiwWq6Jiypvi3W6d32HBZzUmm0vWI0p25V3LlrPZbA6HE4/Hp7/tU6n0c3v3S2sippP6kcGUZOFVpflwWnd24N0lzObbt2wOh8OUPXlnwCWTyf091pi/x3JhSHM2LfnyN3Ze6eP3m/9GBJDb1IuUpaVUt53D4eTNg0uhM1oumJJk7Mj590iwWuHJq1UBQAJ3nBx8pSnVeM/O7eFwiMPhMBiM6bOIcZz4yX/+ummdzNphHL4kbtiihuoty9UAANG0pWPw9cXQfMeObcFAgMvlZh6WzAe1Wj1Lf5Pi4EXL+TN79ad18tbbZasvV54NGwO33bisil//dxkmuqn5sC2sFY2qSzqXqraRE7GeOHUSqkUsGDYf+p75SgGOhJEgYzuX73xou5AgCOrX9fl8gUAAx/G6uro5dbIRElFv+8cvbDVYDHWqaoA9l7czmSggaDwWz8loUldXp9PpqqurrVZrzmM8O/FEkgTkH/7jj6F4bi8shafSCBGOhElSWL0kV4IdAHCCiCRIq6Vn7MXXZkk34ApZGUnO+MSEXFrJ53tYLFZlZWXeO14iEnj9fhnctfaRe5empsbOSTxFpFlsNkmSXC53+kOo0erDCdzp7Lv04h8ZFV9f/3SeZm8OzqAJQ5kGk8nrLmloYOR1E0wmIxpw1Yvuq360ZN1UqflkCpOIS1fWtwqFwrxK8xlYLJZYwFOX7apr3LX5kSlfsYHPkwmqVCqpVEoFImenVq3SBBzyqk+pvpRnbAFNMAU8+Yam5SKRUKGQzxQiwDD02aee7LMk6h4tWZue8vLGSVQgUKxuXCYUCOQy2QeegcznsBsWbGlctBMAAAwee24BJoqwGKhUIqHV3Odk3oLubZfsg0Mv604E/AAwmV5wpT81aNpv8Yy3Ek23b9mSSqWoW1kikVxXjSoqcQ717/U7SjYkSb7VZdQde9epYrqPWuWixYu+kie8OmTdH/PE7160rkatvn5XwO3zt494ze0vD6FLBfoeBuQ3Jptz2heEccX9azcmEwlaUHx+efecwWJ9W3MyqLOna/MNyBy79F+ypPyupRsFJXz64s/OfI4S9vQNwDR1BAQFkoAVSxfP11EKIRKJRKNRAODxeIW8q+eFl49eZDJQs8kIKvVMUwOGTSe5jJKnd91TVnpNYuvXzJ8PdEkFJVq9bhZjsumZfH9J/coH1m4Q0Gru882P/t+v+LIqt9MOpcq8+q+2oEEmFP7Tk0/TyiJzcuOnNVwnKLUGSnT073A4HCde65jER/761vHZ1LsFbMxk1JZh/lK5rLW19ToZMzqh6TYl2bq9rx6eKFDWnYWhDm1/c0UJl8NZuHDhdTLs1uTtzknHhX2jLN3QC97qO28rmXZjcFmYaax/YQWPw2Zdv7uiOKAd1ryxr627aVErTkwadfUzjF8DA0OMet3O1Quuk5p7hj5jkMtiJfGJWYzJBgHk7Zd///1vfR1oBbHrwIt73wTS7rAry/I1dxEU2bxhQ3VleZ7vaKZStA6LclWZzM80NDRFQLEpjmaQSCRer5fJZAVutCU0NDTzRdE6LKFQGAwGeTwuvd6BhqZoKFqHBQAEQYhEIrt92rwXGhqam5NidljUbOl4PH6jDaGhoZkfitlhUdBjXjQ0RUMxOyxK7oPSmbnRttDQ0MwDxeywKFQqldlsnrscDc11IJnG3b7QjbaiePjoZs358FCdQRRF0+n0dT2Qze178WBvMBYTply8qtLM3EC7zQrlFWCzKsunzDC3T93CQNE0QezZffe8GDNucrx2pCeNk2LcxlKVK21WOwCUVyinHTdjYbbB2QUQQEgg58uwWxCzw/O7v51JIRgErZy0FwC8Ho9UJsv+kCFnC4fNjkZjP/nX7/6dbf6Ig/3gBz+40TZcL2KxGIvFYjAYGIYFAoHrt6jweO9kz4g2EokCgzNy7LyGpRg9rj3f2eVVLTId19rtwycGSbuPb4t2v/n7k3rVdryvewBs3S/rjWLF6D4td8dtvgAy2nt6+ZJ5WJbx/nlt/+BwGidRDBs81nshrdMHFzm7ui8Mx1wicLc7jWjowP7OsUnS6OVzqgNnfj88IDYduWzY4Q43U3dkeIKnGN2nZW5aF0nzU159ddVsek80M3F+2HhJawn6vCyhgk+8f6ivSeA0DEfK8LTVE2M7HI28ckUM059+ayS+/GGp6bwGVcX63aHaFv/ZcMX99wjF1W79paaG+ht9Hh8hinamOwB4PN44k6ESCgHAYDAoFIrrpOh4dkDzWlsfg8kqV8gBT+b0sz0OkM2c5wkF4HGYcmXNnnXzo/L+/tmh90738QWSEiwlEIrmjN7NaB4Bzc2LkgT+wCp6ycgHxOb2//b19hTJgKhDN9hFkmShQ0AorFyyLJmM/9s/ffM623iTUcwOKxAIZEu46PV6gUAgkxWkF14IJElarVaqvzmut1osZpxrHzvFckUtMlDI7n08ryRWDiUcLBzHdy7gz0vCV5vNFo1Gx4xOh1VvGffE6pmW92fTmJ8FBoawMGRLU67CciE3zOyP5ew1IAhS+INd+N37YUwqvKpUKmWxWLILBEOh8UltIB1wDOkuDKdrRQXdGBwmihPkzoX0rOdcitlhAYDH48n2UF6vNxAIIAhCZdaJxWJOl6vDxgcADEVwgnSYdWWVuWuFRWxw+wJlpOXunVsyGwMBiESsCoWCcjQ4jqfTabvb+4///K+hULBAJXUAYLNYTBbr+f/5VfbGSCTidLmOXHKH5NUNXCwUyxUUdJh1Feq6eCSEMlifue2yrHtZWYjBYHC5XBzHcRz/3De+k0okPB534cZkgwD84v/792rV5eaVz+czmc19Q8FoeUPMbQjJq7P1cZwWXamqlsNEEiEzyip9ZlslAGg0GgM07GgAjQbq68lQKEQQxLGTHe6IvKSuPpOdiNo3U5WUQ9pdXs+lAz/87reoLZSsO1wRt0un06FQKBKNvnes3cmslzY3MUKpTFWguppAhKo5FfUjGPPTG8oEJXy4IutO1RMIBMwWS/tYMFDa2MxneCPp0Z7T0pWbp58a9VnBR812V4O69O4luToxGXF3lUo13aP96nd/ali53W42qtQ1hVx8kiAkAv665rI55UxvNYo56A4AoVAo22FJpVKpVAoAPp9Pq9UymUzN5OS57h7jiC4ealq0vso/1taRkoiZFX5XcsU3H6NuXCakAqGIZfxitsMCCGTLmWIYhmHYgCWxY+VtPtaEZyi/evd0SjiYYXL09JkzmzduBIBAAJJJVzAYNFut4aA+euStoymVhWkR1+6u02Vk3UFsSiY/WcOLxBgsAscJDEMBNAJBQ8YYgiC23/80TBwdBQJxUgAAEVRJREFUGEIKlHXPgYEhJy9cqJoYIyq3blYnL10KsTmxIcu5xJkDyQhqTRPARCAlq2lVQ2UlflYLe2rVAAwIp4mMIqsBTr7RNrEsVVPDMvFRFOVwOLFIeMjcmfoTEf9YQtuRYIK4oroV9lz1MggAggBJZL9HO+HgyU4rRMsfFrndDAaDJMlkMhkNjU50nxGPtWJX81Co4WynlmfSjlytWQoIkCRBUE5fM3FgIvlsFd9uxzAMQZBEMkUSvRPPdVsVXrtLKla6/T2VrnSnYdCNAojLV4C7rTfVWNPK0neklu7cKK3lQL53PElOADTOJO6+ctsDF99/N8rXjbUXdGNwmajROC4gvYtbWgr+xW4JiryFZTKZqqqqZi8zPD557OTpmiW3+d1OUl2XE0nS+7oD/mALX7lxzWoejxcOh30+H4IgeVVrXj1wIhwjkOrawvtfJv8AmWY8umkLk8HgcDjBYDC7G9vbf8maFPqcZkLdmG1YEo92a/ejuvQdW7ctbVkYDAbj8XiOLsWB7km7SU+qr8GYbMbc3awwuXlBC4adt79ltTzyyBMNDQBgszvO6aLa4y+MDEqzlebjae+pob1SG/cTDzzAxFCSJGUyWd6BDpvdcclOWExnXH0ut8UGqntbHrx82bXu006nfYOsqWXRQipNFoqilZWVM/XCbHbHeVMi7Hm37xAKNhs8+fVdWdcgnY6dGn+xmmxY39wklUgIgiBJMu8PZ7M7zhliscBfj/8Elzy6Qn7lpLJxRAbHdT3rxS0rly9LJpMEQWTm91EnKxAIcve5wgWd/8CBPwctTCzig2Vf3rV+xstOwQAy7HOuqpcoZ5a0vzUp8hZWIRMaFjXVd18aD0VPnXgxgimO5OTL8YY8aSIJOG6z2ZhMpkQiqampmakqYXnj6Jm9htffnkXWPQeTYZyHCy/09ChkVXI5LycZj9nmjPB4bO7xI186LH5kpUx9uU4CS3ij9ib5QlWZgsoxVTpVwjSVSgUTpNM1OLb3GoyZYph/uAppTKRSAedt2/65jlrnBADlyjIw6Dc+8o1lySmvOgxFSYREUEQkFGAoKhQKZ+rOlCvLRr3uqpot1Y25yUeSyTSLx5NIxCwWi8PhcDic2WNP5coyMJlqGh5XPpvnWxTD0nhaqpCVlZay2ezZTUIMxrrGb5b9ccZRilQiyeRzhUIBk8nkcrlcLjdzTeaEwImm1rs4q7gIggAEw8E5yjMZkCbxVCpFq7znUOQOq8DYbcDrKSvFAM753asbVilLkatZNVlcTiISYcswdpwjbsqTLCcbAY9TW8uKaVs81h50v/HSfZ9aMZd6oFysIsJIfV2dWCSarvK++84dBEEAfG/P1pxvhB9r+fEsAQ4mk8nnstgurPTOFs/RHtSadH515zUNQyoklfyUoLa62i/y5zyZ962tybeH8K7W7xVY+bZFebWCYXvzA9diIwDA7tWztKCFu1oKNenetXN69B0AOwqsLYd4inDae6Lj2gLj7qfH/ihMyBvE6zjsOADtsa5S5A6rQNgMUibc+exPH8CnLeIpQUrYUnZzw6Ly8rm10VNpQiC6c8MnM+N9gfBcclx+t4+PCdPp9Ew5KT5w2DUSDDXfdXddGoFFlC2B8LXs7nX55DIlThB0WoQPz5nDr4kqGpOi1LI9VaUAEL1gHJ2tfMqO1S1f2LxgwZw5pW41ijyG9XdWHH3/osXY8dooc0b17umUcDCLSV/Di5XwefOo551Kpd7sMqSHn/9b22wa87PAwBCPcWRRBZ/L4TQ25smAS1M47cOOiwf+YhCYh17Alz5R7n4hLn9itt+Cw0StmoEF5Tw2k7l48d81gctHnCJ3WA6HQywWz56odR7p1fkIhIkgWpO+vqqmoF2YGBIMh1eoBWw2q/CYSCGcHffyeZwUrincmGwQBIkG3OsWViAIMr+G3YKQJPmr3/2JIOxej1KumLs8hjEef/ghiUhAa43kUOQOiyRJs9k850AhDQ3NTUGRT0tDEATHc2dd0tDQ3KQUucMCWsCPhqaIoB0WDQ3NTUPxOyw2m03LutPQFAfF77DKysocDseNtoKGhmYeuCWmpf09R0L7x41mT3RRtbS2onTu0teZzr4JbyS9rqVSLp5xmRvN34euS7oho0/MSi2pv7ySwqDXV9fUUP9m/gQAkiQQBBWKRKUyyQ01+aNIkU9roPD7/QRBUDoN1xWHx/+bt875/T6lUl3CYyTKaq5KnZh1UFkLZl1pZa3TrCu9ImKTiocQBHtys4rFmgc9rGz6Rg2vtI+kU3GJrIyBogDw/7d3/sFRlGccf3Zv93JJLskdd7m75H4k5AcBDCRGQBRwqBQRx4iD2OIMg1rA1qpEnRbbcVpbilVbrDhOa9UKLRXBwdqCJEaQBjCJSTQhpAghuUDIJZc7cnu/cr/29nbf/rFwXi53EC1x5pr389/t7j377Hu33313932/j7jraBqxG8ctz5RK3G5Gnilft+ibTZ3GjIGLCM++ccjtYnTGkizm3dqzNxjZsKrc0bJ/UHe7AYbVijxTlsrmPh0edTMz1j2pT78kTc949LvxTkeYKdHDUigUfX1934JgBdiw3+8LeF2D4VBJel/rOzxkAYBaoTMVVdo6njtA3gRCnRpoTxaXM+pmCtduLlFGEMGH2NB1FyxfkPV5mFDQz7Fu94l6m65IP/OeIt0XHS8fGOVdRkWpotzkpGzQGfa6exVLl/F1B0ZpGrgccDOz1z+lpoNSqez6pjRlkUgICUnwkYjd2l90y5bvV14+78rmjd1uHgBAGhVmQ/R1MXT8/2NK9LAAIBwOWyyW4uLJtceORCK1jV0XhhltBmhKqiSEwKOvxohzHMT+CQlACODw+29uXLe2tHhSrqW765rs9hFDfp7GUEoAQnCNF6ZihhTBRxBpknknKaspgiAIDMMEAgHxY+9F27CXG+o7hTy9ze2KMp0q4RTodJoMckLLh29F/QsxsUwVwQIAv99vtVoLCgqkUqm4xGw2131yLC1NxrKJXyNSNMWFIzWPbky41uOBQGCYZVm4MniCoqhIJBIIBD6sP2I7zww6BEOWatrdD1QkGmlPSYgIj0y58grDtatj/GLrb6UmY06IjVs+cukSaDT5NM2Gw08+uklc2NuLCKKPoiiSJEccTLe158LnZ9q7+ek56mTJxJJJk35OMKV5KmbPGL82Wu3x3Z3vZxQVnz/fB/nGr+ruWC3iR4mEZEPs+urFCXchBtn6zLMzlt1LSSTROefRrwMARZHBADvU2/7zpzcnSxUhJPopv7LrH5BnyIuZKB4bCiFks1qkhYXZfnZ99aJkcUiS/MPO92VFRYoQZ7NaAADyjWC16PIvNxlNkcFgOGEEEbMZNBqv0+kkCIIgCLVaHS0jwHGcz+dn2VBdm9k5Yp2Wm/hemyRAQPCDexK3G2YKCZbIwMCAIAgej8cyNNTe02vu4JHfpb7v8ZmJvFcUGZTdOqBUKtffVjh+rcfjyc7OTjjO6/mXXy2ouvPSga1n+LJIEodJmiQ4AfktnUvnz1GrVTFhgeedo6Oj4i5G/f5PW+ptJyOKBfrOw6fJpc/dcdOn3W93uPPy3TCvqgI0+ukZyOf0+otpW/XKOyDGBVikxexqPfCvYOYFx8R8UOVppI8VzjTseWzTBplMFnU6DoVCdrvd6/UyLteJ5jpzs1NZVk7cSPa/bYUVQHwMORtqiuCyoXA6P0JyQ/p0+e23LYpGAACbzRYIBFiWPXuu50SvGQaIgKXxpDBrZoEKjLeWGiDqR5ydLrEP9iuU6oe/c7nxo3HEGVeCILAsS5JkU2tbP2LOH7YRNOXmOIDyqg3SL14+Sc0KOM5mFFyJXGLQ2hlGJww+cN+90VYaHBzked7r9fr8/k8/q7citf1Qs8Nw9w3lNjCYwAZOG0D3Ua9iSdWGZQWCz+P1FUpt96xckbDp4lp+PLv37kfqWZ7aF7r4JfJMTltoahvrBCv2sE5+vOuJRzZexRFwyjLlBEtEvKKO+oPtQ5HWxk8cdhuv1sQ94iIIFOFDNy9cfvLo/md/MuYi73Q6RZPJq+zijf1HPa5LgtaQzDJSQAgAOfq7ttQ8Hqt6sbUzolf+f3d7Whs/GbENC7nauDy5SHDBwiUSUnbXjXkAEAwGJRJJtBcJAC+88pogVRJ6Yx4xoVEsEprgwvyK+SUGvegWbwZovri3Y2jeiltXroyeji++8lrXl91et9NHyNVjqxERcuHGmXMRi3721BMSiSRZhIam1ta2to6u0z6PR8jKko/JASATVZjmrFv7PUPeZWtzs/noxeNtkK8ByC+IiSMmIyB0orEJybOyEl1CJHJBqzbqspVbah6jKArA/NGrvaU1K+PURTwoj4vh5WPyAQBSjmYXz5YiyTNPPh43GzwUCtlsNoqiklkkx7Jm/UYuzLJSmTzRWrGTvm/n69hYJiFTVLCiHGk4PhSZ1rzrhKBi4rxGmWBXfePfquiqVSvvZFlWdPsVb0BycnIUCsVVwm7bviN/TkbTrk4iV6eo2LxsYYJt2JD3g6ZfL9besWjuHAJAjJ+ZmalWJzC3G2GYuo5hGho7agGsVnjo6WVXHn/Utj+v5U2LSyo0KpVcLqdpOtZsHgCazjkOHnyTY7JIvwuSJBOLhzUfPPbHSrJyzarqUCiUmZmp1+vHnz/9A5bjPd40aPziEIpL6VD7ViOULimtmKZUZmRkyOXyZOK+bfuOvPIMT4f9TJeieKkJrliquoPdtS1vVQqVa1ZVBwIBsXF0Ot1VjDeOfWnv/M/hYI+fGbKC/t5Zq4tiW6G+83fTuNxFhZV6nU68TUtY9s3BOA91DElRY0cdEXdQH3X+VhsxLS6u0Obmpqenx34rLS1Nq9VOZE7F7r37BfXMpp2vI3XiP4bYwzp1+K+PbdqAe1jjmeqCBQD3P7iJj3DUuJcy0mzKR47ue/EvMpksrmLYRFjz4EYpTYe5pB7NBEBY4X/7N68qM6d5vYRSeY3uz649+2ia4sYFDPCjq1bcbdAmrR6IELr/oU1IAIKc0CwlUkaE0/3vvbSToqi+PmLGjKSJ1R9tIAgSoXjXw0AoWH3ncloyofdc9UcbCAQoPjUiwAZW33XXRCLEhhIERCY6zAgXVml0t1RVTCQISZDCuIMKc+zN8xdoVf/ru+aDzedoikJJ1I0VgmcHmx9eUp2n0WF/5PFMdcE60nDcyqubdr7ECPPnFeo06756ssMEvzzWsW8Of8OPN91vPetXzL2GP3Is27bvyCv39R1B54a4ZJa4oZDng89+tVi94r7ly2ma+rqCOHEaux1tHbVh88XPJ+bP6wz21DX9qZK4afOPHrFYLNhx9Dqye+9+QjfH1fLnuqbscn2C3yIcufTRydcNTn3NIz+02+248eOY6oIFAJ1dp4EgEtZuAoDKb1o+/mBzz4jNgoxFyUdeIl7g5+bLjHr9pJaf+2ftYYmqyG61EMbCiQwDRYgXENxaolQqlbgu3nXn4OcDTXtecKRLvKcg21Smdg2rn/tp1ZW1FIkiAtHV8N7a1as0Gg22TowDP9j75pJ0FbZt32GsLOs58Y45WJzlchLKMpVrWPXLLbFlAcW3hC2n2hmHo7ioaPJ6WLrSea0H3hzICjg/BnBdGB00Tr+qP29WGuljhV17/n7bwpsXLFgwSVlNTSKRiCDwq2t+72d7hy4W6cfVKJHQJM8JbCjEcRzuTIwH97Ami6FhG8CFCxemT08y+hIJiCAJ/QRqW1yXZBDq6+8vTpbMeL6dxDCYrwUWLAwGkzLgJxQYDCZlwIKFwWBSBixYGAwmZcCChcFgUgYsWBgMJmXAgoXBYFIGLFgYDCZlwIKFwWBSBixYGAwmZcCChcFgUgYsWBgMJmXAgoXBYFIGLFgYDCZlwIKFwWBSBixYGAwmZcCChcFgUgYsWBgMJmX4L+vkyBdyRVhRAAAAAElFTkSuQmCC"
#!   ARCGIS_COMPATIBILITY="ARCGIS_AUTO"
#!   ATTR_TYPE_ENCODING="SDF"
#!   BEGIN_PYTHON=""
#!   BEGIN_TCL=""
#!   CATEGORY=""
#!   DESCRIPTION=""
#!   DESTINATION="NONE"
#!   DESTINATION_ROUTING_FILE=""
#!   DOC_EXTENTS="9599.94 4192.24"
#!   DOC_TOP_LEFT="-3746.96 -4143.59"
#!   END_PYTHON=""
#!   END_TCL=""
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="22765"
#!   FME_BULK_MODE_THRESHOLD="2000"
#!   FME_DOCUMENT_GUID="e5402413-c322-453b-b953-4a95464877b5"
#!   FME_DOCUMENT_PRIORGUID=""
#!   FME_GEOMETRY_HANDLING="Enhanced"
#!   FME_IMPLICIT_CSMAP_REPROJECTION_MODE="Auto"
#!   FME_NAMES_ENCODING="UTF-8"
#!   FME_REPROJECTION_ENGINE="FME"
#!   FME_SERVER_SERVICES=""
#!   FME_STROKE_MAX_DEVIATION="0"
#!   HISTORY=""
#!   IGNORE_READER_FAILURE="No"
#!   LAST_SAVE_BUILD="FME(R) 2022.2.0.0 (20221103 - Build 22765 - WIN64)"
#!   LAST_SAVE_DATE="2024-07-10T17:35:15"
#!   LOG_FILE=""
#!   LOG_MAX_RECORDED_FEATURES="200"
#!   MARKDOWN_DESCRIPTION=""
#!   MARKDOWN_USAGE=""
#!   MAX_LOG_FEATURES="200"
#!   MULTI_WRITER_DATASET_ORDER="BY_ID"
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="310"
#!   REDIRECT_TERMINATORS="NONE"
#!   SAVE_ON_PROMPT_AND_RUN="Yes"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   SOURCE="NONE"
#!   SOURCE_ROUTING_FILE=""
#!   TERMINATE_REJECTED="YES"
#!   TITLE=""
#!   USAGE=""
#!   USE_MARKDOWN=""
#!   VIEW_POSITION="-4448.78 -228.233"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   ZOOM_SCALE="89"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! <CONNECTIONS>
#! <CONNECTION
#!   NAME="AWS_UBCParking"
#!   TYPE="DATABASE"
#!   FAMILY="Microsoft SQL Server (JDBC)"
#!   USAGE="INTERNAL"
#! />
#! </CONNECTIONS>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! </GLOBAL_PARAMETERS>
#! <USER_PARAMETERS
#!   FORM="eyJwYXJhbWV0ZXJzIjpbXX0="
#! >
#! <PARAMETER_INFO>
#! </PARAMETER_INFO>
#! </USER_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="2"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-1033.395051949552 41.750156470494971"
#!   BOUNDING_RECT="-1033.395051949552 41.750156470494971 689.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(255)"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="week_start_date,zone_id"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(255)"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;zone_id&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;week_start_date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsWestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="3"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="482.04589816011799 41.750156470494943"
#!   BOUNDING_RECT="482.04589816011799 41.750156470494943 823.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;Occupancy_Table_Name&lt;closeparen&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;week_start_date_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayWestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1526.5369238884252 -74.50340606513052"
#!   BOUNDING_RECT="1526.5369238884252 -74.50340606513052 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="5"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="-167.61821989135819 -74.50340606513052"
#!   BOUNDING_RECT="-167.61821989135819 -74.50340606513052 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_start_date_unixtimestamp Occupancy_Table_Name zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="6"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3060.8710137821013 -70.873518785865571"
#!   BOUNDING_RECT="3060.8710137821013 -70.873518785865571 487.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="week_start_date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time week_start_date week_end_date zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.current_week_start_day&lt;comma&gt;&lt;space&gt;week_last_day&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.zone_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_start_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_end_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerWeek"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="7"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3853.4758022630795 -70.873518785865571"
#!   BOUNDING_RECT="3853.4758022630795 -70.873518785865571 515.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity week_start_date week_end_date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;week_start_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;week_end_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_WestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="4914.7656078267828 48.650278238323402"
#!   BOUNDING_RECT="4914.7656078267828 48.650278238323402 648.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;week_start_date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.week_start_date&lt;space&gt;=&lt;space&gt;source.week_start_date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.week_end_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_WestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="15"
#!   TYPE="Creator"
#!   VERSION="6"
#!   POSITION="-3746.9551582657582 -2825.958362293929"
#!   BOUNDING_RECT="-3746.9551582657582 -2825.958362293929 430 71"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="CREATED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATEND" PARM_VALUE="no"/>
#!     <XFORM_PARM PARM_NAME="COORDS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="CRE_ATTR" PARM_VALUE="_creation_instance"/>
#!     <XFORM_PARM PARM_NAME="GEOM" PARM_VALUE="&lt;lt&gt;?xml&lt;space&gt;version=&lt;quote&gt;1.0&lt;quote&gt;&lt;space&gt;encoding=&lt;quote&gt;US_ASCII&lt;quote&gt;&lt;space&gt;standalone=&lt;quote&gt;no&lt;quote&gt;&lt;space&gt;?&lt;gt&gt;&lt;lt&gt;geometry&lt;space&gt;dimension=&lt;quote&gt;2&lt;quote&gt;&lt;gt&gt;&lt;lt&gt;null&lt;solidus&gt;&lt;gt&gt;&lt;lt&gt;&lt;solidus&gt;geometry&lt;gt&gt;"/>
#!     <XFORM_PARM PARM_NAME="GEOMTYPE" PARM_VALUE="Geometry Object"/>
#!     <XFORM_PARM PARM_NAME="NUM" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="OAN_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Creator"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="17"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2229.8728622786975 -70.873518785865571"
#!   BOUNDING_RECT="2229.8728622786975 -70.873518785865571 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_end_date Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;first_date&lt;comma&gt;&lt;space&gt;last_date&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;first_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;last_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddWeek"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="22"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-1027.395051949552 -684.13021177846633"
#!   BOUNDING_RECT="-1027.395051949552 -684.13021177846633 683.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="buffer,buffer"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="week_start_date,zone_id"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=","/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;zone_id&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;week_start_date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsUnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="23"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="536.04541824605735 -709.86440112040111"
#!   BOUNDING_RECT="536.04541824605735 -709.86440112040111 817.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Result Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;Occupancy_Table_Name&lt;closeparen&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;week_start_date_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayUnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="24"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1526.5369238884252 -822.48807637676168"
#!   BOUNDING_RECT="1526.5369238884252 -822.48807637676168 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="25"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="-113.61869980541883 -826.11796365602663"
#!   BOUNDING_RECT="-113.61869980541883 -826.11796365602663 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_start_date_unixtimestamp Occupancy_Table_Name zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="26"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3114.8705338680411 -822.48807637676168"
#!   BOUNDING_RECT="3114.8705338680411 -822.48807637676168 487.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="week_start_date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time week_start_date week_end_date zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.current_week_start_day&lt;comma&gt;&lt;space&gt;week_last_day&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.zone_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_start_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_end_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerWeek_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="27"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3912.210218182825 -822.48807637676168"
#!   BOUNDING_RECT="3912.210218182825 -822.48807637676168 509.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity week_start_date week_end_date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;week_start_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;week_end_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_UnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="28"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="4968.7651279127222 -702.9642793525727"
#!   BOUNDING_RECT="4968.7651279127222 -702.9642793525727 642.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;week_start_date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.week_start_date&lt;space&gt;=&lt;space&gt;source.week_start_date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.week_end_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_UnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="29"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2283.8723823646369 -822.48807637676168"
#!   BOUNDING_RECT="2283.8723823646369 -822.48807637676168 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_end_date Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;first_date&lt;comma&gt;&lt;space&gt;last_date&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;first_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;last_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddWeek_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="38"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-910.1920124705839 -1376.1842410967022"
#!   BOUNDING_RECT="-910.1920124705839 -1376.1842410967022 681.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="buffer,buffer"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="week_start_date,zone_id"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=","/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;zone_id&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;week_start_date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsThunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="39"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="659.24845772502545 -1376.1842410967022"
#!   BOUNDING_RECT="659.24845772502545 -1376.1842410967022 815.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Result Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;Occupancy_Table_Name&lt;closeparen&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;week_start_date_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayThunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="40"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1649.7399633673933 -1488.8079163530626"
#!   BOUNDING_RECT="1649.7399633673933 -1488.8079163530626 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_3"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="41"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="-18.505828868585581 -1432.4378036323276"
#!   BOUNDING_RECT="-18.505828868585581 -1432.4378036323276 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_start_date_unixtimestamp Occupancy_Table_Name zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_3"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="42"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3238.0735733470092 -1488.8079163530626"
#!   BOUNDING_RECT="3238.0735733470092 -1488.8079163530626 487.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="week_start_date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time week_start_date week_end_date zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.current_week_start_day&lt;comma&gt;&lt;space&gt;week_last_day&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.zone_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_start_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_end_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerWeek_3"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="43"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4030.6783618279842 -1488.8079163530626"
#!   BOUNDING_RECT="4030.6783618279842 -1488.8079163530626 507.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity week_start_date week_end_date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;week_start_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;week_end_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_Thunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="44"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5091.9681673916857 -1369.2841193288737"
#!   BOUNDING_RECT="5091.9681673916857 -1369.2841193288737 640.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;week_start_date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.week_start_date&lt;space&gt;=&lt;space&gt;source.week_start_date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.week_end_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_Thunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="45"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2407.075421843605 -1488.8079163530626"
#!   BOUNDING_RECT="2407.075421843605 -1488.8079163530626 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_end_date Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;first_date&lt;comma&gt;&lt;space&gt;last_date&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;first_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;last_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddWeek_3"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="54"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-910.1920124705839 -1993.1754700444576"
#!   BOUNDING_RECT="-910.1920124705839 -1993.1754700444576 674.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="buffer,buffer"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="week_start_date,zone_id"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=","/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;zone_id&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;week_start_date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsRoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="55"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="659.24845772502545 -1993.1754700444576"
#!   BOUNDING_RECT="659.24845772502545 -1993.1754700444576 808.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Result Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;Occupancy_Table_Name&lt;closeparen&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;week_start_date_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayRoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="56"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1649.7399633673933 -2105.7991453008181"
#!   BOUNDING_RECT="1649.7399633673933 -2105.7991453008181 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_4"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="57"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="9.5843396735492661 -2109.429032580083"
#!   BOUNDING_RECT="9.5843396735492661 -2109.429032580083 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_start_date_unixtimestamp Occupancy_Table_Name zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_4"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="58"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3238.0735733470092 -2105.7991453008181"
#!   BOUNDING_RECT="3238.0735733470092 -2105.7991453008181 487.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="week_start_date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time week_start_date week_end_date zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.current_week_start_day&lt;comma&gt;&lt;space&gt;week_last_day&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.zone_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_start_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_end_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerWeek_4"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="59"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4030.6783618279851 -2105.7991453008181"
#!   BOUNDING_RECT="4030.6783618279851 -2105.7991453008181 500.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity week_start_date week_end_date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;week_start_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;week_end_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_RoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="60"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5091.9681673916866 -1986.2753482766291"
#!   BOUNDING_RECT="5091.9681673916866 -1986.2753482766291 633.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;week_start_date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.week_start_date&lt;space&gt;=&lt;space&gt;source.week_start_date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.week_end_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_RoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="61"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2407.0754218436041 -2105.7991453008181"
#!   BOUNDING_RECT="2407.0754218436041 -2105.7991453008181 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_end_date Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;first_date&lt;comma&gt;&lt;space&gt;last_date&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;first_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;last_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddWeek_4"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="70"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-873.64537823680826 -2666.2603626713003"
#!   BOUNDING_RECT="-873.64537823680826 -2666.2603626713003 565.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="buffer,buffer"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="week_start_date,zone_id"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=","/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;zone_id&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;week_start_date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsNorth"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="71"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="695.79509195880155 -2666.2603626713003"
#!   BOUNDING_RECT="695.79509195880155 -2666.2603626713003 699.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Result Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;Occupancy_Table_Name&lt;closeparen&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;week_start_date_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayNorth"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="72"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1686.2865976011692 -2778.8840379276608"
#!   BOUNDING_RECT="1686.2865976011692 -2778.8840379276608 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_5"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="73"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="46.130973907325483 -2782.5139252069257"
#!   BOUNDING_RECT="46.130973907325483 -2782.5139252069257 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_start_date_unixtimestamp Occupancy_Table_Name zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_5"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="74"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3274.6202075807851 -2778.8840379276608"
#!   BOUNDING_RECT="3274.6202075807851 -2778.8840379276608 487.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="week_start_date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time week_start_date week_end_date zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.current_week_start_day&lt;comma&gt;&lt;space&gt;week_last_day&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.zone_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_start_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_end_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerWeek_5"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="75"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4067.2249960617628 -2778.8840379276608"
#!   BOUNDING_RECT="4067.2249960617628 -2778.8840379276608 430 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity week_start_date week_end_date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;week_start_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;week_end_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_North"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="76"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5128.5148016254661 -2659.3602409034715"
#!   BOUNDING_RECT="5128.5148016254661 -2659.3602409034715 524.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;week_start_date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.week_start_date&lt;space&gt;=&lt;space&gt;source.week_start_date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.week_end_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_North"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="77"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2443.62205607738 -2778.8840379276608"
#!   BOUNDING_RECT="2443.62205607738 -2778.8840379276608 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_end_date Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;first_date&lt;comma&gt;&lt;space&gt;last_date&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;first_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;last_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddWeek_5"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="86"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-835.17154235699843 -3339.3488310866051"
#!   BOUNDING_RECT="-835.17154235699843 -3339.3488310866051 727.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="buffer,buffer"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="week_start_date,zone_id"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=","/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;zone_id&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;week_start_date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsHealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="87"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="734.26892783861149 -3339.3488310866051"
#!   BOUNDING_RECT="734.26892783861149 -3339.3488310866051 861.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Result Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;Occupancy_Table_Name&lt;closeparen&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;week_start_date_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayHealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="88"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1724.7604334809796 -3451.9725063429655"
#!   BOUNDING_RECT="1724.7604334809796 -3451.9725063429655 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_6"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="89"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="84.604809787135309 -3455.6023936222305"
#!   BOUNDING_RECT="84.604809787135309 -3455.6023936222305 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_start_date_unixtimestamp Occupancy_Table_Name zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_6"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="90"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3313.094043460595 -3451.9725063429655"
#!   BOUNDING_RECT="3313.094043460595 -3451.9725063429655 487.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="week_start_date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time week_start_date week_end_date zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.current_week_start_day&lt;comma&gt;&lt;space&gt;week_last_day&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.zone_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_start_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_end_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerWeek_6"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="91"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4105.6988319415741 -3451.9725063429655"
#!   BOUNDING_RECT="4105.6988319415741 -3451.9725063429655 553.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity week_start_date week_end_date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;week_start_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;week_end_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_HealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="92"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5166.9886375052774 -3332.4487093187763"
#!   BOUNDING_RECT="5166.9886375052774 -3332.4487093187763 686.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;week_start_date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.week_start_date&lt;space&gt;=&lt;space&gt;source.week_start_date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.week_end_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_HealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="93"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2482.0958919571899 -3451.9725063429655"
#!   BOUNDING_RECT="2482.0958919571899 -3451.9725063429655 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_end_date Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;first_date&lt;comma&gt;&lt;space&gt;last_date&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;first_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;last_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddWeek_6"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="102"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-723.86111353427987 -3956.3405610319592"
#!   BOUNDING_RECT="-723.86111353427987 -3956.3405610319592 570.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="buffer,buffer"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Initiator Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="week_start_date,zone_id"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=","/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;at&gt;Value&lt;openparen&gt;zone_id&lt;closeparen&gt;&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;week_start_date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsFraser"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="103"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="845.57935666133017 -3956.3405610319592"
#!   BOUNDING_RECT="845.57935666133017 -3956.3405610319592 704.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Keep Result Attributes if Conflict"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;Occupancy_Table_Name&lt;closeparen&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;week_start_date_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayFraser"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="104"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1836.0708623036976 -4068.9642362883192"
#!   BOUNDING_RECT="1836.0708623036976 -4068.9642362883192 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_7"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="105"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="195.91523860985399 -4072.5941235675837"
#!   BOUNDING_RECT="195.91523860985399 -4072.5941235675837 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_start_date_unixtimestamp Occupancy_Table_Name zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_7"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="106"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3424.4044722833132 -4068.9642362883192"
#!   BOUNDING_RECT="3424.4044722833132 -4068.9642362883192 487.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="week_start_date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time week_start_date week_end_date zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_day&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.current_week_start_day&lt;comma&gt;&lt;space&gt;week_last_day&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.zone_id&lt;space&gt;=&lt;space&gt;str&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;str&lt;openparen&gt;self.current_week_start_day&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.week_start_date:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.zone_id&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_start_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.week_end_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerWeek_7"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="107"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4217.009260764291 -4068.9642362883192"
#!   BOUNDING_RECT="4217.009260764291 -4068.9642362883192 430 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity week_start_date week_end_date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;zone_id&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;week_start_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;week_end_date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_Fraser"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="108"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5278.2990663279943 -3949.4404392641304"
#!   BOUNDING_RECT="5278.2990663279943 -3949.4404392641304 529.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;week_start_date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Weekly_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.week_start_date&lt;space&gt;=&lt;space&gt;source.week_start_date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;week_end_date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.week_start_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.week_end_date&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_Fraser"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="109"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2593.4063207799086 -4068.9642362883192"
#!   BOUNDING_RECT="2593.4063207799086 -4068.9642362883192 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_start_date_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="week_end_date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="week_start_date week_end_date Date hour_minute Vehicles Capacity zone_id"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;get_week_bounds&lt;openparen&gt;given_date&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Ensure&lt;space&gt;given_date&lt;space&gt;is&lt;space&gt;a&lt;space&gt;datetime.date&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;elif&lt;space&gt;isinstance&lt;openparen&gt;given_date&lt;comma&gt;&lt;space&gt;datetime.datetime&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;given_date&lt;space&gt;=&lt;space&gt;given_date.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Calculate&lt;space&gt;the&lt;space&gt;first&lt;space&gt;and&lt;space&gt;last&lt;space&gt;day&lt;space&gt;of&lt;space&gt;the&lt;space&gt;week&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;start_of_week&lt;space&gt;=&lt;space&gt;given_date&lt;space&gt;-&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=given_date.weekday&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;end_of_week&lt;space&gt;=&lt;space&gt;start_of_week&lt;space&gt;+&lt;space&gt;datetime.timedelta&lt;openparen&gt;days=6&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;start_of_week&lt;comma&gt;&lt;space&gt;end_of_week&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;first_date&lt;comma&gt;&lt;space&gt;last_date&lt;space&gt;=&lt;space&gt;get_week_bounds&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_start_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;first_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;week_end_date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;last_date.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddWeek_7"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="118"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="-2748.2893954000515 -2542.5139252069257"
#!   BOUNDING_RECT="-2748.2893954000515 -2542.5139252069257 430 71"
#!   ORDER="500000000000047"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(255),int32,varchar(255)"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="parkade_name,zone_id,parkade_capacity,Occupancy_Table_Name"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(255),integer,nvarchar(255)"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;*&lt;space&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Parkade_management&lt;closebracket&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLExecutor"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="126"
#!   TYPE="Tester"
#!   VERSION="3"
#!   POSITION="-1877.8122130256311 -14.50340606513052"
#!   BOUNDING_RECT="-1877.8122130256311 -14.50340606513052 430 71"
#!   ORDER="500000000000048"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_MSG" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PRESERVE_FEATURE_ORDER" PARM_VALUE="Per Output Port"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;parkade_name&lt;closeparen&gt; = West&lt;space&gt;Parkade"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="TEST"/>
#!     <XFORM_PARM PARM_NAME="TEST_PREVIEW_GROUP" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="128"
#!   TYPE="Tester"
#!   VERSION="3"
#!   POSITION="-1768.0479879205191 -864.1302117784661"
#!   BOUNDING_RECT="-1768.0479879205191 -864.1302117784661 454 71"
#!   ORDER="500000000000048"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_MSG" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PRESERVE_FEATURE_ORDER" PARM_VALUE="Per Output Port"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;parkade_name&lt;closeparen&gt; = University&lt;space&gt;West&lt;space&gt;Boulevard"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="TEST"/>
#!     <XFORM_PARM PARM_NAME="TEST_PREVIEW_GROUP" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="UnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="120"
#!   TYPE="Tester"
#!   VERSION="3"
#!   POSITION="-1654.4104879091553 -1432.4378036323276"
#!   BOUNDING_RECT="-1654.4104879091553 -1432.4378036323276 454 71"
#!   ORDER="500000000000048"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_MSG" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PRESERVE_FEATURE_ORDER" PARM_VALUE="Per Output Port"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;parkade_name&lt;closeparen&gt; = Thunderbird&lt;space&gt;Parkade"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="TEST"/>
#!     <XFORM_PARM PARM_NAME="TEST_PREVIEW_GROUP" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Thunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="123"
#!   TYPE="Tester"
#!   VERSION="3"
#!   POSITION="-1554.974957448929 -1993.1754700444576"
#!   BOUNDING_RECT="-1554.974957448929 -1993.1754700444576 454 71"
#!   ORDER="500000000000048"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_MSG" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PRESERVE_FEATURE_ORDER" PARM_VALUE="Per Output Port"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;parkade_name&lt;closeparen&gt; = Rose&lt;space&gt;Garden&lt;space&gt;Parkade"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="TEST"/>
#!     <XFORM_PARM PARM_NAME="TEST_PREVIEW_GROUP" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="RoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="125"
#!   TYPE="Tester"
#!   VERSION="3"
#!   POSITION="-1554.974957448929 -2722.5139252069257"
#!   BOUNDING_RECT="-1554.974957448929 -2722.5139252069257 454 71"
#!   ORDER="500000000000048"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_MSG" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PRESERVE_FEATURE_ORDER" PARM_VALUE="Per Output Port"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;parkade_name&lt;closeparen&gt; = North&lt;space&gt;Parkade"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="TEST"/>
#!     <XFORM_PARM PARM_NAME="TEST_PREVIEW_GROUP" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="North"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="130"
#!   TYPE="Tester"
#!   VERSION="3"
#!   POSITION="-1630.733290789839 -3455.6023936222305"
#!   BOUNDING_RECT="-1630.733290789839 -3455.6023936222305 454 71"
#!   ORDER="500000000000048"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_MSG" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PRESERVE_FEATURE_ORDER" PARM_VALUE="Per Output Port"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;parkade_name&lt;closeparen&gt; = Health&lt;space&gt;Sciences&lt;space&gt;Parkade"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="TEST"/>
#!     <XFORM_PARM PARM_NAME="TEST_PREVIEW_GROUP" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="HealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="132"
#!   TYPE="Tester"
#!   VERSION="3"
#!   POSITION="-1687.5520407955207 -4072.5941235675837"
#!   BOUNDING_RECT="-1687.5520407955207 -4072.5941235675837 454 71"
#!   ORDER="500000000000048"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="PASSED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="FAILED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="parkade_name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="parkade_capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Occupancy_Table_Name" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="BOOL_OP" PARM_VALUE="OR"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_MSG" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMPOSITE_TEST" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="PRESERVE_FEATURE_ORDER" PARM_VALUE="Per Output Port"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE" PARM_VALUE="TEST &lt;at&gt;Value&lt;openparen&gt;parkade_name&lt;closeparen&gt; = Fraser&lt;space&gt;Parkade"/>
#!     <XFORM_PARM PARM_NAME="TEST_CLAUSE_GRP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TEST_MODE" PARM_VALUE="TEST"/>
#!     <XFORM_PARM PARM_NAME="TEST_PREVIEW_GROUP" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Fraser"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="117"
#!   SOURCE_NODE="15"
#!   TARGET_NODE="118"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="18"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="17"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="10"
#!   SOURCE_NODE="5"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="20"
#!   SOURCE_NODE="6"
#!   TARGET_NODE="7"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="7"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="19"
#!   SOURCE_NODE="17"
#!   TARGET_NODE="6"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="30"
#!   SOURCE_NODE="24"
#!   TARGET_NODE="29"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="31"
#!   SOURCE_NODE="25"
#!   TARGET_NODE="23"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="32"
#!   SOURCE_NODE="26"
#!   TARGET_NODE="27"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="33"
#!   SOURCE_NODE="27"
#!   TARGET_NODE="28"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="34"
#!   SOURCE_NODE="29"
#!   TARGET_NODE="26"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="46"
#!   SOURCE_NODE="40"
#!   TARGET_NODE="45"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="47"
#!   SOURCE_NODE="41"
#!   TARGET_NODE="39"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="48"
#!   SOURCE_NODE="42"
#!   TARGET_NODE="43"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="49"
#!   SOURCE_NODE="43"
#!   TARGET_NODE="44"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="50"
#!   SOURCE_NODE="45"
#!   TARGET_NODE="42"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="62"
#!   SOURCE_NODE="56"
#!   TARGET_NODE="61"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="63"
#!   SOURCE_NODE="57"
#!   TARGET_NODE="55"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="64"
#!   SOURCE_NODE="58"
#!   TARGET_NODE="59"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="65"
#!   SOURCE_NODE="59"
#!   TARGET_NODE="60"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="66"
#!   SOURCE_NODE="61"
#!   TARGET_NODE="58"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="78"
#!   SOURCE_NODE="72"
#!   TARGET_NODE="77"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="79"
#!   SOURCE_NODE="73"
#!   TARGET_NODE="71"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="80"
#!   SOURCE_NODE="74"
#!   TARGET_NODE="75"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="81"
#!   SOURCE_NODE="75"
#!   TARGET_NODE="76"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="82"
#!   SOURCE_NODE="77"
#!   TARGET_NODE="74"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="94"
#!   SOURCE_NODE="88"
#!   TARGET_NODE="93"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="95"
#!   SOURCE_NODE="89"
#!   TARGET_NODE="87"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="96"
#!   SOURCE_NODE="90"
#!   TARGET_NODE="91"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="97"
#!   SOURCE_NODE="91"
#!   TARGET_NODE="92"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="98"
#!   SOURCE_NODE="93"
#!   TARGET_NODE="90"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="110"
#!   SOURCE_NODE="104"
#!   TARGET_NODE="109"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="111"
#!   SOURCE_NODE="105"
#!   TARGET_NODE="103"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="112"
#!   SOURCE_NODE="106"
#!   TARGET_NODE="107"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="113"
#!   SOURCE_NODE="107"
#!   TARGET_NODE="108"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="114"
#!   SOURCE_NODE="109"
#!   TARGET_NODE="106"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="138"
#!   SOURCE_NODE="120"
#!   TARGET_NODE="38"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="137"
#!   SOURCE_NODE="123"
#!   TARGET_NODE="54"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="136"
#!   SOURCE_NODE="125"
#!   TARGET_NODE="70"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="122"
#!   SOURCE_NODE="126"
#!   TARGET_NODE="2"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="139"
#!   SOURCE_NODE="128"
#!   TARGET_NODE="22"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="135"
#!   SOURCE_NODE="130"
#!   TARGET_NODE="86"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="134"
#!   SOURCE_NODE="132"
#!   TARGET_NODE="102"
#!   SOURCE_PORT_DESC="fo 0 PASSED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="5"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="14"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="35"
#!   SOURCE_NODE="22"
#!   TARGET_NODE="25"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="36"
#!   SOURCE_NODE="23"
#!   TARGET_NODE="24"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="51"
#!   SOURCE_NODE="38"
#!   TARGET_NODE="41"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="52"
#!   SOURCE_NODE="39"
#!   TARGET_NODE="40"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="67"
#!   SOURCE_NODE="54"
#!   TARGET_NODE="57"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="68"
#!   SOURCE_NODE="55"
#!   TARGET_NODE="56"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="83"
#!   SOURCE_NODE="70"
#!   TARGET_NODE="73"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="84"
#!   SOURCE_NODE="71"
#!   TARGET_NODE="72"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="99"
#!   SOURCE_NODE="86"
#!   TARGET_NODE="89"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="100"
#!   SOURCE_NODE="87"
#!   TARGET_NODE="88"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="115"
#!   SOURCE_NODE="102"
#!   TARGET_NODE="105"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="116"
#!   SOURCE_NODE="103"
#!   TARGET_NODE="104"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="127"
#!   SOURCE_NODE="118"
#!   TARGET_NODE="126"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="119"
#!   SOURCE_NODE="118"
#!   TARGET_NODE="128"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="1"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="121"
#!   SOURCE_NODE="118"
#!   TARGET_NODE="120"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="2"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="124"
#!   SOURCE_NODE="118"
#!   TARGET_NODE="123"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="3"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="129"
#!   SOURCE_NODE="118"
#!   TARGET_NODE="125"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="4"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="131"
#!   SOURCE_NODE="118"
#!   TARGET_NODE="130"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="5"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="133"
#!   SOURCE_NODE="118"
#!   TARGET_NODE="132"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="6"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </WORKSPACE>

FME_PYTHON_VERSION 310
ARCGIS_COMPATIBILITY ARCGIS_AUTO
#! START_HEADER
#! START_WB_HEADER
READER_TYPE MULTI_READER
WRITER_TYPE NULL
WRITER_KEYWORD NULL_DEST
NULL_DEST_DATASET null
#! END_WB_HEADER
#! START_WB_HEADER
#! END_WB_HEADER
#! END_HEADER

LOG_FILENAME "$(FME_MF_DIR)parking_stats_weekly.log"
LOG_APPEND NO
LOG_FILTER_MASK -1
LOG_MAX_FEATURES 200
LOG_MAX_RECORDED_FEATURES 200
FME_REPROJECTION_ENGINE FME
FME_IMPLICIT_CSMAP_REPROJECTION_MODE Auto
FME_GEOMETRY_HANDLING Enhanced
FME_STROKE_MAX_DEVIATION 0
FME_NAMES_ENCODING UTF-8
FME_BULK_MODE_THRESHOLD 2000
LAST_SAVE_BUILD "FME 2022.2.0.0 (20221103 - Build 22765 - WIN64)"
# -------------------------------------------------------------------------

MULTI_READER_CONTINUE_ON_READER_FAILURE No

# -------------------------------------------------------------------------

MACRO WORKSPACE_NAME parking_stats_weekly
MACRO FME_VIEWER_APP fmedatainspector
DEFAULT_MACRO WB_CURRENT_CONTEXT
# -------------------------------------------------------------------------
Tcl2 proc Creator_CoordSysRemover {} {   global FME_CoordSys;   set FME_CoordSys {}; }
MACRO Creator_XML     NOT_ACTIVATED
MACRO Creator_CLASSIC NOT_ACTIVATED
MACRO Creator_2D3D    2D_GEOMETRY
MACRO Creator_COORDS  <Unused>
INCLUDE [ if { {Geometry Object} == {Geometry Object} } {            puts {MACRO Creator_XML *} } ]
INCLUDE [ if { {Geometry Object} == {2D Coordinate List} } {            puts {MACRO Creator_2D3D 2D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
INCLUDE [ if { {Geometry Object} == {3D Coordinate List} } {            puts {MACRO Creator_2D3D 3D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
INCLUDE [ if { {Geometry Object} == {2D Min/Max Box} } {            set comment {                We need to turn the COORDS which are                    minX minY maxX maxY                into a full polygon list of coordinates            };            set splitCoords [split [string trim {<Unused>}]];            if { [llength $splitCoords] > 4} {               set trimmedCoords {};               foreach item $splitCoords { if { $item != {} } {lappend trimmedCoords $item} };               set splitCoords $trimmedCoords;            };            if { [llength $splitCoords] != 4 } {                error {Creator: Coordinate list is expected to be a space delimited list of four numbers as 'minx miny maxx maxy' - `<Unused>' is invalid};            };            set minX [lindex $splitCoords 0];            set minY [lindex $splitCoords 1];            set maxX [lindex $splitCoords 2];            set maxY [lindex $splitCoords 3];            puts "MACRO Creator_COORDS $minX $minY $minX $maxY $maxX $maxY $maxX $minY $minX $minY";            puts {MACRO Creator_2D3D 2D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
FACTORY_DEF {$(Creator_XML)} CreationFactory    FACTORY_NAME { Creator_XML_Creator }    CREATE_AT_END { no }    OUTPUT { FEATURE_TYPE _____CREATED______        @Geometry(FROM_ENCODED_STRING,<lt>?xml<space>version=<quote>1.0<quote><space>encoding=<quote>US_ASCII<quote><space>standalone=<quote>no<quote><space>?<gt><lt>geometry<space>dimension=<quote>2<quote><gt><lt>null<solidus><gt><lt><solidus>geometry<gt>) }
FACTORY_DEF {$(Creator_CLASSIC)} CreationFactory    FACTORY_NAME { Creator_CLASSIC_Creator }    $(Creator_2D3D) { $(Creator_COORDS) }    CREATE_AT_END { no }    OUTPUT { FEATURE_TYPE _____CREATED______ }
FACTORY_DEF {*} TeeFactory    FACTORY_NAME { Creator_Cloner }    INPUT FEATURE_TYPE _____CREATED______        @Tcl2(Creator_CoordSysRemover)        @CoordSys()    NUMBER_OF_COPIES { 1 }    COPY_NUMBER_ATTRIBUTE { "_creation_instance" }    OUTPUT { FEATURE_TYPE Creator_CREATED        fme_feature_type Creator         }
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED Brancher -1 117"   INPUT FEATURE_TYPE Creator_CREATED   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
# -------------------------------------------------------------------------
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   INPUT FEATURE_TYPE *  OUTPUT FEATURE_TYPE *
# -------------------------------------------------------------------------
MACRO SQLExecutor_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { SQLExecutor }    INPUT  FEATURE_TYPE Creator_CREATED    QUERY_SQL            { "SELECT<space>*<space>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Parkade_management<closebracket>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(SQLExecutor_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE SQLExecutor_RESULT        @SupplyAttributes(fme_feature_type,SQLExecutor)         }    OUTPUT { READER_ERROR FEATURE_TYPE SQLExecutor_<REJECTED>         }
FACTORY_DEF * TeeFactory   FACTORY_NAME "SQLExecutor RESULT Splitter"   INPUT FEATURE_TYPE SQLExecutor_RESULT   OUTPUT FEATURE_TYPE SQLExecutor_RESULT_0_yZOpFWkl7nU=   OUTPUT FEATURE_TYPE SQLExecutor_RESULT_1_N3993qDbe+E=   OUTPUT FEATURE_TYPE SQLExecutor_RESULT_2_3WtwIOyz95U=   OUTPUT FEATURE_TYPE SQLExecutor_RESULT_3_NIPbZkFsNpY=   OUTPUT FEATURE_TYPE SQLExecutor_RESULT_4_YNcSSUd2Vlk=   OUTPUT FEATURE_TYPE SQLExecutor_RESULT_5_xLO4f8LKvv8=   OUTPUT FEATURE_TYPE SQLExecutor_RESULT_6_PkgVg+rKm/0=
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME SQLExecutor_<Rejected> INPUT FEATURE_TYPE SQLExecutor_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, SQLExecutor<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FACTORY_DEF {*} TestFactory    FACTORY_NAME { WestParkade }    INPUT  FEATURE_TYPE SQLExecutor_RESULT_0_yZOpFWkl7nU=    TEST { "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>parkade_name<closeparen>,WestParkade)" = West<space>Parkade ENCODED }    BOOLEAN_OPERATOR { OR }    COMPOSITE_TEST_EXPR { "<Unused>" }    FEATURE_TABLE_SHIM_SUPPORT Yes    PRESERVE_FEATURE_ORDER { PER_OUTPUT_PORT }    OUTPUT { PASSED FEATURE_TYPE WestParkade_PASSED         }
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsWestParkade_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsWestParkade }    INPUT  FEATURE_TYPE WestParkade_PASSED    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos><at>Value<openparen>zone_id<closeparen><apos><lf>ORDER<space>BY<space>week_start_date<space>DESC<semicolon>,GetLatestDayStatsWestParkade)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsWestParkade_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsWestParkade_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsWestParkade)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsWestParkade_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsWestParkade_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsWestParkade_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsWestParkade<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsWestParkade_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><comma><space><apos>%Y-%m-%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayWestParkade_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 60 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayWestParkade }    INPUT  FEATURE_TYPE ConvertDayToUnix_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><at>Value<openparen>Occupancy_Table_Name<closeparen><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>week_start_date_unixtimestamp<closeparen>,GetAllDataFromLatestDayWestParkade)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayWestParkade_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayWestParkade_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayWestParkade)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayWestParkade_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayWestParkade_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayWestParkade_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayWestParkade<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayWestParkade_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddWeek }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE AddDayHour_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>first_date<comma><space>last_date<space>=<space>get_week_bounds<openparen>feature.getAttribute<openparen><apos>Date<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>first_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>last_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddWeek_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerWeek }    GROUP_BY { week_start_date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddWeek_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.week_start_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.week_end_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.current_week_start_day<comma><space>week_last_day<space>=<space>get_week_bounds<openparen>datetime.date.today<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space>str<openparen>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>zone_id<apos><comma><space>self.zone_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>self.week_start_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>self.week_end_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerWeek_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_WestParkade }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerWeek_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>week_start_date<closecurly><apos><comma><apos><opencurly>week_end_date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_WestParkade_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_WestParkade_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_WestParkade }    INPUT  FEATURE_TYPE CreateSQL_WestParkade_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>week_start_date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.week_start_date<space>=<space>source.week_start_date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.week_end_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon><lf>,WriteNewStats_WestParkade)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_WestParkade_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_WestParkade_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_WestParkade_<Rejected> INPUT FEATURE_TYPE WriteNewStats_WestParkade_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_WestParkade<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FACTORY_DEF {*} TestFactory    FACTORY_NAME { UnivWstBlvd }    INPUT  FEATURE_TYPE SQLExecutor_RESULT_1_N3993qDbe+E=    TEST { "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>parkade_name<closeparen>,UnivWstBlvd)" = University<space>West<space>Boulevard ENCODED }    BOOLEAN_OPERATOR { OR }    COMPOSITE_TEST_EXPR { "<Unused>" }    FEATURE_TABLE_SHIM_SUPPORT Yes    PRESERVE_FEATURE_ORDER { PER_OUTPUT_PORT }    OUTPUT { PASSED FEATURE_TYPE UnivWstBlvd_PASSED         }
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsUnivWstBlvd_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsUnivWstBlvd }    INPUT  FEATURE_TYPE UnivWstBlvd_PASSED    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos><at>Value<openparen>zone_id<closeparen><apos><lf>ORDER<space>BY<space>week_start_date<space>DESC<semicolon>,GetLatestDayStatsUnivWstBlvd)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsUnivWstBlvd_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsUnivWstBlvd)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsUnivWstBlvd_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsUnivWstBlvd<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_2 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><comma><space><apos>%Y-%m-%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_2_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayUnivWstBlvd_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 60 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayUnivWstBlvd }    INPUT  FEATURE_TYPE ConvertDayToUnix_2_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><at>Value<openparen>Occupancy_Table_Name<closeparen><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>week_start_date_unixtimestamp<closeparen>,GetAllDataFromLatestDayUnivWstBlvd)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_RESULT }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayUnivWstBlvd_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayUnivWstBlvd)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayUnivWstBlvd_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayUnivWstBlvd<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_2 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_2_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddWeek_2 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE AddDayHour_2_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>first_date<comma><space>last_date<space>=<space>get_week_bounds<openparen>feature.getAttribute<openparen><apos>Date<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>first_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>last_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddWeek_2_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerWeek_2 }    GROUP_BY { week_start_date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddWeek_2_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.week_start_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.week_end_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.current_week_start_day<comma><space>week_last_day<space>=<space>get_week_bounds<openparen>datetime.date.today<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space>str<openparen>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>zone_id<apos><comma><space>self.zone_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>self.week_start_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>self.week_end_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerWeek_2_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_UnivWstBlvd }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerWeek_2_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>week_start_date<closecurly><apos><comma><apos><opencurly>week_end_date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf><lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_UnivWstBlvd_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_UnivWstBlvd_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_UnivWstBlvd }    INPUT  FEATURE_TYPE CreateSQL_UnivWstBlvd_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>week_start_date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.week_start_date<space>=<space>source.week_start_date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.week_end_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon><lf>,WriteNewStats_UnivWstBlvd)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_UnivWstBlvd_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_UnivWstBlvd_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_UnivWstBlvd_<Rejected> INPUT FEATURE_TYPE WriteNewStats_UnivWstBlvd_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_UnivWstBlvd<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FACTORY_DEF {*} TestFactory    FACTORY_NAME { Thunderbird }    INPUT  FEATURE_TYPE SQLExecutor_RESULT_2_3WtwIOyz95U=    TEST { "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>parkade_name<closeparen>,Thunderbird)" = Thunderbird<space>Parkade ENCODED }    BOOLEAN_OPERATOR { OR }    COMPOSITE_TEST_EXPR { "<Unused>" }    FEATURE_TABLE_SHIM_SUPPORT Yes    PRESERVE_FEATURE_ORDER { PER_OUTPUT_PORT }    OUTPUT { PASSED FEATURE_TYPE Thunderbird_PASSED         }
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsThunderbird_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsThunderbird }    INPUT  FEATURE_TYPE Thunderbird_PASSED    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos><at>Value<openparen>zone_id<closeparen><apos><lf>ORDER<space>BY<space>week_start_date<space>DESC<semicolon>,GetLatestDayStatsThunderbird)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsThunderbird_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsThunderbird_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsThunderbird)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsThunderbird_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsThunderbird_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsThunderbird_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsThunderbird<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_3 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsThunderbird_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><comma><space><apos>%Y-%m-%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_3_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayThunderbird_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 60 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayThunderbird }    INPUT  FEATURE_TYPE ConvertDayToUnix_3_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><at>Value<openparen>Occupancy_Table_Name<closeparen><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>week_start_date_unixtimestamp<closeparen>,GetAllDataFromLatestDayThunderbird)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_RESULT }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayThunderbird_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayThunderbird_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayThunderbird)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayThunderbird_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayThunderbird_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayThunderbird_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayThunderbird<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_3 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayThunderbird_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_3_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddWeek_3 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE AddDayHour_3_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>first_date<comma><space>last_date<space>=<space>get_week_bounds<openparen>feature.getAttribute<openparen><apos>Date<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>first_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>last_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddWeek_3_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerWeek_3 }    GROUP_BY { week_start_date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddWeek_3_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.week_start_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.week_end_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.current_week_start_day<comma><space>week_last_day<space>=<space>get_week_bounds<openparen>datetime.date.today<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space>str<openparen>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>zone_id<apos><comma><space>self.zone_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>self.week_start_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>self.week_end_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerWeek_3_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_Thunderbird }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerWeek_3_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>week_start_date<closecurly><apos><comma><apos><opencurly>week_end_date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf><lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_Thunderbird_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_Thunderbird_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_Thunderbird }    INPUT  FEATURE_TYPE CreateSQL_Thunderbird_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>week_start_date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.week_start_date<space>=<space>source.week_start_date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.week_end_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon><lf>,WriteNewStats_Thunderbird)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_Thunderbird_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_Thunderbird_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_Thunderbird_<Rejected> INPUT FEATURE_TYPE WriteNewStats_Thunderbird_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_Thunderbird<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FACTORY_DEF {*} TestFactory    FACTORY_NAME { RoseGarden }    INPUT  FEATURE_TYPE SQLExecutor_RESULT_3_NIPbZkFsNpY=    TEST { "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>parkade_name<closeparen>,RoseGarden)" = Rose<space>Garden<space>Parkade ENCODED }    BOOLEAN_OPERATOR { OR }    COMPOSITE_TEST_EXPR { "<Unused>" }    FEATURE_TABLE_SHIM_SUPPORT Yes    PRESERVE_FEATURE_ORDER { PER_OUTPUT_PORT }    OUTPUT { PASSED FEATURE_TYPE RoseGarden_PASSED         }
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsRoseGarden_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsRoseGarden }    INPUT  FEATURE_TYPE RoseGarden_PASSED    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos><at>Value<openparen>zone_id<closeparen><apos><lf>ORDER<space>BY<space>week_start_date<space>DESC<semicolon>,GetLatestDayStatsRoseGarden)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsRoseGarden_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsRoseGarden_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsRoseGarden)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsRoseGarden_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsRoseGarden_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsRoseGarden_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsRoseGarden<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_4 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsRoseGarden_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><comma><space><apos>%Y-%m-%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_4_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayRoseGarden_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 60 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayRoseGarden }    INPUT  FEATURE_TYPE ConvertDayToUnix_4_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><at>Value<openparen>Occupancy_Table_Name<closeparen><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>week_start_date_unixtimestamp<closeparen>,GetAllDataFromLatestDayRoseGarden)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_RESULT }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayRoseGarden_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayRoseGarden)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayRoseGarden_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayRoseGarden<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_4 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_4_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddWeek_4 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE AddDayHour_4_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>first_date<comma><space>last_date<space>=<space>get_week_bounds<openparen>feature.getAttribute<openparen><apos>Date<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>first_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>last_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddWeek_4_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerWeek_4 }    GROUP_BY { week_start_date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddWeek_4_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.week_start_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.week_end_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.current_week_start_day<comma><space>week_last_day<space>=<space>get_week_bounds<openparen>datetime.date.today<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space>str<openparen>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>zone_id<apos><comma><space>self.zone_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>self.week_start_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>self.week_end_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerWeek_4_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_RoseGarden }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerWeek_4_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>week_start_date<closecurly><apos><comma><apos><opencurly>week_end_date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_RoseGarden_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_RoseGarden_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_RoseGarden }    INPUT  FEATURE_TYPE CreateSQL_RoseGarden_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>week_start_date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.week_start_date<space>=<space>source.week_start_date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.week_end_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon><lf>,WriteNewStats_RoseGarden)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_RoseGarden_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_RoseGarden_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_RoseGarden_<Rejected> INPUT FEATURE_TYPE WriteNewStats_RoseGarden_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_RoseGarden<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FACTORY_DEF {*} TestFactory    FACTORY_NAME { North }    INPUT  FEATURE_TYPE SQLExecutor_RESULT_4_YNcSSUd2Vlk=    TEST { "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>parkade_name<closeparen>,North)" = North<space>Parkade ENCODED }    BOOLEAN_OPERATOR { OR }    COMPOSITE_TEST_EXPR { "<Unused>" }    FEATURE_TABLE_SHIM_SUPPORT Yes    PRESERVE_FEATURE_ORDER { PER_OUTPUT_PORT }    OUTPUT { PASSED FEATURE_TYPE North_PASSED         }
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsNorth_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsNorth }    INPUT  FEATURE_TYPE North_PASSED    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos><at>Value<openparen>zone_id<closeparen><apos><lf>ORDER<space>BY<space>week_start_date<space>DESC<semicolon>,GetLatestDayStatsNorth)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsNorth_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsNorth_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsNorth)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsNorth_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsNorth_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsNorth_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsNorth<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_5 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsNorth_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><comma><space><apos>%Y-%m-%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_5_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayNorth_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 60 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayNorth }    INPUT  FEATURE_TYPE ConvertDayToUnix_5_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><at>Value<openparen>Occupancy_Table_Name<closeparen><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>week_start_date_unixtimestamp<closeparen>,GetAllDataFromLatestDayNorth)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_RESULT }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayNorth_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayNorth_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayNorth)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayNorth_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayNorth_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayNorth_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayNorth<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_5 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayNorth_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_5_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddWeek_5 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE AddDayHour_5_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>first_date<comma><space>last_date<space>=<space>get_week_bounds<openparen>feature.getAttribute<openparen><apos>Date<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>first_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>last_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddWeek_5_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerWeek_5 }    GROUP_BY { week_start_date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddWeek_5_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.week_start_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.week_end_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.current_week_start_day<comma><space>week_last_day<space>=<space>get_week_bounds<openparen>datetime.date.today<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space>str<openparen>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>zone_id<apos><comma><space>self.zone_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>self.week_start_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>self.week_end_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerWeek_5_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_North }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerWeek_5_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>week_start_date<closecurly><apos><comma><apos><opencurly>week_end_date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_North_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_North_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_North }    INPUT  FEATURE_TYPE CreateSQL_North_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>week_start_date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.week_start_date<space>=<space>source.week_start_date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.week_end_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon><lf>,WriteNewStats_North)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_North_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_North_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_North_<Rejected> INPUT FEATURE_TYPE WriteNewStats_North_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_North<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FACTORY_DEF {*} TestFactory    FACTORY_NAME { HealthSciences }    INPUT  FEATURE_TYPE SQLExecutor_RESULT_5_xLO4f8LKvv8=    TEST { "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>parkade_name<closeparen>,HealthSciences)" = Health<space>Sciences<space>Parkade ENCODED }    BOOLEAN_OPERATOR { OR }    COMPOSITE_TEST_EXPR { "<Unused>" }    FEATURE_TABLE_SHIM_SUPPORT Yes    PRESERVE_FEATURE_ORDER { PER_OUTPUT_PORT }    OUTPUT { PASSED FEATURE_TYPE HealthSciences_PASSED         }
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsHealthSciences_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsHealthSciences }    INPUT  FEATURE_TYPE HealthSciences_PASSED    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos><at>Value<openparen>zone_id<closeparen><apos><lf>ORDER<space>BY<space>week_start_date<space>DESC<semicolon>,GetLatestDayStatsHealthSciences)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsHealthSciences_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsHealthSciences_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsHealthSciences)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsHealthSciences_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsHealthSciences_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsHealthSciences_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsHealthSciences<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_6 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsHealthSciences_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><comma><space><apos>%Y-%m-%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_6_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayHealthSciences_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 60 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayHealthSciences }    INPUT  FEATURE_TYPE ConvertDayToUnix_6_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><at>Value<openparen>Occupancy_Table_Name<closeparen><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>week_start_date_unixtimestamp<closeparen>,GetAllDataFromLatestDayHealthSciences)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_RESULT }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayHealthSciences_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayHealthSciences)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayHealthSciences_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayHealthSciences<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_6 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_6_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddWeek_6 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE AddDayHour_6_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>first_date<comma><space>last_date<space>=<space>get_week_bounds<openparen>feature.getAttribute<openparen><apos>Date<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>first_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>last_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddWeek_6_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerWeek_6 }    GROUP_BY { week_start_date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddWeek_6_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.week_start_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.week_end_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.current_week_start_day<comma><space>week_last_day<space>=<space>get_week_bounds<openparen>datetime.date.today<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space>str<openparen>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>zone_id<apos><comma><space>self.zone_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>self.week_start_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>self.week_end_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerWeek_6_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_HealthSciences }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerWeek_6_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>week_start_date<closecurly><apos><comma><apos><opencurly>week_end_date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_HealthSciences_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_HealthSciences_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_HealthSciences }    INPUT  FEATURE_TYPE CreateSQL_HealthSciences_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>week_start_date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.week_start_date<space>=<space>source.week_start_date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.week_end_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon><lf>,WriteNewStats_HealthSciences)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_HealthSciences_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_HealthSciences_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_HealthSciences_<Rejected> INPUT FEATURE_TYPE WriteNewStats_HealthSciences_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_HealthSciences<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FACTORY_DEF {*} TestFactory    FACTORY_NAME { Fraser }    INPUT  FEATURE_TYPE SQLExecutor_RESULT_6_PkgVg+rKm/0=    TEST { "@EvaluateExpression(FDIV,STRING_ENCODED,<at>Value<openparen>parkade_name<closeparen>,Fraser)" = Fraser<space>Parkade ENCODED }    BOOLEAN_OPERATOR { OR }    COMPOSITE_TEST_EXPR { "<Unused>" }    FEATURE_TABLE_SHIM_SUPPORT Yes    PRESERVE_FEATURE_ORDER { PER_OUTPUT_PORT }    OUTPUT { PASSED FEATURE_TYPE Fraser_PASSED         }
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsFraser_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsFraser }    INPUT  FEATURE_TYPE Fraser_PASSED    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos><at>Value<openparen>zone_id<closeparen><apos><lf>ORDER<space>BY<space>week_start_date<space>DESC<semicolon>,GetLatestDayStatsFraser)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_QUERY }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsFraser_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsFraser_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsFraser)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsFraser_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsFraser_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsFraser_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsFraser<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_7 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsFraser_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><comma><space><apos>%Y-%m-%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_7_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayFraser_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 60 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayFraser }    INPUT  FEATURE_TYPE ConvertDayToUnix_7_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><at>Value<openparen>Occupancy_Table_Name<closeparen><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>week_start_date_unixtimestamp<closeparen>,GetAllDataFromLatestDayFraser)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { PREFER_RESULT }    IGNORE_NULLS         { Yes }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayFraser_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayFraser_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayFraser)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayFraser_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayFraser_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayFraser_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayFraser<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_7 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayFraser_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_7_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddWeek_7 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE AddDayHour_7_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>UNIX<space>timestamp<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>first_date<comma><space>last_date<space>=<space>get_week_bounds<openparen>feature.getAttribute<openparen><apos>Date<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>first_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>last_date.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddWeek_7_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerWeek_7 }    GROUP_BY { week_start_date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddWeek_7_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>get_week_bounds<openparen>given_date<closeparen>:<lf><space><space><space><space>#<space>Ensure<space>given_date<space>is<space>a<space>datetime.date<space>object<lf><space><space><space><space>if<space>isinstance<openparen>given_date<comma><space>str<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>datetime.datetime.strptime<openparen>given_date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space>elif<space>isinstance<openparen>given_date<comma><space>datetime.datetime<closeparen>:<lf><space><space><space><space><space><space><space><space>given_date<space>=<space>given_date.date<openparen><closeparen><lf><lf><space><space><space><space>#<space>Calculate<space>the<space>first<space>and<space>last<space>day<space>of<space>the<space>week<lf><space><space><space><space>start_of_week<space>=<space>given_date<space>-<space>datetime.timedelta<openparen>days=given_date.weekday<openparen><closeparen><closeparen><lf><space><space><space><space>end_of_week<space>=<space>start_of_week<space>+<space>datetime.timedelta<openparen>days=6<closeparen><lf><lf><space><space><space><space>return<space>start_of_week<comma><space>end_of_week<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.week_start_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.week_end_day<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.current_week_start_day<comma><space>week_last_day<space>=<space>get_week_bounds<openparen>datetime.date.today<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.zone_id<space>=<space>str<openparen>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>self.week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>self.week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>str<openparen>self.current_week_start_day<closeparen><comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.week_start_date:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>zone_id<apos><comma><space>self.zone_id<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_start_date<apos><comma><space>self.week_start_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>week_end_date<apos><comma><space>self.week_end_date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerWeek_7_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_Fraser }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerWeek_7_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_start_date<space>=<space>feature.getAttribute<openparen><apos>week_start_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>week_end_date<space>=<space>feature.getAttribute<openparen><apos>week_end_date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space>feature.getAttribute<openparen><apos>zone_id<apos><closeparen><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>week_start_date<closecurly><apos><comma><apos><opencurly>week_end_date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_Fraser_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_Fraser_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes QUERY_TIMEOUT 30 NAMED_CONNECTION AWS_UBCParking CREATE_FEATURE_TABLES_FROM_DATA Yes APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_Fraser }    INPUT  FEATURE_TYPE CreateSQL_Fraser_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>week_start_date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Weekly_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.week_start_date<space>=<space>source.week_start_date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>week_end_date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.week_start_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.week_end_date<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon><lf>,WriteNewStats_Fraser)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_Fraser_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_Fraser_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_Fraser_<Rejected> INPUT FEATURE_TYPE WriteNewStats_Fraser_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_Fraser<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------

FACTORY_DEF * RoutingFactory FACTORY_NAME "Destination Feature Type Routing Correlator"   COMMAND_PARM_EVALUATION SINGLE_PASS   INPUT FEATURE_TYPE *   FEATURE_TYPE_ATTRIBUTE __wb_out_feat_type__   OUTPUT ROUTED FEATURE_TYPE *    OUTPUT NOT_ROUTED FEATURE_TYPE __nuke_me__ @Tcl2("FME_StatMessage 818059 [FME_GetAttribute fme_template_feature_type] 818060 818061 fme_warn")
# -------------------------------------------------------------------------

FACTORY_DEF * TeeFactory   FACTORY_NAME "Final Output Nuker"   INPUT FEATURE_TYPE __nuke_me__

