#! <?xml version="1.0" encoding="UTF-8" ?>
#! <WORKSPACE
#    Command line to run this workspace:
#        "C:\Program Files\FME\fme.exe" C:\!Capstone\repo\TL16\data-consolidation\parking_stats_daily.fmw
#          --FME_LAUNCH_VIEWER_APP "YES"
#    
#!   A0_PREVIEW_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAADqCAIAAAADE4SIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAgAElEQVR4nOydZ3wb15XozxR0gCBAEqwAqyRSogrVKFGWZUm2JdtxjZ3mjZ2s4zjOJpueTV42xbvJxs57m02y2bSN04sTy46tuEhyVSEoUhKL2EWQICrRe59y3wfIEEWCIAiAkiXO/+cPMjhz7x1g5sxp9xwMIQQcHBwc1wL41V4ABwcHR7ZwAouDg+OagRNYHBwc1wycwOLg4Lhm4AQWBwfHNQMnsDg4OK4ZOIHFwcFxzcAJLA4OjmsGTmDlTjAc7R6c8AZCV3shy8u01dk7Mskw7NVeCMeSCYajV3sJBQbjMt1zo2dIf3TALBAVJxKxYtpWrxJBQb9IFiEcwwDgjgM3F3LcJfK7V7v1XhBLZHG/rUEalQpJgiCuzNRX98KvdU70XTg17mQxPp+JbKuXlMglBF4A7YRlWAzHMAwDwNY1r85/wKVCXvkprw+OjzpmzMZoeETd1OLllTNBxl/aoJp3mMOih+p6FYDDoldV16cdKnXMbAQYFQp4gRR9+Rv//r1/+/pyXMKiaPsvmII844WzGE60bt874bZhMfziUi16qK6fvfIMFwgLXGPaD0ukpNViAZx8vs9zX5uy0Ne0IphxerVTofGhfpqKt+267cSUt76hNpK4pCOnfqwcfjUqHkVUBOdL6mvjYpFgua5hAYhvfetbV3jK64BgOHpa550aOScQScYHTivKKmGm78LR85FyGRv0TR97xSOX2Y+9MqX3KyqKIOibPvaK/UK/uVTlP/aKR76BHdWHLT9/8S9GHuFjMdZpNltPn4rIZfbR13U/PxreV2E/1MvUKXhUAuh4cGbilr17rsplntdZLZ6YcXKIJxAM97xVXq3GZ85OHB2MlMvs5sNT9nKF1Dzx7KlIucx+7BUrhgkxNnzsFVPQf8FuDGhPeeQy+7FeT9DCYiyAeeLZUxFK5rL8/NhfjOUdUtPLQyE68M6FDzlPn/KMDI6POMVrKiHoZ+mYXK5YWyW+Khd+rdM3Pj0T4ZmnRosUpfqxfllxCTN5uNM0Gbd7xl/VCTdjMKo9fnTQMdXt9djCYpn90m15qNsSiZzWJX81p9lsPf3CyDQVH7j46wjXNghjgVjIj+O4caRrw7qWK3xpnEmYI//9wpmzZ3pomiopr5YUFW/euMkdKaSXR0yyLpeTJ5T6h17+1y98uoAjZ8+QzvRct3n4zNuy4tKyKo1IIiuvaVzuSUukpNlqA5wslZAfvmnZp7suMc24fnd8qv/062JpMckjK9Sr1rS0ztaw8oGKhYGOAU+8WenftXVjQcbMHs4kzJHbttRiGHKHGAEbCVtHFJItSgmBA2IBy3NkPsEmGBwA9miUAFB74OpIKwBobVJb3UEBuTeeoEpEsLp5NY7jJA7L5H/nYyiBMASwfZMcAGrVNcsyzQpAXVm6rd7B0HsEYhkT85968Zc3tn0HRBjk52fFEIsA/++f/tuXPv0Yjgd3bW0v1IKXsgZOw8oalmV1Ol0gEEAIYRjmcrlUqnLDzEyI5psHwrAVSBtm6TaUKwBu/PAmTY6zyEWEP8oAAG7vP7D/pgKuP3sQQiMjI7FYLBwO4zhudzoxnsAaEYo8FyaFVZEuQ/ndu1QnOh15XOZ8ikREIMoAwIWTz37m8UcLNu4Kw+FwmM1miqIi0ZgnECZILMIrV1Q24Biw+T3rYj6eVNO2lNOqstLCLHeJcAJrcRiGOX/+PMMwOI6vWrVKJpMlP2dZFgDGx8ef/PH/fuDxbwAAn8ASTL7fZ0pg3dZanOUp//TFr2676S4AIEkikUjMPwDH54b2xEJeKJLAMPSR93Rg2GVaYTQaPXv27NatW0UiEUIIIeR0uXAcP2sjAUDEx6MFMi7mkBJYi174//7hWZdjBgAYhiWIrIJfJI+kKRoAvvr5f17omO9+/0cAwOPxKIrKftnwjiTIMPL8WQgcZ9hcvkaWRTiOpZ0uHA739fVpNBqNRoMQSr5vJvX6gGTm7CGrp7qS6jHm86ZJCaxbWmTklQoWz4ETWJlgWba3txchtHHjRj6fv9Bhj3z6Cw88+hWC5BE4GKenqjUN+Uwq5mORBKKpxJ5VUrE4vdcZIeR0OuPxuMVqtdod5wNKXN2kAlBKSE+YTh7zTohH7+gGaJ8XjJPgRoOeZVGluuEfdpSlPtfpoKkp/cKODXlZYEU8Uq+fzPMa0yIiIUoDAGwuZ0pKSub8NRqNRqPR0fFxg9kSoGqguh4A+ARmNk7Nj2TNR8JjHVYDT1ikUcnu2a5Ofe7z+ViW7T57Llq8dkhngur6ZjHpidCzz50dSkt+qzArfIbTkZDfRYrk1p5nn/zm19LO7vf7GYY519v3ds+AoK4DqusbhUQwxlwcECDtJaQN0tHxUCLk4Ynk0YnXv/zPn0x9rtNBfT2TNunk/oc+9okv/wdCmNU0Va1ZMCa4KBhCCMOcVtMHb92S8yB5wvmwFsRsNuv1+vb29gyiKsljn3/ieKdW7HLIDtzJTL9w9OUqWkKV1+2iNSY4kSDrQHXDLVVZz4thOM0ybqftpNvTWKdpargkGpLSZHp62uv18ng8sVgcjcUTFAV0QgV6xyGtZVVdMMa6Tb1E/V0NFeaJp7We1g6oMSsPacd2digBwHy217314O31iGUwDAgcRyxz+fw6gDQSy2Z3hCKJyQsjVbHgDG2dmTapAAanjeV1mtE+Y0tbxZKuMf2FEwSdYACgu29AKZPsaL/kIgmFQr29vVVVVTMzM5FoZNByktc1pby/gf9sl6dd7X5a62nVuMGIDYGytUPZDmCpV1VfNng8FhIKxJGoXyS5tEyHwzE+Pq5Wq/3+QDA4BuB1Hjpsl28tL2I9NTVMl5bY2cF0TRHqod4jpXUHH1SaTzoBfF2Hifq7GkA/3KUl1B3K9UVKPp+KBudfkc/nm5qaSq5fo9G4vF4+zgKYwQIDZ7tnKHvQ31rXaoOaDqVF74B6VTU4up98/ZRm8w1qZU2N02z2dWk9OzsYsxlMRgLADRWNBzcWASA6Nm82HUGkf9U89pX/7D59ojIetWN2q9GW8w8nFuCRBBsJup55/m+37d8vlxdld14h4TSs9AwPD/N4vNWrs0qNe/9HH3vwU//G4/P5JJGgmcVPyIhcTPojNJWI7W4UKYovM450Ol1TOv3nmR47SZAA4LZOxyiGZVl8sSxBsYAoKq3GMOylX33ndz/7UerzaDQqEonSnvLyeTdL0zKpKBrP9xrTUiQmAxEaADYoI9XVF+WNTqfTGuCh/Zdd9a87ncl/UPEwTbMYninQgRjACJAKiEA4LhBJSiIj61fVGQBq4bLv8vHPf2X7e78AAHwUDcQYxGIYvtijgQAwEAuIUDguFEsfubEy9ZeFFNVwJPLXvjAAkCgeilHAYrDoLKnZEMIwTMAXxWNhvlA8e7rMvDbi9/o8crmiID4sn8O8d21pRUVFXmPlCqdhpaG3t7eysrKyMtsbAgGwgKwmPa++sQzLN0qo9w4MjGvVpa276tqTzhSSJDEMQwillVYA8IHt5QBwShdMRORkMACahgzvzEjCeGr8kJCR816nP/9Pjx383rfj8TifzzebzWazuaGhYSGBhQAQYBbDVKyyLk9lKi3OkLFn4mixuHKtfBdN0wihpIFTPW2Y8/h/dFcZALw65IuGyZDXRVVlWo83Ntw/fry0qPH+dduqqpQANxiNxtpJ3LBK1zRLl/zp959M/uO5HotCLgs5jUFVbebLdEb6zo91VpWufWD9trIyRSwW4/P5OI7TNA0wnVZRlYjFH90lBoC/nbEqi+Rhl2nRWVJYw93DI6dry7c80LZFqVDEYjGBQIBhmMfjGRsbW7VqVVlZWdoT33rlL3sP3Gc16TBNQ3XaI7IDMSwfh5KS0vLy8jyGyQsucXQu58+fr6ysXNILpHbj3t7eczZTt0XrDgRMrPF0j7W1IdegvM59yjg2kohGBQnSaJj2eDwGgyHpsVIoFBlONHoSo8NDPJKHhwLBwaM9L/YFKJ8N6irklx3mixj7+t4USnnrSpttMzaJWDQyMuL1epVKZXNzs1QqTTu4ze6YdsfHR88H3P2Tb9tDAXOelzkfZ2Rs6PxJGkWkiaLR4SGKosbHx1evXt28o3l+wjtN01OuRH+vtrgoYHt92iZh2b+/NBlIc71GX69utI+io2VkqX5qMhIOh8PhdbvXNZamiXP9+o/PhFhBOBQUEEbz0UzDAsCkq9M6dYGlGCHFt1ktXq/XaDQ6nc5QKJRZN3/pyGveBOl12UV866KzpDhvPBJ0ObAIooNxv89rt9utVqvdbgeAjRs3SiSShU5ki5u6Tp8IuIemTjj9fgtl6O6yrK+txhi0tP/4PCJGg+XCuQtj5zU1NQLBlU5zB84knMP09DSO4xrN0iIoH//slw6+/3GC5OE45BT5uQyjsy8ArlJh3UM7dy6k7KSlf3gsIa4BAIQgg55HseGJmfMSofz+LduwpeiDx4a8obBfzCPjeUdC0xIOWy54+hVFVR/efINSufimnDdHvRhgPBLPvByXX2eN6BXimvvXbxQKhYsO+9aoDyfwVEQsA1b3oId2KIXq+zdt5PF4i46cZhYBEcnavjbYe0O4r4Rf98CWDYua/LN5bcQfCAakUllBTMKAx35wY4VcvrBkXU44k/ASoVDI4/Fs3rx5qSeyCEeEgC+SFCStoahEOjnSSyplTpdLo1ZDxsjdbData85uBumuxltyWFiCYXBSKJSK0fKkNVCkIDzjIkP8Gbs9KbAyX/i+lkz65iw2AyzhN93bkm02CcCu7IfNY5Z3WH1TbnNR8bBYKMDx7N1l6Zlwnp7UD7Wob5BKmyDr27KwcALrEgMDA7t25XILfvyzXz/R1SUSiGTu4fN4BX0mr2wXm3/K77TzaNHgmCJBUU0NDQtF7q4kNrsjEU9MTYxWqqLGLqu7artc94LfW1Zyd8FyR/0xp900zVRSU8aaYCCwo7393XDh1wE8gaRL+1ZNZQ0ynR0lK+kz50hY3/LpRjA2VC3lt+ubfJMfRHZq8JDHenDfPgDHlf91OJPwIuPj46WlpfPTf7Lh0N9fZWQaHMMxQCjvrTk230SQcZVKa/9x3x6SfBe9Ud4e9zlsVgIHls33GtMSjtuNvgtForLHbj64JFuYIzOvjfgj0ahAIMjzWe/TvchIE5X42g/fsO2qOLCA07CSIIR8Pt+aNWtyO33aHlArxVK5gk9g0/rJzEG6RdlSU+OPMtFQYEI3uWb1KpqmF00EuzKEohTOl5aUFE/qdHleY1qqRDXl0U0AMDA4tG3LZpqmr9ZTcf3BIoRhmMU4lc8Pt2vdfZEEG/a7WZZN5lgUconZwWlYAAD9/f0tLS05Px49+tCp0z18u7XowDrD8b9N9pUVK6C8jmfvo8oVFbDExNHk1hy3zShNWFbX1x09cuRzn/tcbgsrIDa7Q2tI6HWjFZHxMzSCaaffW7a6TaPSqK0nOklY8mXOJ7U1Jzx5sqKs5LRW+8UvfrFQ61/JvDbi79K+XUMZzmMYTEP5jbvoEy/4xVvkEeOSfrik031mrFuMRdatXtXX1/vQQw8t++ovhxNYgBDq6elpb89963kkGhuwUgCA4zibd5hQyMdjCRax7M6moqvyEluIPx4909DUTJI4TS+L013Aw+MUCwDb68RXrK7pSuClc2YeT0DyBZDfwy4g8TjNRkL+O7bULClMWUA4gQWDg4ONjY0L7drj4OB498A1oYBYLMZJKw6Oa4KVLrCcTqdKtehWfw4OjncFK11gmUym2traq70KDg6OrFjpAothlqXwAAcHx3KwogWW2WyuqeEKh3NwXDOsaIE1MzOTfQ0ZDg6Oq86KFlhXK5eEg4MjN1buExuLxbIpNsLBwfHuYeUKrPHx8ebmLOuxcHBwvCtYuQKLpmlu/wcHx7XFyq3WwO1J4ri+GRg3uAOR5tryKtXi5VuvFVaowGIYZqk1bVcmVqe3c9CYQNBULmtvLXwvQo5l4g9Hzky6aQzHewwJ1vaSQlSY1zNBEMnUxccfebggAy6VFbr5eXx8XKPRcFXiMuP2hX72Sr/dNoMTRG3TeoIOaTR1y14/AiGKSvD4grs3ZVkBmWMuY3rzC32eqdFeQKh+zSYqEatraJpdoj7VGnZ2j9gMpA5TSEi73UHHw8Liyve28stV6fv0LB8rVMMKhUIFl1an+iem7SERH9+3uVEhT9975trizOg08CSJaJQnFMViYToePz86frEXsUUP1fWzWxNnvvXTNjGe/dfUuVTYQ8fCGE/4g65Dn3380QJf0srA5QuSPJ7HbikuUb38xx/tPPA+e9cvztDyKrLC3Z9Y9UgDmLWvHNHK5RFMLPYAMF1aYueDSvNJSOZRm89OubcWl7xuhZtbwQw1Nc6uw1PizcWRRP3DB9h4WCgSJGIRgKtQV3KFalh9fX1tbW0FHPBI19CpC26/y1ZWVQcMvW3DGhoV0qOPAFGJBJ8vuHPjldM7jp0ePj0ZPN/9hrRYOd6nvfWBhwjb4MQQlBzsYMyHg+RdDRXmiSPGkoMdTJfWp9asqqmBLq1HrfGQINcb32mbzFfW1ACYJ44YS1o1UAMwALCxRmkGD7x+Ybx4x/6tzi4tsVMDz5jgCx9qjPioaADnicDcxQms3AiEoz/9e//oSD/J42uaWlmabmhavWgToGxQSEibO8DEI6Kiksdvugq9VFeowBoYGNi4cWMBB/zRC2f0BlM0ElKUVlbWrvIax7BVbfMViuxVkjkHUCE3FQvhfDFr7Pz8Pz1WwJVnIBCO/uSFsw63ByOISk2TBI8H3DaEGBxfnugqiwDHmte14ThG0/Q9W7lNCLkzPGk6OWwLxig5Ga9rbmNZwLD86vdhAAgA4E8/+85v//t7V6u05Eo0CRFChRfTCPN7XYlYWD8+UDY12qRUYBb9cNfhYP1dMr32HV3DA+RWJeiHu7SEugPgcO+R0rqDSVUcPOn0Ds9OUJrNHlNCcfuWIhyDvDtcLIkiiejhW9a+dU4X9LvF0dGS5j1Yba2Ij0eXp82XTIgHYywAtMjDdep8WhSvXBKJxODgIIZhFEW1yGMgBxrn28wvGE/HPNWVVE/u/ZzekVfw2Ge/cRUL4a5EDctoNAqFwsKWwTrWPXJy1BnwOEsq1cBQEggxgAMqhIRBABisbtmIYRjJ492xPr1J6PZ4AQAhFsOyyq1DgDDAAKBEmWbAiYkJn8+H43g8HpfJZDa73RMIOplikXt8UlgV6TLk08dsIVICqwafWb+2pWDjrhisVqvZbN66dWtqz1mComLRaOdUhKbZ1C+eG6muE7/54def+/3ThVnx0lmJAuvcuXNbtmwp+LBvdJ03e2NBx1TQ69l0y4dg1hOYD1IhHoqxALBOEdNUz/UaJCiKR5L//ufupKWplJCeMJ1htJSZWSYjjVYHAKYqK32w/bKm7dFo1Ofzzd8W/tmvfD0QTZA4wRTonkHosi9HwOfHEwmpkP+jp/69IOMviX/81Oc63v9VACgWk75Ipu9wDgISPF6vUCR7bO/inRwcLs/hURoApEIiFFtyaSMJHw9E4oloWCAp+viey24GnQ4qK8NpG9anOj+bDVNVmhxzU1IWpWm0+5H7br5aSdcrUWD19vbm0N45BU3TY2NjkUiEIIjkq4xhGIRQKBRqaGjQ9pyZ1E8TsVWwFUSu2uDI83l2G00JrCqwbmxdm/r81KlTBEHYnE4WYQMuYVWTzHFIS62qC8ZYt6mXqP/Mji0AoHcc0np2apJ+bsYMZQDQXq8CUAhYfug4hQQx8Y6Hdl2STQu187U7XadNjN/n0dRUT+p0Od/3GUjKd/eMnh+Yvu/uO69AT0aDwTA1NVVVVXV24HwEV8wkpFBd3ywmPekEVsr/OMcRWaoowhEbjcft5488+c2vzT4lFouNjY2xLOvz+aqrq8/0D0zqjZjmBqiubxQSwRhzcViADCFUmPWakQpw14yRz+fHGPymWnbzxvWpY3Q6XdMCjZhfG/F3ad+qoRJ2zA6gUQEMThvL6zSjfcaWtoosW+akBJZz5E0hib3vvnuzOKnwrFAfVg5nURQ1MDCA4ziO483NzQttnE7WL/3yd34AfRAkphOSYpBQ7nO/euPc4lOkrR7BI3CKYSM+14//77dTH+r1+vXr14vFYofD4XC5ncXlAKC6v/6ihtW++50D61X316sAIOkRmuUXIvl8Y6QFAVZWNCeBNn2zZcSyLMOEAj7LiREHbXUYTbnd94vCxGM0wwRDIUXxgs3cnW4vTSUAgEUIz86fghAkD6ysKE9+otPp+Hx+e3s7QsgyMxMsapkZO+k8dNgu31pexHpqapiui87Hsvv3Q/dJJ4CvS+vZ2aEE88TTWk9rh7K9HszgqxCL/C5CKJs9XVLuI4TWr19PEEQ0GmVZ1mZ3DF0wiMEMFhg42z1D2YP+1rpWG9R0KC16B9SrqvUOizmdN/NiVoH6wVtIgTSRCJNCBUBo9owLSSsAOHns0LpNHYChJvxioGnXumYAaFrXDADgtYcWOnMWDGIJDAeAN958+7c/+1E23/lywGlYixOJRIaGhng83oYNG7LRhL/7/f+u2XyLvEipLBKOX8hXGUlqWJ6ZaV5Qf99dd5IkmVYJ+svzLwLAX54/DAAMw2RYJ19ExCCGIfwDt98LAO+/7+7Un8LhsMvlWqhm9OCY7on/eBIncJZZFqc7QRKJRHx3xw2f/+THFjomGo2KRKKf/ek0VNcDAJ/AzMaptOrJnCCsTIg5HE6SLzr/8k/+90f/DwCCwaBMdpmU+c8f/wwAes71sSybSunOAIZjMSqqrq5vUFcBwBc+9YnUnzLoO8lZxicNXo+LIAmGztYwjNFxHMdubN8JAPfefXeD+pJePDk5KZFIKirS5xm8NuL3+jxhv5dV595FNaVheU3D9+3dcrUqnXACKxMIof7+fhzHN2zYkH1k5Imnvl+zcZ9MVsSO9ekpKwDP/qaV3HePXGOCEwlyiQ1HkwLLYRjnR8y37t9bolQu9DCc0gX7+gf4PB7ZuCbD+K7w8OnhZ0lctJpqbNBoVjU2mM3moqIilmV5PN5C2R42u+O0mfW6nHyciVXWFbztMwCctf3ebTDI8frV4tKO7dtpmo7H43ahsBagqalpcHAwkUiMT05G44k+i420VCnvb+A/32VrV7uPGEtaNW4wYkOgbO1QtgNY6sGsTxq/SUgmGA4EGZZZt6apUeAyANSm00p+/cdniKpNQj4f4sGgqjbzZY75/q4f6xeCqkWo3rJhPY9HBgIBHo8nEAjWrVuX4cSXjrwWFNcjAJIOLzpLir8PfpOMkKsF2xvLilvWrHG5XDiOYxhG03RFRYVarV7oxNdG/N1dx1Fi2m2oLK/jq2BmlPzA/h3ZzfoOKYHlGHqjSMS79+67lnZ+gVhxJmEikciy87vf7x8cHNyyZctSc+K/+S+ff+9DHwMAHo9HURQAgBBA+xPQAgCAFUB7NPvReAQRp6nmVau/+42vJD9pamoKhUJSaZpkepm8mE7EwThlNfaM9lElbRrQ7JnjPiOB73IFahvL3BOe+95zh0QiUavV2XS9RgjRDOUwaWfemHDket9nwOvwBuiAQowjwBiW5fP5FEXVToABJqCpad26dQihYoVCN22lNLckT+E/0FDMIHjknSFSzXCrAS7PcRMIJZFgmBSJ9WN9jRvVqWHnC34cMBwjWDA6np92bFWrTnQ66tJ8jQAQckd8MX9DWT2bYIrkRWKRqKGhIcv+4RiGY4Agi1lS+GzhIhUfcEIsEkskEqlUWlJSks179Gff/fw9Dz7OoPL6huTzXrMJJt2WbJZ5CYalCZwEgHg8fu8H3ru0kwvHitOwJiYmVCqVXC7PfJjFYrHZbLkFE5946vt1Ww/KZPJE0Bkuz1cZ6bX92TmtLyYbmkTKjm1bWZY1m82bN28uKiqaf/DRN94GAJqmM3isEctiOA4AB/bftNTFPPDwowSGM2hZTELA2HAs8qPvPdWkWSRC8WZnt9/refNkl7y0Esdwhk1vVSV9ghiPDlH+iC9yYMcNAHDve24DgJGRkebm5rROw6d//2cA4JE4tViDa4zA4tFYXX3DbftuzOLyLuP5l495Pe4ltdGOxWIEiX/io0vedfzaiN/hdJSWlrF5POsUFXt74n+AwjZJb7rzxjaFQrFQfGZZWXEals/nW7VqVeZjzGZzIBDIJ/UBMQzDTpmnB4Z+/vyafVtAo1ZBQ1VOgUKf0xtk/CUiDNDFIhM7d+5c6DWegwzKEpvd0WVibn3/46uampYpcbRn5jd+48zvjr2wRlb+noMH5XL5Qo/Evl3tNE0L63YOD5xVlZRSNZneClO+133D03yJOB6LqEpLBgcHvV5vWVnZQgWyH/nwBwtzPRm5745br8AsKczTk/GQH5nOjpKV9JlzJKxv+XQjGJdwTybiUfO0vryyLB50nOjsvPs971koPrOsrDiBtajX3OFw+P3+zD6IzHzzXz7/wEOPAgCPz6OEVK/2pYvGYE4gnAlHw1/4j1vWNl7l6i4YhhEEYTG8beyyuqu2y3Uv5JmxMYeAI+KOeUuUawiceMenu+AjkcyPLa+sRokJx/OGDFYVHUKeeKhR3UTF2LaNG0mSbGlpuQI5E+8e/vLTf2/fd0ci4ifK16wBgIN7AYCd8AP0mSeyHYRm2GblDTiF/8OH7hUJBZAxLrl8rDiTMLPHPRqNDgwM7NiRl2Pmiae+X7v5VmmRvKJEnn/i6Fn7770GiwSq10jK77rtYFFR0VVRxQFAe+7893/4QxwnWXYJeZXZQ5K8BJVoaW7+zte+nOUpb53UMgxNEBmlD0KAYQRJ3LizPdNh1y+vjfhtNquqvNJsmAJNjoHClNPdPdm7b3sLn8crKirK0h1cQFbQeyYJy2aSIGfOnNm9e3eGA7IEA8CwzrPP+s1lFfSZ3DdwAUDAEfTG3KUlTQSBv3N/XAVV3GZ32ET8lNIAACAASURBVNnSm+//eHNzy6ROl/N9n4Fk4qhNP/Knvz7bsX3b6OjobbfdlvmUvbs7Cr2K6xObxUyNvzaIYXCi03HjLvrEC37xFnnESEIFLDFsHY94z/b1CUlyzZo1V75r+orTsM6ePbt169a0fxoeHq6srFQqC1BP9r1Jk5BHUFS+naV5JB5PULfsvemTjzyU/8Jyxun2dBlof8CD614/QyOYdvq9ZavbNCqN2nqiM4f7fj4XM91t06Kw8eDN+2dmZq6K0XH98VZnd5ARIoTQEqMls8typLYi3nVjIcucLJUVJ7AWMgkTicT58+cXkmVL4omnvq/ZdLNEJqtSlYxfyFcZSeZhOQ1jeMi4e+eOkeHhRfWO5eNvL71akA3d6UEIMOzA/r1iEdd+jSM9K8skTO04n8+5c+fydF2l4JEkKeALhRLz8d8NUghOvHDKW7a6jWfvo8oVOWoipFDEi/NLlMqGhqvpek/mBHBwXC1Wlobl9/vdbvf8Zz4cDk9OTm7YsKFQEx168SUAmFVEKF8O3LxPJhEXZCgOjmuXlSWwRkdH6+rq5meunz59ur29/SqWJePg4MiGldVINRwOz5dWyZ2unLTi4Hj3s7IEVtrk5qGhocLWd+fg4FgmVpbASmv/Zr8dmoOD4+qysgTW/KzRcDh9VVkODo53IStLYM13VI2Pjzc3N1+VxXBwcCyVlSWw0vqwOHc7B8e1wooWWJn3FXJwcLzbWEF5WPOLHAwNDTU0NIjFXEImx/VJNBZ/89xEJM40VhZtbsnUZvxaYUVtzZlb5CAWi3HSKhu0A7p+g59hkVpB3LOn7WovhyMraJr9yQun7d4wAmQMNXSOdTfU1xVk54WQT0RjFAtIyTpu2LapACNmzQoSWA0NDRn2EnIsxJje+uaoe2LorEAohvb93/5Td7l6ed/VJI7FE4l4LCQUyR67aTn6XawItANjlLDE7zMQOJFQJUIxkISwBHNRYs3uKnR5hyG9oxtm9++YT6kE9HojQeDyMs0Ny3kJ81lBAmtwcHD9+vUpgbUcwiscjb94csgdQUIe2rte06QpL+z4V4URo4tKUHyhkC8SW6bHJNKiGdM7nbUseqiun9NYVFWdXpzNOmyRRwIDoCJelIhHqMQrr43efsv+5biu6x6aQYih3TMmuVL13C++fev7PuE4/YtetriKrHD3G0taK5wA0KX1QQQTiz0ATJeW2Pmg0gxQY4Zu8xjUKNsBus0ek9ENULKzQ9l1eKr+rgb9VOKhmwkcBwSwTNX9F2YF+bDmFJaZmpoqLi4uSPWrFL955czQtMNpna5dvZEvEKyqqwlRBevoTWBYgqJoKsoTiB+9cW4f+eXj1c5B7YR7tLdTIiv2ue1tu3bjM4MTQ1BysIMxHw6SdzVUmCeOGEsOdjBdWp9as6qmBrq0HrXGQ4Jcb0z2IiXUHiC3KivA2aUl1B1QY1aawZOc4NLzoPXs1MCRhOrRmyVBHxP1kxJFE2HgBFZuhKPx/zl81mS2YBhWt2YjFXILeDhiLrYgyQ2WRTiOifiYsqIOIfTsT77+7G9+UcA1L8oKElhzSvedO3cunzYTaXnq0Bn9xAhOkHy+qKa+OeQy4E2b0/b4TKeSLKJ3EDgW8dkQnQBSuIpvu+PAzYVd/EIkKOq/D2n9FM4XiBEdZ2Z6hwcHMBxHyxVjxViWuWFnOwCUqio+fP/V6X93fWBxuN84pwuHIhIIlbXsBgA+gSfy6IMr5uORBAsAr/7+//3oqW8venzBWUEm4RzRvBw5DSICoqEQixi/x0El4lWYY+zpUc/BDiWA852+5xd1DdAPJ3UNONx7pLTu4GxVHADS6B1lj94sJYTAUDjvytW3Qwj5vN5d9SK9K+T3TooIRr7nvvaD/yAV4KH4sgis1BO1f7WY2zKVG3q93u124zieSCRaSomIGPeECI/9sLEz4qupincb8qnZnaRxTe5dWvJhBWlYc1Sqnp6e7du3F3YK7YDujSFHgqKKFGVufd/0+ZMMzWA4hvJpCAcAAAgDxKId2zYDgLKs/JEPpulkGY0nurp7AIBhWSI7tT/lyNt341znKUKou7ubx+OpVKqioqJEIjF+YcJqs/n4NYSld0pUFdYW4L6fz1UXWOO6SQBAiE025skSlmFxAgeANU2N2c/CsuxC3cYycrHsa9q5hoaGFApFdXX1paMRwjDsQx/75N47HgDEwlKuaw4EAgYDAHj03r05D5IPK0hgzfFhZSjuvlTC4bDf749EIjRNTxitEUbot09O6fV7HvhnAJAI8HDeygifxBM0CwB7m0RC4aWmhCzL0jTtcDgD4dihc86kpSkTEsFYplryKTu0VMqzWC0Iw9VVle/dfJk7LxAIiEQiHo8359wnf/iTs+d6SR6PTja1LjQIAYbBod/9cjkGz4zP539zihkauwDV9WulPFcozQUmzXmYZdQnP6yoUkdDPpwv+cQ+NY/M5Lj0+fxff+qHZetvher6NWLCG2EuDguQZVCiRMqz2FwYUHxJySf2lM+OHS3UUYlh2GOjAY/TXlFROa3XVWlyrFubMgmP//VH/+eLn03bzXdZWUEmIcNceoZdLldZWVkOg0Sj0fHx8eRQLMuSJIkQEggEcrm8pKREIBAUFxcTBHG80zEJWP/zx2ErCJy14dHnC9vCL7WYEydOKJVKvcGICIKOh8lDU477GyJdFmMCuU29RP1ndmzROw5Nwf0NYDF7BmzTsPXg7fVgnnJU16sA4tEIS8UQQnMMZJ0OmprS3ItjFyYat99RtrpjdVPDhYnc7/sMJDWsXx46ViaiD968P8vO7zmDEDp37pzD4aioqLA63TM+DwDhPHT4uGJbmZTx1NQwXYdN/tbNj+xXATi6TzoBfF2Hifq7Gt4x6pXt9WCeshbJJNGgENjv//in//LZT82ewuVyGQwGALDb7RUVFUabfe36LU4wgwX6z3WbE/agv7Wu1QY1HUqL3gH1qup6qDmZwTnQ+JmDbMyHYThFRsKRiPSy3fvpOyol209YLUZmYsjBWh1GkwpgcNpYXqcZ7TO2tFUstWx3fUNd/+Dgjbt2LfH7zpcVpGHNNgl7e3vb2tqyT2swGo0OhwPDMJFItGbNmkW7sSZJ9s4hSIKh8+2dg2EIIey53/3v7A+np6dra2sxDAsEQyKR8OlOd/LzRTWsFKVSnmVmBgGhrlLN1rB0Ol3ajjWTesOAk4zHYnChf5q2AmjyvO/nkxRYdv3QahW/oz2TzX7srRMMQyelbZa/CGIRhmMAcNvN+5KfnD17trW1Ndm3dUqv7/fKHUEKAEoX0LAWhIklIkGMFJbGdB+852Dys7T6jn56+q1hZ0KqAQDFOxrWkiiR8sxWGw4MX1b20R2KlMad+av42re/J5CVsAjwPJJ5cAJjGQQA3/jMI7mPkgcrRWCxLHv+/PlNmy5m5WZup5qCYZje3l6EUG1tbXn50pKqvvLEk43bblWUqFTKoom8lZGkSWgZ7ynjJw7ccrNQKJz/MFAUPTk9/cV//bfPfv0/raZp0DRULzAaAEQT9jFrv1yqai+t4vP5zasujaXT6UQi0WwnyGw+9eWvyZQVJEkUKmjBspc9sTEsxCJKo6j8wmOPptZjAKgFaGpqommaYRiD0TiuN1tcIpiV+jjbRksxJy+MhyWioQCLCUzaPz328IcMADUMs2bNmtmnvHH8JAAEiTKRWAKIBmwRK8QbtfqjLuPI9L6NGwBg/55LfS0XkvupWXyglMqKgKUBz8rWYRBrCYwiFmskxXPmYln25MmT27ZtS7t5g6bp18ZCthkTwTBUTV3OL5WUSXjm5ac//vCDFRUVuY6UIyvFJHQ4HCrVpft5tnmYFoTQwMAARVFtbW25tTVnGEogEAoFAvPx1xz0wOirVbSEKq/bRWtMcCJB5tQ7h+CJipWSd6ykuco/j0c2r2r6/BM/1p56S1VeSRgM08ae0T6qpC1NA3dX3GYwn8VwYVl4NxOLRkNBj8dTXFyMYVh1dfVC0nnswsSN9zzq8TjlQl6kIvf7PgOH+/5dGOZhIsEzh55b39Ls8/lUKlWtDjMAQBOEhoZIkjw/Mur1B8Y8PqJLC1ChvL8BwDzxtNbTqnGDERsCZWuHsh3Acsn4TZKIhBgqjmEXVafaCTAAQay57Hvcv2f3f/3kF2K1UELhfBQJqha5zCnfOde4kU+UuFyumsry7u5uhBCPx5NKpXNE4Wz279n9+2cOJYrlgbhXQqKgqjabLzMccpydPixmpKRoq1RIjo2N2Wy2oqIihBBCaNeuXZnvVb/XHfUN2d+ecNTxVTAzSn5gf66NokqUimmT6coLrJWiYQ0MDLS2tqa05cwalsvlGh0d3bx5c561/T78+OcAgCBwJo/MlyQsj2II5sa2nZ986GI71WAwiOP4/BW+ORZwe71SmTzzgP7whRNDh2tr195Wvn5tSwsA4Di+aMTKYnP0mGgqETeMvmzRlZfnfd/P58XO7yJBvFW2d/eq+sb6egCQyWRzjgmGQjKp9GfH7UsdXESyHo+b5IvtZ5/79te+tNBhU0ZrjyEmlcsjrs7JUwi2qlUnOh11aeQ+APSMPmP2j69R7exQ1W3a0AoAQqEwm9if2ebQ6iMioTjq7Z48xWaeJQlFhZ/Tfre4RLFFuPv2GzaLxWKCILJ08zlcnsc/9+VUhDE3CJKgaRoQPP+Hp3MeJB9WisCaExPMILAmJydjsdi6dfmmmXzliSfr2vYqy8rpsC+atzLy8uB3+QGoErSoi4pa16zx+/0Mw+zevTvtwXaHc9GNR6lGvuWqpQUf/s93f7Dn4P3Z2Eq5YfVNRGLBrpeO/eF/fpz5yGmTGbHsRECMY8hunmY0jRlMYHdkcnS6r658bUdVFUmS9bUaADh9+vRCzSjP9Z8HABYhfDFHZzL5u7GhvrhormBdlIuzZJ3cwDAsQeAAsGXT0lrSJU1Ck2GqsaEpn8TRYNRwfOzXJBJWeqrfd9cdDQ0NC8Ull4mVYhLOfnpjsdhCL6WRkRGZTNbYmFUqTWYSibhUViyWOEeHu4d/8fyafVtAo1ZBQ1VOgUI6gMX5Eb5E3lhXq1ar1Wp1hojyUmVQ9oxdmNi4+67JadP61nXLlDh62vB3SUSwZfv2vz7/t7tuv81sFi70PNSpa5xud9iZGB85r66IWw5ZLQsrKdbYuMt6wWtzlMZ2ECxjNZtoms5gsi1VIuTGlZklRTwathimqOnTo2QlfeYcCUuOXLOIcdidFepqoUAQDIUAYKG45DKxUjSs2SqV0WgsKyub3+9rdHRUJpPV1NQUatIjvUYAAMQAlu+OQkdwKhQLdP/99d/++EcFWFmuRGPxo8NeiqLMb/bFNiGwqmndC4XN2Hi5+wcgjK6V3nRH27pajSaD3zrJS+fdiVhMKZdFqUwCdNJ63BgaVRdtuKd5Q3VVFQBgGLbSSnfc//Cjee75J3AiSkVxDH/h978u4MKyZyUKrLRKrNVqDQaDGV65S+UrTzyp3nBjaXllZVlJ/omjfx/4jjBAVAub1cWKOw/earGIrqQePhvtZCgSjWAsYzYbQVOfwQrLEYQAw/70v//1qx9+N8szvD7/oonpSbOLJEmZdCX2HEmahNOTY6tXr53W60DTkJuPIhUlHDn+l5t3d/h93p07d87PLl4+VqJJOF+JpWnaYDDs3LmzgDPG41FliUomGzj7rN2qqqDPGPPZyELEpDFZWCBWbl6/ViQSXWE9PMXYhQmDjXDZLaX+gT4awYmX3/aWrW7TqDRq64lOEiogp+jnbPgknmDYnR27nnnu+aZajd1uv+OOOzKfoiheJMLAkYTAScvJ3w2yCE50Om7U2H9zrvwj99A5/XAsQ/MFfKFQeIW11JWoYQWDwTmBJ61Wu2PHjpx2dWXi9fN2AMCAMRvzV0ZYAPyXP/jWM7/6aWEWlysvnrOziC2VS5Z187PXZrh5Y1WJUsmy7JV8gV/f/OI3v0+lzuYKBoAA4OMf+XChVrW06VeCwAqHwyaTKdXOa84uaIfDEQwGC+Jon81XnniyZt0NJeVVaPyVHhrBtNPvLVvdxrP3UeWKJb/QkomjpqGTMjKxpqHeYrHceeedhV1wlrAIGYymXHftZjE+y+I4nozicXDMYUWYhAaDoaHhUqL5HBmt0+k6OjoKPmk8Hi2rqikqKpbseUgRZyFVDSGPmrKSUvXe1sqystLW1tZCrDEXcAzjpAnH1WJFCKxYLJbcLAYAgUCguLg49Se3253bLuhF+a//eGJiUg/gZRGLi/JVRhBCGA9bdfPFrUVZbp3j4LjOWBECa7ZKZTAYZrd6npiYWCh1MH9WNV4PjZU4ON49rKxGqgBAUVTKiYsQym2fIAcHx1VhxQms2YWfhoeHW1paruJiODg4lsT1L7DmpPbOFljRaDTP7c0cHBxXkutfYFmtVrVanfrfZQrGc3BwXAGu/6d3djXkSCSSUqmmpqZm5zpwcHC8+7n+BdZsG3D2TlqPx1NSUnKVFsXBwZELK0tgzQ4RcnBwXHNc/0H92U6rVELW8u0s4eB4F8IidFQ75IsySgl5YOdV2yaRP9e5wLLZbGnLk1+4wF7F3S3XLkOT5s5RR4RCpRK4q6OlSDK3ptgysdIKVxWcX7/UPTETiMfC1XXN/c+c3LZxQ5wpwCZiAQ+LxigMJ25fr8h/tGy4zgWWyWTatm1b8t+BQCBVpZMkp/n8q1RQ6prFHwofHbAPDZxhKGrzDbf919/6xAIyVl6nAkg2Fp3dumZOu5o5pI6cc8qczjcyIeEJhBPRkEim/OTeyuW8uOsZjy/kpCVe5xhB8oM+t0AkmfFHg/FL74DZP9acHy7zD6QQgsViYhgmSq2a04h3mbjOBdZsu29iYqKtrS3578xFLAvC82/3mX0MicMGjfyGTauWe7orwPkJEyJEGGCKsorJkbNlVfVg0k681Ok52MGYtQSYwQbuI1rPwQ6mS+tTawAAurQedQdTc9Z3JFFysIPpmiLUfGVNzewmNyVdUx41nzEZCfXF05Vd2gmAEnWHZk8THnaLBYJo0DM8FljXXLDyiisKmqUxALfdoiyvevmPP9x18AMCy9HuhKyK3KqsAGeXllDD2SNauTxSvPPRMvPhI0dK6w4+qDTrVe3gNGuJhX+g+hvrMUA4jqFCNX1bjOu8vMzsSjJnzpxJalsIoZGRkfzbTGTgpVPne6Z8UyN9qqra6oYWCQ9hooLpzDIB4QlFEpGQSKZ4/KYrp3eMTJr/1uvoO/lqkaLEOWNq3bqnuXVTlFrG+0cmJNweNxMLkdLSfeoYJ7By5ucvdk1Y3LFIuKZhLRPxyoV4gmYYhsl5Fz0CDAPE5xFVtatwnGgpjq5pUC9+Wt5czxqW0+ksLS2d//mFCxdmp5IuBzN+OujziGUyiqJCfk8gFiKaFPPbfMLlxpEqXVvQ+Xo4AqBDLolAGA54Bkd869deod1Faxtrzk3M0O37MBxfvX47ax88/LNn4Z3uO4UFAQIWcALfd+MuHsBDB94vEQsLPsvK4aN3bH/hrXOhBBZzDq1tPxBlcADAMMhZXSkSEoEYAwBqvrt1dYFryWXgehZYRqMxpV65XK5UI9XC1m5Pi4BENBX32GdE0nDQ69QUF4NFP9x1OFh/l0yvJXbON446AA73XlTFTzrBmEEP1+xpIvmScCRISEoAYst6IbOJRqOt5aSI9ofilABFyPXtbXvuJnCMYZdDybrYPk/Iw/euWbA/EEdmDAaD0+lMOkYqhfHqxuozMbPNOK7vdsBWwGbA1mMsVwDkVLY7yZGjx1pXP17IRWfkejYJZ/cinG0bzulRuBzorY5njutiNJLKir2WCxNnjgBiCZJkaDqfYREChFicIG7s2AEAD33w/XJZpr2Qf+pxAQCfwBJZh4QQABUN80WSD22/TDnt6ekRi8WNjY3RaNTr9Y5dmGBVoaGXXd6aqkS3IZ9y9Qsv5CoLrIGhEVh6BgxiWQzHAWBj69rsZ8nNOku13kg719jYmEQiSWtM/PQvRwGApumcq5UQODAsRELhLzxyX24j5MZ1K7ASicTIyMimTRcr3qWEVCwWu3DhwoYNBesHxzBMKBQKh8OxWCwWi9E0zTAMQsju8oSR0GXVJ2KRphveh2GYXET6o3kJrBQCEt/XnOYxNplMOp2utrb29Nlz47pJou4mqK6v5ePRRLY+0XjQvUZ6ajzYURwaefiD70t+mLbPUIKmP/CRx/Lxg2SARSxiEUEQV7jDcPJxcLlcP/jZ04LGm6C6vpaHp20gljbQCQDFItzucCCcFCbcn7gnfSXb1CwYKfjJqyNQXV85S1F1WPQAkE0UtUxGmix2DINiZdnDHZfVoczQ37RTF5ycNpWWV+I4ZjFMVWly2aCWMgknOg/944MflF6pXkTXrUk4PDy8fv365L99Pl+q68Tw8HBKimUJQsjpdJrNZoQQQgjH8eQNh+M4y7IEQUilUpFIJJfLy8vL+Xw+SZIYhiVF2Okzoalp04xJD8YeraQ6eOpMDt0rs6Szs7OhoWHbtm00TSvl8gTFiMAMh7TD9bUJGrlNxpKdHUqoV1XrHYe0np0aGKhR3m6eeKVm1+3g6J6C9v0qAIThMxE1mttIMU2TnrfGQ7vu+GDr+i1moz63mz4jFzWsX/75BZWcf+dtt12BVKyhoSGDwVBVVaUzmHg4AJidh7Sh3bWJo0j5EEw8bUwGOsvu3w/dJ50Avi6tZ2eH8h2jXtkO0D0V3nkDTsUAUE3jXN9iJBIZGRnBcdxms1VWVo7qJi1mC5RXgwWGTnd5ECq56CuwQY0GztWrtugzB+nie+qAiSIEdCIx72oy9VUK+D3R0QHevjWOV19wrNtinzaW1+2iNSb3b7rLv/HlJT0eQgFPNzW1acP6pZyUO9ethjXbBuzp6dm2bVvyju/p6dm+ffuip9M0PTw8TFFU8iyVSlVTU5PzM3PfQ48AgJAviCXiuY2QBLGIZRmCJJ//3Vy9I6noyeWXNbz6l29+GwD8oajDYcMxyOxrwjBgWbapvj7ZYfSpJ/41+flC+5mODvtsVjOaGptBMwAaFcDgtLG8TjPaZ2xpq8iz2VdKYDmm+netUzdlbBGSoOmXj7wGANm3hMGwi3f+ve+5LfmJTqcrKipKOjotVuv//PK3mj3/CACiBTSshSgW4TbbDJCCWpX83q0VqcHnZ9KYLRadyTEWrwKA3FyBZTLSZLEBIEVJ+WwNCyFE03SGXWj3/sM/Qq52aBKRUBiNxQDgb3/4VW4j5Mb1KbACgYDVak2VQu7u7m5vbweAWCw2Pj6+cePGhU5ECI2OjoZCIT6fv3btWj6fn/9ifvvnv7IlzQSP36SpGR2/UBBlxDJ0okLOv/3ArSn3ykImwNuntA6sAgBQPBhS1WYQIsd1P405vRWi1jVFym2bN9E0zbKsx+PBMGx2k6EU33zqv3bsv5dFkFfXqAVAALbAFM3ED6zdWFt9cdU6nc4AUAsAAPX19YlEwu5wOD2ec6NxqK4HgCIRrtNNzrGb0lImJU0WM+BEdWVlm9xrANAghGHYbLHSeboHAIL8SpwgZgw6VNuUWQRH406jT6+UVdYCYBi2a0fqvah79YcTqz5zW1qFJznLsCVU19Q8Y5hEtY3ZCHqKiRh9o3xMtFogxXF81lxAUdSpU6fa29vFYnHaczt1wdEJHTAMXt9UmXeUcPiNP3zkwQ+kDccvB9enSTg+Pp5yq4+Pj6digkNDQ6nuhPMZHh4OBoPr1q2b07UwTxSKkrBQLBCKzMePORIWh9GUvzLCE8lWNVRf7gxObwIgBAzLJqi4EDM6np92bFWrTnQ66jSg2TPHLPXZ3YiIYBiToKlYLM6yjFKprK+vX0iv7HjPR8/3niktUbKarJ6xJYEB6hp4ToqktNWrFPPbNqxPuodrJ44bYA8ABMtCPJPpgk6XYGFA762sBjikNfLwyNYa98WU1ERxTUNZl9aj1kBNjdJ80eZNEo9FMJZh6QTDMrOHhaZLX+KuHdvfPNHpikYi4ZBc6pt68czMwt8eADhYk07fyYJAULFdxOedP3/e5/NJpVIAOPjPBxeS6rt2bB8cGZXEFbpJvVLu1S82S5JA3Dw8/QbOCoC/Xi6VjI6O2mw2uVyedFns2bMnc6CAisdtpq7AKb29jq+CmVHyA/tzbWwgEgmdLtcVE1jXoYaFEDpz5kzK7jt9+nSqzcTsf88mFAr19vZu2LBhdkOdAvKfv3quWlOHI8RmbKc+j3k/DUKOiJFi6I/sP1giv+R0t1gsIpFIqUy/N+Kvh1+d1E0IBPx4fL6n4xIMMNFE9Ev/9KliWVZRuaPDPqfDZrjwulNfXp73fT8P9NfjT0gUvE2iWw5sbVEoFDiOz1cZ4vG4QCD42XF78n+LRHggmpX5ViYlTTMOhOE1FaUPbClJPgXzRXM8Qb3UbycIsqxYEogymce0es6cGnqlqWHjbunqrZs3YRjG5/Ozsblomvl7n51lmfISeTCW1fqjCdvfu35SUV1LnQl866tfIgiCJMnsK5Hc//DHAICiaV6uUUI+nx+JRggMf+73nEmYH319fS0tLcm+XlNTUxKJJLn/eXR0tLq6OrWdMIXT6dTr9dk4tnLjt3/+K6NsJghChNPBjEZZNhw6/dUiVrZK1FYi4m9sXed0OoVCoUQiWbs2qyB6AfnQxz750X/++ju+pgKDEGbyD0WiQXPX8FPf+lfIGPZiWdbucH7qK9/8+Be/bTMbQNOQocl2lLIPTHcqJKpb69ZKpdLKinIAGBwcrKurS6tZmyy2QNDPsghfzPRlEYtjOADkkJGfoOiJycnsfXCp9eQwV6cuODI+UamuJQki56ffHuo7N3aYhxfVBMofuOcudU1Nhh+ogFxvJiFCKJFIpLoQOhyOpEqFEPJ4PPNbTvh8vunp6eWTVgCwdu06nV8okkgmB54zHTsxGuaV3LZdBQ1VOQUKBqBdVgAAIABJREFU6Sg/oWT5YuW2TatVZWUajWYhV8Vy8/Dn/uNsT2dFeQVrPDNKVtJnzhU0AIq0o4eK8eJVjRufff5v9997D8DkQmEvHMcrK8o//dXvabUnSktUxLTeYOwZ7aNK2tJYVZ7ojMUyYOdJNDQ/Fg431NW63e5Vq1Yt5AdQV1cAVBTkkjLA55FXcuMRyzLW6UnS2jtCVtJnjDmk0TE05fS4ajTFRAh7J7swU1yyUFxvGlZ/f39zc3NSYPX39zc1NSWdCH19fatXr57fcmJkZOQK6CbHBqwAgLM0i+f5hkBG/1gsFrKcHvruN74GGfWO5ebosM/r9SqVymXKdP/bySdFSn6b5OZ7d2+aE/1My9vjAW8gJBQtIr7DMUPnhVeqK5ruqd3c2NAAK7J2zf0PPwr5JY7yeLxwNEzixPOcSZgzsVhsdHQ0WZLB7/cbjcZkKpbP5zMajXOSRa/Yo/7bP/+Vkq/CCSLUZwhvYMEK9jO574f4y6mvKHH5atGmEonwvffcPTU1dQUqT6TlvQ9//BNf+g4OYDbpM1thOYEBQoDBL//za8/86udZnpMMtGcm1UVJJFyhmxM7dcHBkZFqdT2Pz7cYpkDTkIOb4lLi6Mm/7N9zo8loOHjwYMGXOp/ryiTs7+9Ppi8ghPr7+/fs2ZP89+Dg4O7du+cdfiU0WAC4/+67XuqfkYilzQ80+KM0aADy8EyTbBFTSvJ45Tff2Ibj+NWSVgDw8S9/r/v0iWrKMAAAx7utN+6iT7zgF2+RR4wkVEAd5JeKhQAwQHDgwG3PHHpOIZMqFIpFLfcVK4OWCskT2LreJvY0WY0vTL5YVqxwkrn+cPFEvFguj6sWzSQpDNePhjU+Pq5QKJKJf1qtdsuWLQKBAAA6Ozu3bds2J6MquY1mmWKC83ltyIFhGIlog8kEmvr8lZGnv/+NPz/90wKsLA+ODvsCfp+8WLGsm5+DTsOdO1bz+Xwcx1eg7bZM/P6ZQwCQoBJ8Xo6ZhhiOIRYBwIc/cH8hV7bovNeHwHI6nS6XK+lTP3PmTGNjYzLGr9VqW1tb50QGEUJvvfXW3r17r8wD8Ns//zVe1IjjeNGMVptgYdrp95atbuPZ+6hyRY6ayMzQ2xIeoywqksvlyxoxWGQZNns24bPcSNpuySgeB0eSZRRYgXD07MgUhrBdbav4y9mrxu/3T0xMJDNFe3p66uvry8rKGIbp7Oxsa2ubE/1hGOb48eO7d+++ku1znu0yiCUyhYRfqM3PQdv0HTtXCQQCHMe5bhocK4flElgzTu+fjk9gIoVILDVfOFeKHARklRFHMQyPIACgSFHykfffu+jxHo/nwoULO3bsoGn61KlTmzdvLioqstvtExMTO3funJO253K5xsbG5n++3JitMzCrGEg+JKud1FRxBc45ViLLJbD+9FrvgN4hFEkDXmeRQsVEg/w1bdn45XAMi4UDfNqW4FXUspN3334gw8EGg8Htdm/evHl6etpms23fvj2RSAwMDJSWljZevl02Fov19/crFIrlLt3HwcGxfCxXlJBiMMSiSs2q4TNvE8T4mvVbVXCy82kjyKFkZ4eyS+vZ+WDzQs5nOtpS3N3nOwALq0E0TZ87d66ioqK6urqrq6u2tra5ubm3t5ckye3bt892Tk1OTrpcLoFA0N7eznltOTiuaZZLw3qte6jXgtwOc0l5DV8owumoQFYCi2/tx3AcGIpJxMMCkfQTe9OINIqi+vv7aZoWiUTJrWQ0TQNAUVHR6tWrAQAhZLVaZ2ZmksfX1dVdsZ2ZHBwcy8oyOt1fPjU45YrjGLa2WuJDRQKhKOQ0Zt5MN+Y8ZjZOrKved+fGpmAwCAANDReLsXi93pGREb1e73a7lUolSZJqtTqRSDAMo1Qqk6pTMq6EEKqsrKyqKngFAQ4OjqvMlUhr+NtLr/rIaiqRKJb2av8SBwWU37iLPtFJQoXqHy6L6B869U0ZCOrFrTIM/+Nvfq3T6SoqKpLCiCRJmUwmlUqVSmVyD7NKpZLJZAqFQiKRIIRUKlV5efmVjP1xcHBcYa5QHtZrQy6C5EkERDieqUbHecPrIKEr8eb37dywkL8pGAxOTk56vV6bzYZhWGNjI47jSqVSJBI5HI5kjdBkLWMAqK+vLykpWZZL4uDguOJc24mj0Wh0eHgYAEiSpCgKAEpLS+vrL3b3Qwjp9XqPxwMABEG0trZy+hcHxzXNtS2wUpjNZpPJVFNTIxQK9Xo9j8fbtGnTbB2NpunBwUGKourq6lT/v703j2/rKvP/n7tps2TZkiV5kWXLW+zY2ZzdSQhpaEm6Qgil00LZWmAKDAN8ecEMPxhmGODH8IXvtwNlGWjLlGkLbUjTFGi6ps0ixXsS77Zs2ZIsW5K173c73z+Uuo4t27IjO2l833/k5UjnnnuudPXc53nOOc9ntfY9CQgIZJebxGClsNvtdrt969atqc3PaVddDQ8Pu1yubdu2ZaVeu4CAwGpyUxkseKc+slarLS8v93g8qeLukqs38SOEzGZzdXW1RqOZrx8BAYEbkJvNYKUYGRmJRqMbNmxACF24cMFoNBYWzi4a2dnZWV1dnSrvJyAg8J7g5jRYAOByuex2e2pHdF9fn0wmKysrm9XmOpbrFBC4LvhDkUuD9hwJtb3hPXnr37QGCwDcbrfT6UzpPPf29iqVypKSq5bOp5W3FMiE15q73WFWRsJtO+typOLrPRyBjBgYdR43Wxkgc+RKv627Kp9j2UWkgNJCEDjH8QDw0IP3Z3uMi3AzGywAsNvtyWQyZZXa2tqqqqrmFu1LLZ0XthlmznNvdF4a84f8U8XlNUw8vKdxQ4zN5l0kIjCaQwxNj/S2/68Hb89iz8vmpct+AMAxjF/K70VK4uF4kiDJuzelV2BbZZ54uaPX6gxMueR5qpqGHXTQLVG9u3DbPW7Vlhjn/j33vwUK0jY6CjhVbtAfaVzVS7upSiTPpbS0tKenx+/35+fnb9u27dy5c3v27Jllm+Ry+enTp/fv378SNWdc3sDZy2MsjyoLc7fXZ0Hz+UZgLMCFvG6W5yJBX6G+ytzSwhs3aQFg3AolRve4dVp7edaNPovplrOa5UrxyXEHSQCpruofHKqtqV7xS5oDz/OXL18uKCgwNTf39FsI434oMZZSeDKdbP3MC5l57dUV5e7JcZphX0Q192zOX+VLmEuMQeGANxz0et0O76SjUoP3Duka9OCb1HNWE1EKbadMSmUsb/fDGoepHxy+U7SqoaJ2J4DDZDplUh1qUgGAA2J7SiiKYNkkz2dUMyqL3OQGCwDq6+un7VRjY2NHR8cs4XWxWLx//36z2VxZWVlUlM06U8FI9MlTXS7vFEGQjnhNi/VimaFs2Z4ciWMsj1iG6W49/e3PfyyL41wGfq9LJJa89eIfNux8v54KDL3Z7TvUxDlMBDhgUq8Ca4/5pD1YoGgwAACYTb7SJk7v0IDeYz5pDzaUN4hUej2AY+hxk6/BAEB7ADRmk2+3AS7pDR+pTG0MRSukergYbrd7aGiopKREJBLhOAEYBuDwHDOF95UxryDVgzD0uE19qIkzj2iOHoTmsx6AgNnk292kunJFTaqdRnCMuIxlcCNFMBoZKPLU4YC3dtNusUSuL9EVEnIA0JYAbDUCQO3Od5qWPKAFgM9e+Z92p1H77ltQICXtEEGU9LVj/3V02z+v5iXc5CFhimg0OjQ0lEpmdXV1VVRUzNX7AoCRkRG3211VVZWt6g6vXOhuszN2SxclkuqNtclEFACmn8AzSetrzPI7FBLCNWEnMMSTObdVLkdBM1sce7Ozw+qPhvw6vZFLRHIpmmYBEA9ZKE+IMAxRJF5Tv5VlmEsXXv/uF1c7SwLpFML/etkPAL4p96TTfkXPZxEQACYisfLqDQRJ3nljhIQ0wxw7fdkZ4rFEYGdDWZTSAoBcjEeSmTpKcgkeSfAAcKBaBgCrv5hxTRgsAOjs7KytrZVKpQghk8m0Z8+e+VpaLBafz4fjeG1t7TUuejhl7m4ZiVxufkORV9Db/vbhez+Duy4PdYP6UJMKYLavccqmbmgCMIG+iTObwjJDhZr26Cve9TuOVIHTRuIYR8qur8ECgL+dveiJspEJS2/3pTs//U0AkIqIOL2cDG5apBT+/nWzNbpXh3g8brVa56pVDo85Lk4CAsRFvRFt+cLFQDyxS219f82RFlUntXd+8FaSJHNyclKqKKuPy+VyOBypPbYul6ukpKTfMjLmsKury9xtE9HyXeLe40F/RiK4SikRjHMA0H/mua8+8rnVGP3VrBWDhRBqaWlJiYD19PSUlZUtbIwQQv39/bFYLPX5KBSKysrKpapO+kORX7/UMenxEDhZYqwW8clkxI8Qv9Qq7AghHiExRVTUbqbppNsx8vcfbsr88G9+7wepP3AczzDpIJWI44kEAPbj73175utut3t0dJQgiFgsVlpaam5ti9KYZ5iEbSB2l0X7M73vFx/A9TNYFy9ebGhomPtdn7/QMpbMj0RCSun4yDkE20q1Z867y9OISwPAiOetc80v6MurGvhqfaG2zGCYnJyUSqUbN24cG6NWbWqa4ziTyVRaWlpeXj7zdY/Ho9Fo/nLRDQA5YiyazNQIyCVYJIEA4M7N12d/21oxWADQ09NjMBgUCgVCqK2tbfv27ZkfG4lERkZGUpUCU58YjuMcx6X+kEgkCoVCJpNJJBKxWDzzXne4ps5etHr9XhXF5K/bBwBSER6nl5mqlFD4gcx+xpFIJBaL9Q8MOCZcFlafijelFBZnFvq6p4PQXBGKTV2K8eoKY+WdG69kiy0W0GiCc0WY/+3RxwEAcAyuWe+L4xEAInD8m488KL5OO9W9Xu98FT6++I1/vvPIx8UiMkkvIibCY8mJ4DgdoR/5yJFZb6VdTPPkeXfqj0UrmswkP4ea9AZxAJE051NNs7dtWCxQWBiRyWTzPSBfaHVKpLJcCdE/OFRsyGhGaNrDqpb5qiquwyTSzZ90n2b9+vXNzc27du3CMCzlHme+lEEul88Sjp4GIRSPxyORSDQadbvdiUQCAKYdGYZh6otk44BHYvxwb4fUNzgsKY6Zx3T37NGeOe9elvjzfLjd7rGxsdTdGY/Hi4qKfIEAyzIcayWOjbiPVkjMDicHXnsHYfzKrq1W97FUnhjA0dbh3XbodiM4RtwlRi0Az9IF0qmJyKzbw6JUzv6l/fiXT5bV71JrdHKpeNiS6X2/KM/+9cz2dcX1dXVZ6S1zLBbLGECZX53WCXrsJz9cSmdb0r6aslYXL14Mh8NyuXxkdIxm2JFIHlW5QQsgIVGSRZBKawKknUWdhmGYRNCN4wSDAGDuPjOLXD6vL/ezx34jKd4gV+SFxvrdzLjbZtfCxNk3mbxPGdRnaHIx9bm+wSHv1NTOVZeYW0MeFgC0trY2NjYSBBGJRMbHx1dZkOJz//iNjTsO4ID4Jc588QghnicI4oE79uUrFenb8Pzg4GBtbe3ct55pnkr9EfJN0hzCFzx7yo7LxBhOySmxVOy7dPSOWxdo/5dzXeP+hFpTlOxusbEXvT3FbA6jK9/DGuyQwX0/H+Ndp4tUsttvu21J6+OmvD5YijrRdMsC9ZWkuMVigSEYq4aDKx+2sSybSCSGrVan09XqDQDoPWZTkiJk23Zy5hGidBL0BpjcV7vV6m4e8egrNOaTI8a7K1iAnVfmbTQKamx0lOfZXG3Z5963ZAHH584OEjghoSDBZHqIlII4AwBw2yad4npsa1tbBoum6Z6eni1btgBAS0vLakqQev2B81Y6GPCV6ouHLZbleSKu4Y6d60rq5qTbM9ljlBJqjob8nN64gAUJxPvaB19V5pTeadxaU1UFAKlUcVtbW319/SyRxxQf+cRDAEDiOHvNq3J4xCPE4zhx/A+PL+lAmmGe7wiEh4ehxKhVUN39g2lnY+FqbyVPRrh9ITYZlyhUjxy4sqLFarVOl1RbNfzB8G+e+D0AdFzuTqUaFrbUGCCaY0WUaOvGDQDwra9+eVaDy5cvl5aW5ucvtPjrefNYjjw37B6L6BaZQ5hmOiQsZEe3bN6c2UHZZA2FhAAgEolSdf4AYKlR4TXCMgyP+GDAi4/0uFmn22bXAnSN2nTlhr5OW92Wwkw8ET4eHh0bq11XM2fYFoDFPYLB/q7iIt593OaeP2HsizgnbTZUDPaJ0omJCYNe7/f7c3Nzt23blnbO4akTr9/x8X8o0OjC3olEUab3/QK82PEvIpb81TPH6w266sqKaDQql8tZlsVxPBaLjQGUQVVVFXR2dqbi7tSq4Amv3x8KDDhshNk0KSYDjTtU49Ye80l7TKM4uLvabPKVGkC/r7YEpsPeFCjuF5FUIhayOXiDvgQh5Pf7V99g5SsV3/rql08PhJQVvSRB4uVVC3+S0ej4aeuvibhYRWprjXqHw+FyuaYnVTiOq66uXtha/eyx30j1m+LRPs/YsP21s31RSn14hxYqijPLUVgdTpqmhZBwxenr60uVhA+FQhMTE6sZFf7qyf957c3TBEFy3NL0nxGPeMQTRHq/g2VZp9NpMCxyox158OGvf/enGIYDLPSNh2Pj9vCIUqo7snFzJkv///jyuTCSqQtiQ5cv9b3qWndLsZe87+CuRY+blydPfblAr2hg9lfoVBsb6mOxWGo+VyKRTE1NzY3XWJbleb5/cLA7VhiKcwCgVVDucEZBTp6McHm8wMbJHM09dYS+uNBqtebm5l6vstqnB0ID/X0EQeA4DraWvk5GvSX9LGQsNv6ncz/UFGk3c7s31pQby8sxDFOpVEvarfH0axcxABGF0QtOxcyEIjGGRQBw9P31KyrnPh9rzmClCmalgsHW1tYlzRVeCy6354KD93vdFHDL8ERevPivoiRel7N3o0FXWVERj8cJgvD5fCzLchy3ffv26yhYf/STD8NS1kwsAM/zCTqO4dhfn316GYc/98JJAPjj8RcRQiJKRDP0fC05jsflPMLQA4c/CgD3fvju1Otzl4yuMr9+4imO4zAcwxdLwyXpJI7jX/7cZxduNh/xZPJku1MuV+bJqFAi03nJQHzgQt9LcpnuVt2W9+1pwnF8lUuerK2QEAAwDJt+Cq3+hudEPOZyt068MeQuF2lhoi9jZyTg8qkLcxDHhSIRjuMYhpHL5Rs2bFiJ/Y9L4qkTrx++70uqAk2+UpGVhaMvXvqOiBE99j/P15cVvX/f3iX9Hu798N3f/eF/3H7/F+XyPJQMxQrnfTDQdOLlvu9LEjJ/JKZWSCwWy+TkJEEQ9fX1134J18IXPvPg6pzoV7/7vcywhU68ZWmm7ZpCttWWycx1OD7lcY6TZSKXx9Pe2bl969YM0xHZYs0ZLADAcZxhGIqi8vLyaJpene0FOq3mg8rkxx/9LYbjiOcdV2Re2x4/u/ixPKBEkg7j7GPPHF3ZUS4dhBCGYzhu6jjmdWozve8XwOsMFRTl4BguolI359J+DxiGS6VyuWIqnJx0H7/QN54+qsIxPOShQSPCRbkbG2q0Wm1RUVHaDVs3K1/74uefOHmOiVTnbwAFD3CHGtgYNG3Rsd0TI/MexTN4dVGTDBQf/dA9Kad+lQs0rbmQEABomu7r69u0adNqerMut8ds59yT4zXV1ctYOHry8nepBFUr3tVgKNq3d8/wMHbjFPI6+smHAADHcB5lISTkOA7H8Rf+58lld/Lqm28DAOJ5bP4wmWXZ1BzCbbfsX/aJ3tM0X+weCUkUucp8uaR/cAgMFZmkKaZnCae6Xzt6z53hcHiVJV3Wooc1Y65wVb1ZHMMJghgfe8tmdnqLdygtJzLfyOKdDKkLZTiGkyIKw7BVHvkC/OVc1233/r26QKvOzxu2ZHrfL8rvnn2xOF9SXKhTKpVLnbNbszZoSZw/f15h3M7zKNr+ahfDw5kT5/yami2Uq5PR5RfCYgvoOJ693NXVdfnyQw89tHqDXpseFgC0tbWlqieHw+G0a4tWgnA09um//wqBY9wSt7DwwHMMi+H4iaeX73esEI899WdZUbVGUxRse66V5WHUE1zKfT8fk4OtWyp1alW+TCYTpHBXiFMtg9rCklS5xAwPSTV2T44f2lGzomObjzVqsC5durR+/XqKohwOB0EQ2S2DlRaX22Oysa4Je+262mGLZXmeiLPnbEm+uLiwUKFQrP5aoflIzc0hBNc+h8HxPAaA4/j0tJ2AwEzWqMFKJpODg4MbNmyA1Vrc4PJMNdv5qalJse1MK4ve8UQMWkOp88x5EjJyRlxDrRuNGo1aLZFIBI0ygTXIWsxhAYBYLKbpeRfprAQ6TcHdGnjm2HlQFu/AMCjQAwAAD7Gxym36K436T/vTHcvzCCGeIIhPHf3wao1XQOBGZI0aLJixCIuiqNQqh1U46f2CxREQuAau2/Lo6850LFxfX9/d3X19ByMgIJAJa9dgSSSSeDwOABRFpSrzCQgI3OCsXYNVXV09MDCQ+lsqlaaMl4CAwI3M2jVYIpFoOu++fv16ISoUELjxWbsGCwCmCzyldkWtzRUeAgLvIda0wZpJXV1db2/v9R6FgIDAQggG6wpyuTwcDgtOloDAjcyaNli5ubnBYHD6v1u2bGlvb7+O4xEQEFiYtbtwFACMRuPY2Ni00J5YLJbJZAvI0gnMxOp0m3snaJavLMzZt/n6bIUVWGus0b2EKdLWwzpz5szevXuvY8Xh9wST3sCTr/bY7aMkKapY38jHAoay8tU5tZjEwtGYSCw9ulV4rqw51rjBSqPBy7Ls+fPn9+8XaiotxF/PdXU4ko7hHrEsp7CkgmMZBOiKsta4FUqM7nHrtNDWfDqgqbcy0eOaCUYH6USMZXlH+0s//fd/ydolrQ38ocilQXuOhNrecEPUU1sqazokrKqqSolEzXyRJMnGxkaTydTU1HS9BnbjQ+A4yyS9LocsN6/z7Mu33PMxwtU9dMrkO9TEOU6GJ++uKHQMPW7yHWrizKZAqQEAwGzylRp8JCitNmJ3E2ceIUp9QG5TgbXHbCJKDV6wBbtBqQT1bgNc0oPa5HM4VHq9x2wiSg0AwNlporRifaMGcTzC1/StuzwGRp3HzVYGyBy58sW3j1XlcyybhTL80+AYxiMEAA89eH8Wu53JmvawYH451Ugk0tHRIcSG8xGOxn/5UpvHFyIJUl1kIOIul30IEAbYit1OKFVxC+XlqfXlFQSO339w00qd6ybliZc7eq3OwJRLnqeqadhBB90S1bsFjWa6tAs4xQs0yBWjiXE7KZaXauRHdpZmffwgGKze3t6ysrK06gMsyzY3N9fV1alUqmX37/YFz10eo3mo0uVuqy9f/kBvPFxT3tdbBsIBnwSLa+pvwXEiR4RHl16uPnOmC4pLgwPv37Nz5U50s/KLk+1d3d0Br4tOxuW5qkoN3svoGvTgm9RzVhNRCiPdoFTG8nY/rHE87dMbfKdoVUNF7U7oaTaNzXB+VbcbofnRkalGRdw20/ndsK0gmYgn4om6ddWHG/JW4hLWusGiaXpgYCBVyS8tfX19iURi8+bNy9AEC0aiv3qxw+WdIgiyqGydBGJlhrKsS4uJSTzJ8izD/Pm3P3zqV/83y73PgeO4lpYWiqI4jlMqleNO55Q/4AONyNMzLCmOmceuUTVnAaYNFkx2HP7ALVnufQ3wp9fbWwcnnKODZdUNYolcX6JjCXkW+1dKMKfLQ4lkHScf/f0vV+RWXOsGCwA6OjoaGxsXaJBMJjs7O6VS6caNG5dktl650N1mZ+yWLkok1Rtrk4koAKTNMU/nnhd2xdO+q8ohHbZRAkeYTH3fFoVWU5D5CJfBuXPndu/ePUsP8fGnn//bqVdIimCZbOZEZiEWi5JJWpmf/8R//mTlznITQzPMsdOXnSEeSwR2NpRFKS0AyMV4JHmtfvF0JweqZQCwctJ5QuYSFtUrFovFu3btSiQSLS0tGIYZDIbCwsJMekYIODo5NWFX5BUcf/xHh+/9DO66nMpMqwA85pP2YEN5g0il1wM4hh43+RqaAEw+AM5sCssMCjUN+gowmwIwRRjvrmDBByafo83bTasb3vXDm26pTj11VkEXNplMlpaWzrJWNse4qmbP3bp6o0E/ZLEUGypW6OwpDyvsd//2v//wsSMfyl0t9ZCbAITQpUuXOI7LY1311SX9lojp7VPq6jJ320S0fJe493jmAk5pwd4ReXvuhZMf/9gKqmcKHta8eff5sNvtbrcbAEiSrK2tFYvF87X0hyK/fqlj0uMhcLLEWC3ik8mIHyE+W4l8jucJHBeRePm6TSzDvPHC737xg3+e2+yb3/tB6o/M1eSlEnE8kQDAfvy9b898Pe3KNZtjvM0JvimXzGkdY50ABi1A16hNV27o67TVbSlcnnDOXFIGK+hzJeztt9/6gVVWxHvvghA6ffr03r17px0fj8ej0Wj+ctENADliLJq8ViOQK8FCCQQAd25e2S9FMFjvSn4tFYZhhoaGUoW0pr0bsVisUqlyc3NlMhmGYQ7X1NmLVq/fq6KY/HX7AEAqwpchpJoWHIOUYFiulNhTeZW7EY1Go9Fo/8CAY8JlYfWpeFNKYXFmoa97OuTMFaH41OUor6owVt658d1lH2lXrqU4+smHCRznMjOIy4OiqGg8Wl1Z+9N/+6eVO0tanjzvBgCKwJiMFbEAQCkl3T4/RlDn//STp37980X7B4AcMRFNLjOszpeRLl8QMPyVJ79//A+/S71osYDBQEO6MO2FVqdEKsuVEP2DQ9foFyulZDDOciyzQRUvM2Q7eTkDISQEnU7ndruX8bimKGr9+vWzXozFYj6fb3R0NB6PI4QYhqkvkjsxIhxNDvd2SH2DK52ZBoDR0dGRkZGysjJfIMCyDMdaiWMj7qMVErPDyYHX3kEYv7Jrq9V9zOTb3aQCAEdbh3fbodvBYx6Bo0YtAMcxatkUHb4q9EMIpZ0wtTnG25zYHfczwMXMAAAatElEQVR/WYzz8aLyrDhTaRkK/c3S2wEInvjD/2zbtCk/P0+r1S7g4V4L/f39DofDYDC0dHSO2hy8fg+UGEsxLMmmMVgzU5Azl8tShmImFqbpxJHP/+vM9hzHdXV1hUIhhUIxMjpGM+xIJI+q3KAFkJAodQr3uBUgfcYT5slmxuIxOhrgOe5jX/rBjJctIlGaZ8zPHvuNpHiDXJEXGut3M+Num10LE2ffZPI+ZVCfocllCUom47Ehqy0UDm+or1/ioZkieFiAEOro6Ni6detKn+hz//iNjTsO4IB4yE6yaVpv/Uv33z7zdZvNZpjxlHumeSr1R8g3SXMIX/DsCCEMw2RiDBMpRCKJNNB15PDB1FudnZ21tbVSqXTWISmDFQ763WOnxy06XblICxN95H0Hd137JV5Fh/VPfSPNpZqN1Zx6f1OT1+v1KRRVFDXt9E15fQCAEI9hGQXd0y0L1FcZ4rfffruxsZEkSY7jWtva3zI1E+UVHrNNsq+MeQWpHoShx23qQ02ceURz9CA0n/UABOw29e4mFTiGTtnUDU2qneA5NlL94K3J0RGcFFUZy+/ZfMVRtVigshJxHAcAiURi2Gp1Ol2t3gCA3mM2JSlCtm0nZx4hSidBb4DJfbVbrT3NprHuwm2fFVket6kONakc4AMTgGhWNnPvwepRqwVwssxQ/tFti+9beu7sIIETEgoSzBK+hbSk4gaE+Du26ufeIVlEMFgAAO3t7SttsLz+wHkrHQz4SvXFw1nKTE+HhO6h1n2bKisqKmCeNBMAvNITCAb9sVCA0xsXeHIG4n3tg68qc0rvNG6tqaoCALFYjBC6ePGiWq1OnWIuXf1D//qjH+MEwXMrOUsoIoN0uFBd9Luf/W8AsFgsMARjAGWHqwwM83xHIDw8DCVGrYLq7h/MxDfJkxFuX4hNxiUK1SMHrojpMgyTTCbl8qvm+/////NzAPCGYtYRC0HgHLdI5ItjWJJNiilx48YNAPCtr355+q20YXUoEv3lb58AgI7L3SlbtqQpFBzHk0wi7ena29sbGxvT9va8eSxHnht2j0V01+oXp0JClmWMlLthxdwrEAxWimWnsTLH5faY7ZxjbDjfN2nLUmZ62mA5u08bNLm3HjwI86eZXukJtDWfLS7iJ1sBtpVqz5x3lxvAsH9WTDriecN84W+6YsN+XRMJnEGv9/v9CoWioaFhukDrLGyO8TYn8nrc66qrVnTh6FDob5aeDgrlb8qpOHhgf0lx8cAAl0z2MAzj8vlHgoGBERthhzwxGWjccWUeNqZRHNxdbTb5Sg2g31dbYu05NqI5ejBly/JkxIR9lBKJaEx8dJPcoC+xWCxjAGUAcz/D8xdaxnkNnaQpFI9oF/mFO0IXLg++IiaVZdHipu3b1CqVx+PBcbyurk4mk8131OmB0MBAH4ETeHnVkm6GyVB75/BLFJ5b7NPt27WjUKebmJggSZJl2YqKirSauz977DdS/aacnIBnbNg+xJNRSn14hxYqipeVo0gZrFg4KI1a9IW6jQ0Ny+klA4QcFgAAhmGpUGjlTqHTaiZffvrN198kCJLjWICLqddt4xcBoPU8wPlTS+1zOiQ8/ofHp19UKBRpr+W//uMbX/vOTzEMX1eDAADWVdel67OqoF68X5on0d2xafOs5QvzQRAEhiOxTNp27K3kZgTOUtZy4hqnydMSnYr5ov7KwnKO4VX5+QBAENb169fzPE8NDgaUm+s1HOwErYJyhxkA0B79ypVn/dFpb8tYf/Sq1A8uUXBMXCyXT19s2RCMAUAVpLH6V57uNvfxMff8Rh8A6GTS4/UaygpQGEkkEqlUWlNTM13IaAF4DhE4gG3EaWvp62TUW9L3P/solp90TRnK8xEgiVgiFovXrVuXl7fQWvOvffHzT792EUOFZZVFRYZpr2XUP7HoGNMQJTGaRQihuw+8b0UlPgUPCwAgEAh4vd7KysqVO4XL7bng4P1eNwVcIkuZ6WQi+srAj4kEtSln34aK4nKDIRgMut3uffv2ZaP7JfC1b39vdMxGUiTDZEcwLe2jQyKRJBIJkVjyx8d/mfao5144CQB/Ov4iQoiiRDSTRtw71TPH8bicRxi6//BHAeDeD9+detdut8vl8ln74ae50Nl1sbOTJIlF9wwTOB6Nx0iS+tLDn1645Sx+/cRTHMdhOIZnloZLQZJkJBqhSOqLGZ8ukaRfbB+Xy5V5MiqUuNZAfip6qa3vVWWO4YP6zXt274T5UxPXiGCwrrDoevdrJGWwJhyjQXfrRJYy0/F4+I/n/qmgMG8zf6BMq9xQvz6RSMyXZlo5bI7x1nHe43Kur60bsljAULFCE4WpdVh+twN5B7Zt2tDW2vrAAw/MavPdH/6HYcsH5PI8lAzFCud9MNB04uW+70sSsjrRVrVCsrmhYXJyUiwW5+TkzJ35vSn52WO/kRm25OT0+Jppu6aQbbVdy8z1oPu19vZXNZrSfZrtVcayhvXrF1gBcy0IBusKra2t27dvX9FTJJP0A597hMAJjs9OZprlEIsSAPCXp5/OSofLw+Xxmm1MMh7n+v/awiIY9QT9mpotBq2h1HnmPAmFsKw58rmkDFY05Es6Oj9y9x0ej6e0dHZJgH/50f+u2X23Mi8QnpocNTm94+mjKpahn33727ka+VbRrfu31BRqtQRBpN0DfxPz5ItnAYAgMG4pi8vSEmMCU9FJuTj/ax/7yIqmVgSDdYX29vbNmzPN2iyDVNLdPTleU12drYWjiUTkdcuPyISkXrRnQ5V+944dK+SHZ8Krb77NwyJrJrKCUpm3c+tChWVeffNtAIBUNZp5mE7/3XbLGq3U2HKxZzgkVuQq8+WS/sGha/SLU0l3hk7GRy986I5DoVAobab/2hGS7leor6/v6+trWLHZDQDAMZwgiPGxt2xmp7d4hzIbmWm3M6guAgwwEk+ZWgukSxavAjfOL//GGcmNzLnz5xTG7TyPou2vdjE8nDlxzq+p2UK5Ohld/jKdYpahAfi+gYG2lpaHHnpoJYYteFjvstKLG0KR6Gce+UcCxzg+O585x7OAMAB44eknstKhwJrileZBbVHJUvcbpSXViX1s5O5981ZqygqCwXqX5ubmHTt2rFAE7nJ7TDbWNWGvXVc7nKXM9Ix1WG+V6fIUMml5eblOp7vmjgUEblCEkPBd6urq+vv76+rSrk+6ZjCMwAmRWDJ+5qkuFr3jgWcnM02KxEU6rUQsXtFdEQIC1x3Bw7qKlZ4rfPbPJxDPY1kqL8MwTGqR3t995ENZ6VBA4AZHMFhXcfny5erqasFPERC4MREkYa5iw4YNXV1d13sUAgIC6REM1lWkNhVmWJZTQEBglREM1mwaGxsvXbp0vUchICCQBsFgzYaiKJZlaTrNvlkBAYHri2Cw0rB169bW1tbrPQoBAYHZCAYrDTiOFxcXj4+PX++BCAgIXIVgsNJjNBrtdjvLZqe6k4CAQFYQDNa87Nixw2QyXe9RCAgIvIuwcHQhgsGgxWJZBUEdAYHVYdju6rN5KBwd2L5eRK5UMaWVQzBYi+B2u51O5+bNm6/3QG4gaIZ56XyPN4ZyKDiwubxYk76gsMCNRlvv6Mvtjmginl9Q6HMM5iTH6UR8Gf1IpZJ4PAEA3/raP8hlq7otRDBYi+NyuUZGRnbv3n29B3Kj8N8vt/XapryTDkPNBgyhjeurI9esdT4TBIAQYhMxkTTngZ0FWex5jfNff20fHJ0IB6Zk8tzqDbsSgXGZ+t1ibDMF0GYJtc76b4GcHB0dxXhGWlD2md0qiWRFtGzTIlRrWBydTieTyd588809e/YsVWd4YNR5YWCS4TG9UnSoaQX12laTiQgK+qbEspywf6q4fN3ljjZUuVkLAONWKDHOUj+eK1A8zUzB5FnNEqEpxMQJUeTJp1//9AP3rez1rBkYDsJBb8DndtosTttwXYn0gmWsQQ++ST1nNRGl0HbKpFTG8nY/rHGY+sHhO0WrGipqd4LH4QAAyx9PorIC9e4H9lTziEtSJMWzyVW+BMFgZYRCoThw4IDZbNZoNNXV1RkeNeHxv3DBZh0ZwHEi3vi+S39q1hsrl11tCyEADJh4VCTNuX/H9fQ7SBwiQS9BUYMXTZGQ30BO9b7V4zvUxDlMBDhgUq8Ca4/5pD1YoGgwAACYTb7SJk7v0IDeYz5pDzaUN4hUej2AY+hxk6/B4AUAAI95hCgVcXYbsfuBciUJGELYey/JciOjVxLjulKOYdZtaqIokVpOaAgZQkidh0HtYQCovlJw1wd5h9UAcB8AABeF2gYlAKi/8AmEEIb54mFcW2zkeZYSSVfTvQIhJFwqExMTw8PDlZWVRUVFizZ+2dzTbovbLN0yqUKpKSJwHDBIq0ic1teY63fQkSmeTmCkWB7o+uwn/i47l7R0Xm3uMw14k4mYqrDENdjp7DufpBkANI8615JBCFVXVhAEDgA//O4/ZaVPgRQn3740HmTowPjBXZvsdB4A5EqIzGW+KBJnWB4ATr/w+H985+srONB5EDyspVFUVFRUVGS1Wpubm5VK5bp16xaoUEpiwHOszzVOK1WXWl5/3+1HiMmuoVMm36GmK7rEs32NJgCTD4Azm8Iyg0INMMfvQDwH19vveN8mI0qG/Qkq4OzM0YgOHvoRAEhFRJzOghpQjghPyUc35MdKSzIqaBgMBl1THl2BBgBMHReaGnfBO/vY/++pR3ke3dNwT+OGNTptEovFent7MQxL3aiS5NSBGkNHF/Pyyy+pqg3utolo+S5x7/Glygsc/cTnV3DQ8yN4WMsntegBAEiSrKurE4lEsxrQDPPoMZMvyhA4ochVTXS9NmrpITAcLcMRwQB4VFFeRhA4APbjf/3/Mj/0RIebICkAIDCMy+zrlpB4JJ4kKequjVfNAI6Ojrrd7pycHJIklUrl2+fO+xIoMELBNhC7y6L9S77v57I8g/WDoe9e+vnoc//51BPH/jBa3/1vdT9OGazvDf7TXfoP979mfeTBzy17SD5/AAB4HuF4pt8cj/iUEmpOjkw858aYC0LIHwgCAEI8lpmEKs/zOI4DgCp/XoXnnp4elmU3btw467FKM4yIop557SIAUCQsRf32ih/9/o36Yt11yEsIBisLMAzT19dH0zRCCMfx1L8SiUShUCRppm3QGQj4crBk3rr9JCWSivBlyHzJRHiM5gFgvTJSVqpfoCVCaGpqyuFw5OXl9fYPTPn8VmTAS6u0AFIKizMLfd3TkamcYvFQizehMVbU3/mOzbJYwGCg59rlj37yYQDAcTwrZXlS/Tz/37/N/JBgMAgAbs8USZK5CgVB4M/++cQDHz2CEPr+Sz8s2pRndNQdObzkoqwMw5Ak+f1nm1OfiSqH9EVn/7JnxvIzpxpkxipxOEzHo1KF6pFbFjK7NE2LRKJ/e+ZC6nClhAgmuCs9A8w3KQEABXLK7pxEOKFVyj6+d7Y+Y0rwbbom7VziieTJDmdK+bl/cKjYkJH+7nRI2H/hb5+//0MymSyTo7KIEBJmAYqiNm7cOOvFRCIRiUQ4jttZW2J3oMkp77h1gHL3DEuKY+ax5avszm9wHA6H0+kkCEKr1RYXFyOERBSF4xhw43BszH20QmJ2ODnw2jsI41d2bbW6j5l8u5tUAOBo6/BuO3S7EQC0755nrjdhEYlma4g9deL1D37sEbVGl69UDFsyve8XIOVhPfniWTk3defhQ5lUf41Eo8lEksBxxPMp4/XBA/unprwA8EjTFwAA1gG9mBMheuenEI/HW1paCILwBwIc4EwMLwFrz7GTfN42nYL36cF3yoaUhdVHD2rBOvRGG8hG4KjId2WqwUSUNoEejACBZFiEo3jY19rh3t54VUDa398fjUZDoZBUKh212wEnmUSEGocesylJEbJtOznzCFE6CXoDtBu1W62pSbqZyYHaEqCTcQIlEc1T4rTr4CwAVfNZKwD41eO/zzE0Mkk60trjZsbdNrsWJs6+yeR9yqA+Q5OLKQyo5KI33nr7rtsPL/KxZhvBw1o9GJb9u89+YXnKzxRJMiz71K9/IZNK5mtjs9kMhjT270SbixKJAKC/u51jOGxBsViEEIZhFImVVzVQItEdGxdZFPr7F17jZTp1gS7Sed7GXvT2FLM5jK58D2uwQwb3/VxSBss91qvgvXceOiSa/yeXwuaD37yNGA4w2ueesKUuIsP0/3Q7rb52ZxV1ZCsJAGfOnNm7dy/HcVNer9frOzelTjVO62HNfxWEP+AHJoZJlE268NZNV8SvUo5P6kPmeZ7jOMf4uMszdTF2xUWa9rAWpUBOORx2jCBKioqOblVnOLCZpJSfcRzjM9adm45DP3nXHjxL0gRLQjBYq8RM5edhi2WpnkgqJHSP9kpp111z/I5MBJ9f6Ql43JNsMs7pjQtYEFekvaP/VbmkqIYrPPSBAyKKysnJmZqaslqtmzdvlsvlcw85+smHAYDAcS4bISFGIoZnvvP1b2ydI2prsVjGAMoAqmZcrcnCv9CBUNJbJLXl0CyUGGmWDLiG0s7GwtWxG80RkAwAl+SZJE1WHKmbGgMoTCbr669aMffHP58AgOdPvIQQyiSTxYqSGIHfd+gIBtiOHTsrSt+dULZYLFXpvqokw7xw8q8A8NwLJ3keYRgsMJkjlpJxiOM8ee/t9wDAfXMkSHp6ekiSXLdu3QKDvNDZbQ1LFLnKqHc8oivP8KEyHRJ6hlrvev+2/PzV3uQghISrxxXl5zOvuVmn22bXAnSN2nTlhr5OW92Wwkw8EQzDCAxP92TLSPB5YtxeoI65j9vc20q1Z867yw1g2D8rJg2FvR6XmzIoSIrs6+vTl5T09fVVVlbu3bs3bZ9/Odd1271fUBdoEyFvoijT+34B3h59jHGGX249P9Dbv7G+LplIAABCSCaTiUSisiEYA4AqAIslGAxiGHbJioWC+g9X9XXYXaOTDsJsYniC2rNTNW7tMZ+0xzSKg7urzSZfqQH0+2pLAGaEvQDAJwIIEOL4eDICAGVDMAZicf1Vn+Z9H/mQeTh8ANPgGCZbV69bzB95seO74rjYG00UKiRcImIymSQSCUKorKwsrbUCADFF3feRD50eCL2PyZXJ5ERFzYIPlc6OgZcIyAmGAhWl+sHBwYmJCYVCkfqgeJ6vqalRKpULD9JkOq8wbuf50cnRAftrZ/uilPrwDi1UFGeWo+ATwZa2tg/eemtGrbOH4GGtHsFQ5LNf+ipJ4iy7ZE8Eo3iaoR/90Y/KS2Zn3GmaHh4eXlRO8ZljJxWFRkBAzrPlleU4AEB4cjI0kQzFv3zvvZkM7LGnjsmKajSaRE9ba9+rrnW3FHvJ+w7uyuTQ9Lzc/LMI465TH6jNyW3auQPH8by8vAXcjQsjcLyd5xNTxfIJmaoQAGiWFJEZxW40R6CEH0MMzyQZouIbd837IzcPhwdGxlg6SRI4N9rc18mot6Qx9yn+9NZ3xLn4ZtkH3re+Sl9SjON4yposyumBkHV0DHEMAICtZb6zeMJdfzv/e2PFOp1L+bEP3SOTSSUSyVL3YADAv//yqfz8AhIDNnMbwPOA4wDwxb+7famnywqCwVolppWfFRLRMjyRt4Z/wbjC+aKqKln+xob1yUSC47jUjCSGYY2NjSskWJ0J93768wBAEgSXcSoEABBKb7UxKeKALlGVPvrv38+knwsjcLwDAQDGBFxOKwDcsrMYENitFpGxaj4VbBzDHOF2OplofWNSXb5Lp6/T5ZFf+QB+6dKlxsbGtIeceuM0AHAcRyyYBAQAluFIijh08EAm4597Fo7nMcAyWUKxvFOkeOq5E4R2vSI3T50rzXzhaDwZOD3wcxQjdqkPvn9Hg76kJJN0RBYRQsLV4h3lZ8fYmYk3htzlIi1M9GXsjMQ8yRgfKJbJJRKJVqMhCCI/P/86Gqlp/nKu68A9ny7QFWvU+VlZOPrWyC/YiZiK0D977M+HDt7i9eZn+HtAVJ62bEvb334Srtibp4opc2Ph0ycuj6d3UhKJ2HD/yVw8747tW6Yi1vFYFRubam6279y5c77+r8U6ZM7qnAUApjyu/NyKKP6K9ZWYXVPIttoymblmOcY1ManRael4eNBi0ZeUZJiOyBaCwVoldJqC/md/daGljSBwjuNtjtTLrSNvZXQ4LgMWMaEqx4e/+Y2VG+QyuHDmtdrdt8ty2juOuZ3aTO/7BaC9KABBfb6qsECbn5/v9S7t96DM1xZoixS5eWI5UVk1b+hNUiKMVfBaMcMX+4nNOZSsSJnT1DR7NdNNzNe++Pkjn/gsAIjFomQvDQC2Zy8CADx7cQE5AwSIxTA7eB576mjqlfmyciuEEBKuEi63xzTGOMZGNmzcuIyFo6ctv2AnI/liY02u5rZbDmTud6wCp9ptAAAoS3uGEAcY8fzvH3385z/NpPl4AH53FsVniBwFPCMAgPEIzR9VIZ7HcBwA8jQVAAAYvK8au33DtY38PcX/+eV/FdTuy5Hn6lS5/YNDYKjIJE0xPUvo7j+3vb4Sx7CysrLVVEoXPKxVgqIokkQqtXZ87C2b2ekt3qG0nMh8Iwvt54NYqDQ3X5Wfvwy/Y+X4y7muMXdYU1isLSgYtmR63y9Aah3W7gOHnz325y0N9d3d3UePHl2gfUke/MtdswxT5bUNYU2AEGIYlmVpx9tPdTE8nDlxzq+p2UK5OhldfiEstoCO51ivzw88V1RUtJoGS/CwVo+H/+F/HXnwS9PP9qXB84Djx//w2G8f/ckKDG35PPL1b+296zN5ao2/+ZlWlodRT3Ap9/1cUgYr4LLVFUBD/fpwOLz6i33WCD/86X9CKiRMZqzCiRBgGAD889f/YeUGtgCCwVolXG7P+VHGbh3atGXLsMWyVE8ktXB0Yqg9hw9uaqjv7ek5cuTISo11ibR2XIQZ232vkVQ/s/ayCAikEAzWKhGNxU8PRsKhID94qpVF73giBq2h1HnmPAmLOCMpgxVw2SqUdOOmTeFwWKVSreoFCAjcAAgGa1Uxt7ZP78ZaEqmjdm8X9HsE1jSCwRIQEHjPIAipCggIvGcQDJaAgMB7BsFgCQgIvGcQDJaAgMB7BsFgCQgIvGcQDJaAgMB7BsFgCQgIvGcQDJaAgMB7hv8HEQGaSYMqWzIAAAAASUVORK5CYII="
#!   ARCGIS_COMPATIBILITY="ARCGIS_AUTO"
#!   ATTR_TYPE_ENCODING="SDF"
#!   BEGIN_PYTHON=""
#!   BEGIN_TCL=""
#!   CATEGORY=""
#!   DESCRIPTION=""
#!   DESTINATION="NONE"
#!   DESTINATION_ROUTING_FILE=""
#!   DOC_EXTENTS="6949.62 4209.8"
#!   DOC_TOP_LEFT="-926.115 -3979.95"
#!   END_PYTHON=""
#!   END_TCL=""
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="22765"
#!   FME_BULK_MODE_THRESHOLD="2000"
#!   FME_DOCUMENT_GUID="196a3198-434b-4d3b-ba73-5a5f3dd47a3e"
#!   FME_DOCUMENT_PRIORGUID="5d963a6b-0ac6-40de-be6e-da0a46963f5c,0465b10b-cd57-402f-9e88-d10485a04bf8,70e3beff-d4fc-4b05-aa26-e7c107af86fc,2f9c07d0-d748-4998-ac23-978bdf32976c"
#!   FME_GEOMETRY_HANDLING="Enhanced"
#!   FME_IMPLICIT_CSMAP_REPROJECTION_MODE="Auto"
#!   FME_NAMES_ENCODING="UTF-8"
#!   FME_REPROJECTION_ENGINE="FME"
#!   FME_SERVER_SERVICES=""
#!   FME_STROKE_MAX_DEVIATION="0"
#!   HISTORY=""
#!   IGNORE_READER_FAILURE="No"
#!   LAST_SAVE_BUILD="FME(R) 2022.2.0.0 (20221103 - Build 22765 - WIN64)"
#!   LAST_SAVE_DATE="2024-07-18T15:45:27"
#!   LOG_FILE=""
#!   LOG_MAX_RECORDED_FEATURES="200"
#!   MARKDOWN_DESCRIPTION=""
#!   MARKDOWN_USAGE=""
#!   MAX_LOG_FEATURES="200"
#!   MULTI_WRITER_DATASET_ORDER="BY_ID"
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="310"
#!   REDIRECT_TERMINATORS="NONE"
#!   SAVE_ON_PROMPT_AND_RUN="Yes"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   SOURCE="NONE"
#!   SOURCE_ROUTING_FILE=""
#!   TERMINATE_REJECTED="YES"
#!   TITLE=""
#!   USAGE=""
#!   USE_MARKDOWN=""
#!   VIEW_POSITION="2421.9 -2730.5"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   ZOOM_SCALE="80"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! <CONNECTIONS>
#! <CONNECTION
#!   NAME="AWS_UBCParking"
#!   TYPE="DATABASE"
#!   FAMILY="Microsoft SQL Server (JDBC)"
#!   USAGE="INTERNAL"
#! />
#! </CONNECTIONS>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! </GLOBAL_PARAMETERS>
#! <USER_PARAMETERS
#!   FORM="eyJwYXJhbWV0ZXJzIjpbXX0="
#! >
#! <PARAMETER_INFO>
#! </PARAMETER_INFO>
#! </USER_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="2"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="601.870053788257 229.85118973996765"
#!   BOUNDING_RECT="601.870053788257 229.85118973996765 689.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;E10D7DB4-C792-42AC-BAE8-969FA63F198D&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsWestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="3"
#!   TYPE="Creator"
#!   VERSION="6"
#!   POSITION="-926.11538325909567 -2101.6109283899855"
#!   BOUNDING_RECT="-926.11538325909567 -2101.6109283899855 430 71"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="CREATED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATEND" PARM_VALUE="no"/>
#!     <XFORM_PARM PARM_NAME="COORDS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="CRE_ATTR" PARM_VALUE="_creation_instance"/>
#!     <XFORM_PARM PARM_NAME="GEOM" PARM_VALUE="&lt;lt&gt;?xml&lt;space&gt;version=&lt;quote&gt;1.0&lt;quote&gt;&lt;space&gt;encoding=&lt;quote&gt;US_ASCII&lt;quote&gt;&lt;space&gt;standalone=&lt;quote&gt;no&lt;quote&gt;&lt;space&gt;?&lt;gt&gt;&lt;lt&gt;geometry&lt;space&gt;dimension=&lt;quote&gt;2&lt;quote&gt;&lt;gt&gt;&lt;lt&gt;null&lt;solidus&gt;&lt;gt&gt;&lt;lt&gt;&lt;solidus&gt;geometry&lt;gt&gt;"/>
#!     <XFORM_PARM PARM_NAME="GEOMTYPE" PARM_VALUE="Geometry Object"/>
#!     <XFORM_PARM PARM_NAME="NUM" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="OAN_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Creator"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="5"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="2171.3105239838665 229.85118973996765"
#!   BOUNDING_RECT="2171.3105239838665 229.85118973996765 823.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;WestParkade_Occupancy&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;day_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayWestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="7"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3156.0785291677871 111.10000222809242"
#!   BOUNDING_RECT="3156.0785291677871 111.10000222809242 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;import&lt;space&gt;pytz&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;UTC&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time_utc&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;tz=pytz.utc&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;GMT-7&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;date_time_utc.astimezone&lt;openparen&gt;pytz.timezone&lt;openparen&gt;&lt;apos&gt;Etc&lt;solidus&gt;GMT+7&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="9"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1521.6464059323903 113.59762720434219"
#!   BOUNDING_RECT="1521.6464059323903 113.59762720434219 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="date day_unixtimestamp"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y%m%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;day_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="12"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3741.6611225761376 111.10000222809242"
#!   BOUNDING_RECT="3741.6611225761376 111.10000222809242 457.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="Date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time date"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self_capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.today&lt;space&gt;=&lt;space&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerDay"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4439.7882220941792 111.10000222809242"
#!   BOUNDING_RECT="4439.7882220941792 111.10000222809242 515.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;E10D7DB4-C792-42AC-BAE8-969FA63F198D&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.accumulated_data&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_WestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="16"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5184.9411453588273 226.99004198447616"
#!   BOUNDING_RECT="5184.9411453588273 226.99004198447616 648.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.date&lt;space&gt;=&lt;space&gt;source.date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_WestParkade"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="18"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="2171.3105239838665 -416.6703198758583"
#!   BOUNDING_RECT="2171.3105239838665 -416.6703198758583 817.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;UnivWstBlvdParkade_Occupancy&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;day_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayUnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="19"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3156.0785291677871 -593.80121206390118"
#!   BOUNDING_RECT="3156.0785291677871 -593.80121206390118 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;import&lt;space&gt;pytz&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;UTC&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time_utc&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;tz=pytz.utc&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;GMT-7&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;date_time_utc.astimezone&lt;openparen&gt;pytz.timezone&lt;openparen&gt;&lt;apos&gt;Etc&lt;solidus&gt;GMT+7&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="20"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1521.6464059323903 -532.92388241148376"
#!   BOUNDING_RECT="1521.6464059323903 -532.92388241148376 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="date day_unixtimestamp"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y%m%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;day_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="21"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3741.6611225761376 -535.42150738773353"
#!   BOUNDING_RECT="3741.6611225761376 -535.42150738773353 457.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="Date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time date"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self_capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.today&lt;space&gt;=&lt;space&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerDay_2"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="22"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4439.7882220941792 -535.42150738773353"
#!   BOUNDING_RECT="4439.7882220941792 -535.42150738773353 509.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;1B3D7D69-A1D0-4B8B-B86A-D31F8CFF2B2E&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.accumulated_data&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_UnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="23"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5184.9411453588273 -402.36096625600641"
#!   BOUNDING_RECT="5184.9411453588273 -402.36096625600641 642.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.date&lt;space&gt;=&lt;space&gt;source.date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_UnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="29"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="708.14167575824126 -457.92579507628483"
#!   BOUNDING_RECT="708.14167575824126 -457.92579507628483 683.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;1B3D7D69-A1D0-4B8B-B86A-D31F8CFF2B2E&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsUnivWstBlvd"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="32"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="2210.8071577226647 -1047.2492889542202"
#!   BOUNDING_RECT="2210.8071577226647 -1047.2492889542202 815.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;ThunderbirdParkade_Occupancy&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;day_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayThunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="33"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3195.5751629065853 -1224.3801811422632"
#!   BOUNDING_RECT="3195.5751629065853 -1224.3801811422632 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;import&lt;space&gt;pytz&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;UTC&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time_utc&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;tz=pytz.utc&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;GMT-7&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;date_time_utc.astimezone&lt;openparen&gt;pytz.timezone&lt;openparen&gt;&lt;apos&gt;Etc&lt;solidus&gt;GMT+7&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_3"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="34"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1561.1430396711892 -1163.5028514898456"
#!   BOUNDING_RECT="1561.1430396711892 -1163.5028514898456 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="date day_unixtimestamp"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y%m%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;day_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_3"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="35"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3781.1577563149376 -1166.0004764660955"
#!   BOUNDING_RECT="3781.1577563149376 -1166.0004764660955 457.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="Date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time date"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self_capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.today&lt;space&gt;=&lt;space&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerDay_3"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="36"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4479.2848558329806 -1166.0004764660955"
#!   BOUNDING_RECT="4479.2848558329806 -1166.0004764660955 507.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;7A5B3916-AD6C-445E-A6C5-BC582EB20530&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.accumulated_data&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_Thunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="37"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5224.4377790976287 -1032.9399353343683"
#!   BOUNDING_RECT="5224.4377790976287 -1032.9399353343683 640.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.date&lt;space&gt;=&lt;space&gt;source.date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_Thunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="38"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="747.63830949703981 -1088.5047641546469"
#!   BOUNDING_RECT="747.63830949703981 -1088.5047641546469 681.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;7A5B3916-AD6C-445E-A6C5-BC582EB20530&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsThunderbird"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="45"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="2276.5134986488601 -1681.3528819631651"
#!   BOUNDING_RECT="2276.5134986488601 -1681.3528819631651 808.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;RoseGardenParkade_Occupancy&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;day_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayRoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="46"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3261.2815038327808 -1858.4837741512081"
#!   BOUNDING_RECT="3261.2815038327808 -1858.4837741512081 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;import&lt;space&gt;pytz&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;UTC&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time_utc&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;tz=pytz.utc&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;GMT-7&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;date_time_utc.astimezone&lt;openparen&gt;pytz.timezone&lt;openparen&gt;&lt;apos&gt;Etc&lt;solidus&gt;GMT+7&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_4"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="47"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1676.1919792865297 -1786.6414225678693"
#!   BOUNDING_RECT="1676.1919792865297 -1786.6414225678693 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="date day_unixtimestamp"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y%m%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;day_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_4"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="48"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3846.8640972411331 -1800.1040694750404"
#!   BOUNDING_RECT="3846.8640972411331 -1800.1040694750404 457.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="Date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time date"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self_capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.today&lt;space&gt;=&lt;space&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerDay_4"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="49"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4544.9911967591779 -1800.1040694750404"
#!   BOUNDING_RECT="4544.9911967591779 -1800.1040694750404 500.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;33B31206-E1F8-44CE-87A5-318C6D198417&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.accumulated_data&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_RoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="50"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5290.144120023826 -1667.0435283433133"
#!   BOUNDING_RECT="5290.144120023826 -1667.0435283433133 633.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.date&lt;space&gt;=&lt;space&gt;source.date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_RoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="51"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="813.34465042323541 -1722.6083571635918"
#!   BOUNDING_RECT="813.34465042323541 -1722.6083571635918 674.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;33B31206-E1F8-44CE-87A5-318C6D198416&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsRoseGarden"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="58"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="2323.8729570838959 -2383.1179029651207"
#!   BOUNDING_RECT="2323.8729570838959 -2383.1179029651207 699.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;NorthParkade_Occupancy&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;day_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayNorth"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="59"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3308.6409622678166 -2560.2487951531634"
#!   BOUNDING_RECT="3308.6409622678166 -2560.2487951531634 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;import&lt;space&gt;pytz&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;UTC&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time_utc&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;tz=pytz.utc&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;GMT-7&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;date_time_utc.astimezone&lt;openparen&gt;pytz.timezone&lt;openparen&gt;&lt;apos&gt;Etc&lt;solidus&gt;GMT+7&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_5"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="60"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1723.5514377215654 -2488.4064435698251"
#!   BOUNDING_RECT="1723.5514377215654 -2488.4064435698251 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="date day_unixtimestamp"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y%m%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;day_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_5"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="61"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3929.3801572421844 -2383.1179029651207"
#!   BOUNDING_RECT="3929.3801572421844 -2383.1179029651207 457.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="Date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time date"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self_capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.today&lt;space&gt;=&lt;space&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerDay_5"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="62"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4592.3506551942137 -2501.869090476996"
#!   BOUNDING_RECT="4592.3506551942137 -2501.869090476996 454 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;ACF9CF85-6991-42B9-9467-6094008D1094&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.accumulated_data&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_North"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="63"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5337.5035784588617 -2368.8085493452686"
#!   BOUNDING_RECT="5337.5035784588617 -2368.8085493452686 524.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.date&lt;space&gt;=&lt;space&gt;source.date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_North"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="64"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="860.70410885827118 -2424.3733781655474"
#!   BOUNDING_RECT="860.70410885827118 -2424.3733781655474 565.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;ACF9CF85-6991-42B9-9467-6094008D1094&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsNorth"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="71"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="2355.1232695870217 -3016.5226892373571"
#!   BOUNDING_RECT="2355.1232695870217 -3016.5226892373571 861.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;HealthSciencesParkade_Occupancy&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;day_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayHealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="72"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3308.6409622678166 -3256.5226892373571"
#!   BOUNDING_RECT="3308.6409622678166 -3256.5226892373571 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;import&lt;space&gt;pytz&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;UTC&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time_utc&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;tz=pytz.utc&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;GMT-7&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;date_time_utc.astimezone&lt;openparen&gt;pytz.timezone&lt;openparen&gt;&lt;apos&gt;Etc&lt;solidus&gt;GMT+7&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_6"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="73"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1723.5514377215654 -3184.6803376540188"
#!   BOUNDING_RECT="1723.5514377215654 -3184.6803376540188 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="date day_unixtimestamp"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y%m%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;day_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_6"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="74"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3929.3801572421844 -3198.1429845611897"
#!   BOUNDING_RECT="3929.3801572421844 -3198.1429845611897 457.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="Date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time date"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self_capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.today&lt;space&gt;=&lt;space&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerDay_6"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="75"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4592.3506551942137 -3198.1429845611897"
#!   BOUNDING_RECT="4592.3506551942137 -3198.1429845611897 553.00106825772946 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;859835AD-E855-4DBF-83ED-419DEF40537C&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.accumulated_data&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_HealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="76"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5337.5035784588617 -3065.0824434294623"
#!   BOUNDING_RECT="5337.5035784588617 -3065.0824434294623 686.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.date&lt;space&gt;=&lt;space&gt;source.date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_HealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="77"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="860.70410885827118 -3120.647272249741"
#!   BOUNDING_RECT="860.70410885827118 -3120.647272249741 727.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;859835AD-E855-4DBF-83ED-419DEF40537C&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsHealthSciences"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="84"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="2323.8729570838959 -3731.8144764920607"
#!   BOUNDING_RECT="2323.8729570838959 -3731.8144764920607 704.00106825772946 71"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="zone_id" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimezoneId" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Violations" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="ViolationsEnforced" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUTC" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="Timestamp" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="TimestampUnix" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="varchar(255),varchar(50),int32,int32,int32,int32,varchar(255),varchar(255),int64"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="zone_id,TimezoneId,Capacity,Vehicles,Violations,ViolationsEnforced,TimestampUTC,Timestamp,TimestampUnix"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="nvarchar(255),nvarchar(50),integer,integer,integer,integer,nvarchar(255),nvarchar(255),bigint"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="60"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;DISTINCT&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;FraserParkade_Occupancy&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;TimestampUnix&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;day_unixtimestamp&lt;closeparen&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetAllDataFromLatestDayFraser"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="85"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3308.6409622678166 -3908.9453686801035"
#!   BOUNDING_RECT="3308.6409622678166 -3908.9453686801035 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Vehicles" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="Date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="hour_minute" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Timestamp TimestampUnix TimestampUTC TimezoneId Violations ViolationsEnforced zone_id"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles Capacity"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;import&lt;space&gt;pytz&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;UTC&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time_utc&lt;space&gt;=&lt;space&gt;datetime.datetime.fromtimestamp&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;TimestampUnix&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;tz=pytz.utc&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;datetime&lt;space&gt;in&lt;space&gt;GMT-7&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;date_time_utc.astimezone&lt;openparen&gt;pytz.timezone&lt;openparen&gt;&lt;apos&gt;Etc&lt;solidus&gt;GMT+7&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;string&lt;space&gt;in&lt;space&gt;yyyy-mm-dd&lt;space&gt;format&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatted_date&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%Y-%m-%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;hour&lt;space&gt;and&lt;space&gt;minute&lt;space&gt;from&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;hour_minute&lt;space&gt;=&lt;space&gt;date_time.strftime&lt;openparen&gt;&lt;apos&gt;%H:%M&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;formatted_date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;comma&gt;&lt;space&gt;hour_minute&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.data.append&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AddDayHour_7"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="86"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="1723.5514377215654 -3837.1030170967651"
#!   BOUNDING_RECT="1723.5514377215654 -3837.1030170967651 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="false"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="day_unixtimestamp" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="date day_unixtimestamp"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;date&lt;space&gt;string&lt;space&gt;to&lt;space&gt;a&lt;space&gt;datetime&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_time&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;%Y%m%d&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;the&lt;space&gt;datetime&lt;space&gt;object&lt;space&gt;to&lt;space&gt;a&lt;space&gt;UNIX&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;date_time.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;print&lt;openparen&gt;f&lt;quote&gt;Date:&lt;space&gt;&lt;opencurly&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;closecurly&gt;&lt;space&gt;-&lt;gt&gt;&lt;space&gt;UNIX&lt;space&gt;Timestamp:&lt;space&gt;&lt;opencurly&gt;unix_timestamp&lt;closecurly&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;&lt;apos&gt;day_unixtimestamp&lt;apos&gt;&lt;comma&gt;&lt;space&gt;unix_timestamp&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Dictionary&lt;space&gt;to&lt;space&gt;store&lt;space&gt;timestamps&lt;space&gt;and&lt;space&gt;their&lt;space&gt;corresponding&lt;space&gt;indices&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ConvertDayToUnix_7"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="87"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="3898.1298447390591 -3850.565664003936"
#!   BOUNDING_RECT="3898.1298447390591 -3850.565664003936 457.00106825772946 71"
#!   ORDER="500000000000006"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="Capacity" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="average_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="peak_occupancy_time" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="Date"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="Date hour_minute Vehicles"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="Capacity average_occupancy peak_occupancy peak_occupancy_time date"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;time_str&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Parse&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;space&gt;strings&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;date_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;time_obj&lt;space&gt;=&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;time_str&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%H:%M&lt;quote&gt;&lt;closeparen&gt;.time&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Combine&lt;space&gt;date&lt;space&gt;and&lt;space&gt;time&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;datetime_combined&lt;space&gt;=&lt;space&gt;datetime.datetime.combine&lt;openparen&gt;date_obj&lt;comma&gt;&lt;space&gt;time_obj&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Convert&lt;space&gt;to&lt;space&gt;Unix&lt;space&gt;timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;unix_timestamp&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;datetime_combined.timestamp&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;unix_timestamp&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;ValueError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;None&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self_capacity&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.today&lt;space&gt;=&lt;space&gt;datetime.date.today&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.norm_occ&lt;space&gt;+=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.n&lt;space&gt;+=&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.peak_occupancy&lt;space&gt;&lt;lt&gt;&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Vehicles&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;hour_minute&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;for&lt;space&gt;each&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;PythonCaller.&lt;space&gt;If&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;input&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;not&lt;space&gt;required&lt;space&gt;for&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;comma&gt;&lt;space&gt;then&lt;space&gt;the&lt;space&gt;processed&lt;space&gt;Feature&lt;space&gt;can&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;from&lt;space&gt;this&lt;space&gt;method&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;the&lt;space&gt;input&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;should&lt;space&gt;be&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;cached&lt;space&gt;to&lt;space&gt;a&lt;space&gt;list&lt;space&gt;class&lt;space&gt;member&lt;space&gt;and&lt;space&gt;processed&lt;space&gt;in&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;when&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;by&lt;apos&gt;&lt;space&gt;attributes&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;or&lt;space&gt;the&lt;space&gt;close&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;fmeobjects.FMEFeature&lt;space&gt;feature:&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;entering&lt;space&gt;the&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;transformer.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;datetime.datetime.strptime&lt;openparen&gt;self.date&lt;comma&gt;&lt;space&gt;&lt;quote&gt;%Y-%m-%d&lt;quote&gt;&lt;closeparen&gt;.date&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;!=&lt;space&gt;self.today:&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.average_occupancy&lt;space&gt;=&lt;space&gt;self.norm_occ&lt;space&gt;&lt;solidus&gt;&lt;space&gt;self.n&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;int&lt;openparen&gt;self.average_occupancy&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.peak_occupancy&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;comma&gt;&lt;space&gt;datetime_to_unixtimestamp&lt;openparen&gt;str&lt;openparen&gt;self.date&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;str&lt;openparen&gt;self.peak_occupancy_time&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.date&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.peak_occupancy&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CalculateStatsPerDay_7"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="88"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="4592.3506551942137 -3850.565664003936"
#!   BOUNDING_RECT="4592.3506551942137 -3850.565664003936 430 71"
#!   ORDER="500000000000007"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="NO"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE="average_occupancy Capacity date peak_occupancy peak_occupancy_time"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE="accumulated_data"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;datetime&lt;lf&gt;import&lt;space&gt;time&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Template&lt;space&gt;Class&lt;space&gt;Interface:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;When&lt;space&gt;using&lt;space&gt;this&lt;space&gt;class&lt;comma&gt;&lt;space&gt;make&lt;space&gt;sure&lt;space&gt;its&lt;space&gt;name&lt;space&gt;is&lt;space&gt;set&lt;space&gt;as&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;&lt;apos&gt;Class&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;to&lt;space&gt;Process&lt;space&gt;Features&lt;apos&gt;&lt;space&gt;transformer&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;constructor&lt;space&gt;for&lt;space&gt;class&lt;space&gt;members.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;self.counter&lt;space&gt;+&lt;space&gt;1&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;the&lt;space&gt;required&lt;space&gt;attributes&lt;space&gt;from&lt;space&gt;the&lt;space&gt;feature&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;average_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;capacity&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;Capacity&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;date&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;peak_occupancy_time&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;3B3F3EC1-5D84-4C80-9CAD-2CCC9A9268A4&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Concatenate&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;into&lt;space&gt;a&lt;space&gt;single&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature_string&lt;space&gt;=&lt;space&gt;f&lt;quote&gt;&lt;apos&gt;&lt;opencurly&gt;date&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;opencurly&gt;zone_id&lt;closecurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;opencurly&gt;average_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;peak_occupancy_time&lt;closecurly&gt;&lt;comma&gt;&lt;opencurly&gt;capacity&lt;closecurly&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Append&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;string&lt;space&gt;to&lt;space&gt;the&lt;space&gt;accumulated&lt;space&gt;string&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;self.accumulated_data:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;+=&lt;space&gt;f&lt;quote&gt;&lt;opencurly&gt;feature_string&lt;closecurly&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.counter&lt;space&gt;==&lt;space&gt;999&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;&lt;quote&gt;&lt;openparen&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.counter&lt;space&gt;=&lt;space&gt;0&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;openparen&gt;self.accumulated_data&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;have&lt;space&gt;been&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;from&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.accumulated_data&lt;space&gt;=&lt;space&gt;self.accumulated_data&lt;openbracket&gt;:-3&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;output&lt;space&gt;feature&lt;space&gt;with&lt;space&gt;accumulated&lt;space&gt;data&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;out_feature.setAttribute&lt;openparen&gt;&lt;apos&gt;accumulated_data&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.accumulated_data.strip&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Remove&lt;space&gt;trailing&lt;space&gt;space&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;out_feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;When&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;are&lt;space&gt;specified&lt;comma&gt;&lt;space&gt;this&lt;space&gt;method&lt;space&gt;is&lt;space&gt;called&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;once&lt;space&gt;all&lt;space&gt;the&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;in&lt;space&gt;a&lt;space&gt;current&lt;space&gt;group&lt;space&gt;have&lt;space&gt;been&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;Features&lt;space&gt;sent&lt;space&gt;to&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;should&lt;space&gt;generally&lt;space&gt;be&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;group-by&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;processing&lt;space&gt;in&lt;space&gt;this&lt;space&gt;method&lt;space&gt;when&lt;space&gt;knowledge&lt;space&gt;of&lt;space&gt;all&lt;space&gt;Features&lt;space&gt;is&lt;space&gt;required.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;resulting&lt;space&gt;Feature&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;from&lt;space&gt;the&lt;space&gt;group-by&lt;space&gt;processing&lt;space&gt;should&lt;space&gt;be&lt;space&gt;emitted&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;through&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;.&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;continue&lt;space&gt;calling&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;a&lt;space&gt;number&lt;space&gt;of&lt;space&gt;times&lt;space&gt;followed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;by&lt;space&gt;process_group&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;each&lt;space&gt;&lt;apos&gt;Group&lt;space&gt;By&lt;apos&gt;&lt;space&gt;attribute&lt;comma&gt;&lt;space&gt;so&lt;space&gt;this&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;implementation&lt;space&gt;should&lt;space&gt;reset&lt;space&gt;any&lt;space&gt;class&lt;space&gt;members&lt;space&gt;for&lt;space&gt;the&lt;space&gt;next&lt;space&gt;group.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;has_support_for&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;support_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;This&lt;space&gt;method&lt;space&gt;returns&lt;space&gt;whether&lt;space&gt;this&lt;space&gt;PythonCaller&lt;space&gt;supports&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;type.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;The&lt;space&gt;only&lt;space&gt;supported&lt;space&gt;type&lt;space&gt;is&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:param&lt;space&gt;int&lt;space&gt;support_type:&lt;space&gt;The&lt;space&gt;support&lt;space&gt;type&lt;space&gt;being&lt;space&gt;queried.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:returns:&lt;space&gt;True&lt;space&gt;if&lt;space&gt;the&lt;space&gt;passed&lt;space&gt;in&lt;space&gt;support&lt;space&gt;type&lt;space&gt;is&lt;space&gt;supported.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;:rtype:&lt;space&gt;bool&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;support_type&lt;space&gt;==&lt;space&gt;fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;this&lt;space&gt;is&lt;space&gt;set&lt;space&gt;to&lt;space&gt;return&lt;space&gt;True&lt;comma&gt;&lt;space&gt;FME&lt;space&gt;will&lt;space&gt;pass&lt;space&gt;features&lt;space&gt;to&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;come&lt;space&gt;from&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;table&lt;space&gt;object.&lt;space&gt;This&lt;space&gt;allows&lt;space&gt;for&lt;space&gt;significant&lt;space&gt;performance&lt;space&gt;gains&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;when&lt;space&gt;processing&lt;space&gt;large&lt;space&gt;numbers&lt;space&gt;of&lt;space&gt;features.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;To&lt;space&gt;enable&lt;space&gt;this&lt;comma&gt;&lt;space&gt;the&lt;space&gt;following&lt;space&gt;conditions&lt;space&gt;must&lt;space&gt;be&lt;space&gt;met:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;1&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;passed&lt;space&gt;into&lt;space&gt;the&lt;space&gt;input&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;method&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;copied&lt;space&gt;or&lt;space&gt;cached&lt;space&gt;for&lt;space&gt;later&lt;space&gt;use&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;2&lt;closeparen&gt;&lt;space&gt;features&lt;space&gt;cannot&lt;space&gt;be&lt;space&gt;read&lt;space&gt;or&lt;space&gt;modified&lt;space&gt;after&lt;space&gt;being&lt;space&gt;passed&lt;space&gt;to&lt;space&gt;self.pyoutput&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;3&lt;closeparen&gt;&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;must&lt;space&gt;not&lt;space&gt;be&lt;space&gt;enabled&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Violations&lt;space&gt;will&lt;space&gt;cause&lt;space&gt;undefined&lt;space&gt;behavior.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;False&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="CreateSQL_Fraser"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="89"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="5337.5035784588617 -3717.5051228722086"
#!   BOUNDING_RECT="5337.5035784588617 -3717.5051228722086 529.00106825772946 71"
#!   ORDER="500000000000046"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="accumulated_data" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="&lt;semicolon&gt;WITH&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;SELECT&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;ROW_NUMBER&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;OVER&lt;space&gt;&lt;openparen&gt;PARTITION&lt;space&gt;BY&lt;space&gt;date&lt;comma&gt;&lt;space&gt;zone_id&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;peak_occupancy&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;row_num&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;FROM&lt;space&gt;&lt;openparen&gt;VALUES&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;at&gt;Value&lt;openparen&gt;accumulated_data&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;source&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;closeparen&gt;&lt;space&gt;AS&lt;space&gt;ranked&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;WHERE&lt;space&gt;row_num&lt;space&gt;=&lt;space&gt;1&lt;lf&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;MERGE&lt;space&gt;INTO&lt;space&gt;&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;space&gt;AS&lt;space&gt;target&lt;lf&gt;USING&lt;space&gt;UniqueSource&lt;space&gt;AS&lt;space&gt;source&lt;lf&gt;ON&lt;space&gt;&lt;openparen&gt;target.date&lt;space&gt;=&lt;space&gt;source.date&lt;space&gt;AND&lt;space&gt;target.zone_id&lt;space&gt;=&lt;space&gt;source.zone_id&lt;closeparen&gt;&lt;lf&gt;WHEN&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;UPDATE&lt;space&gt;SET&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.average_occupancy&lt;space&gt;=&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy&lt;space&gt;=&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;target.peak_occupancy_time&lt;space&gt;=&lt;space&gt;source.peak_occupancy_time&lt;lf&gt;WHEN&lt;space&gt;NOT&lt;space&gt;MATCHED&lt;space&gt;THEN&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;INSERT&lt;space&gt;&lt;openparen&gt;&lt;space&gt;date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;Capacity&lt;space&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;VALUES&lt;space&gt;&lt;openparen&gt;&lt;space&gt;source.date&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.zone_id&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.average_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.peak_occupancy_time&lt;comma&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;source.Capacity&lt;closeparen&gt;&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="WriteNewStats_Fraser"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="90"
#!   TYPE="SQLExecutor"
#!   VERSION="9"
#!   POSITION="860.70410885827118 -3773.0699516924874"
#!   BOUNDING_RECT="860.70410885827118 -3773.0699516924874 570.00106825772946 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22765"
#! >
#!     <OUTPUT_FEAT NAME="&lt;SCHEMA&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="fme_feature_type_name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.name" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.fme_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="attribute{}.native_data_type" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="fme_basename" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="RESULT"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <OUTPUT_FEAT NAME="INITIATOR"/>
#!     <FEAT_COLLAPSED COLLAPSED="2"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <XFORM_ATTR ATTR_NAME="_matched_records" IS_USER_CREATED="false" FEAT_INDEX="2" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="3"/>
#!     <XFORM_ATTR ATTR_NAME="_creation_instance" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="_reader_error" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_ATTR ATTR_NAME="date" IS_USER_CREATED="false" FEAT_INDEX="3" />
#!     <XFORM_PARM PARM_NAME="ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="ATTR_IGNORE_NULLS" PARM_VALUE="&lt;Unused&gt;"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_ATTRS" PARM_VALUE="Result Attributes Only"/>
#!     <XFORM_PARM PARM_NAME="COMBINE_GEOM" PARM_VALUE="Initiator Geometry Only"/>
#!     <XFORM_PARM PARM_NAME="COORDSYS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DATASET" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="DB_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="DYNGROUP_0" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="EXPOSED_ATTRIBUTE_LIST" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FEATURETYPES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="FORMAT" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_ATTRIBUTE_TYPES" PARM_VALUE="date"/>
#!     <XFORM_PARM PARM_NAME="FORMAT_PARAMS" PARM_VALUE="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Connection:,MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA,&quot;IGNORE TEXT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;,MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT,&quot;OPTIONAL INT&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Query&lt;space&gt;Timeout&lt;space&gt;&lt;openparen&gt;Seconds&lt;closeparen&gt;:,MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT,&quot;OPTIONAL CHOICE ReadWrite%ReadOnly&quot;,MSSQL_JDBC_NONSPATIAL_2&lt;space&gt;Application&lt;space&gt;Intent"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_APPLICATION_INTENT" PARM_VALUE="ReadWrite"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_CREATE_FEATURE_TABLES_FROM_DATA" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_NAMED_CONNECTION" PARM_VALUE="AWS_UBCParking"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="MSSQL_JDBC_NONSPATIAL_2_QUERY_TIMEOUT" PARM_VALUE="30"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_DISPLAY" PARM_VALUE="Schema and Data Features"/>
#!     <XFORM_PARM PARM_NAME="OUTPUT_FEATURES_GROUP" PARM_VALUE="FME_DISCLOSURE_CLOSED"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SQL_STATEMENT" PARM_VALUE="SELECT&lt;space&gt;TOP&lt;space&gt;1&lt;space&gt;*&lt;lf&gt;FROM&lt;space&gt;&lt;openbracket&gt;Parking&lt;closebracket&gt;.&lt;openbracket&gt;dbo&lt;closebracket&gt;.&lt;openbracket&gt;Daily_Occupancy_Stats&lt;closebracket&gt;&lt;lf&gt;WHERE&lt;space&gt;zone_id&lt;space&gt;=&lt;space&gt;&lt;apos&gt;3B3F3EC1-5D84-4C80-9CAD-2CCC9A9268A4&lt;apos&gt;&lt;lf&gt;ORDER&lt;space&gt;BY&lt;space&gt;date&lt;space&gt;DESC&lt;semicolon&gt;"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="GetLatestDayStatsFraser"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="4"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="2"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="30"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="29"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="1"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="97"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="38"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="2"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="98"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="51"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="3"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="99"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="64"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="4"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="100"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="77"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="5"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="101"
#!   SOURCE_NODE="3"
#!   TARGET_NODE="90"
#!   SOURCE_PORT_DESC="fo 0 CREATED"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="6"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="7"
#!   TARGET_NODE="12"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="11"
#!   SOURCE_NODE="9"
#!   TARGET_NODE="5"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="12"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="16"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="24"
#!   SOURCE_NODE="19"
#!   TARGET_NODE="21"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="25"
#!   SOURCE_NODE="20"
#!   TARGET_NODE="18"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="26"
#!   SOURCE_NODE="21"
#!   TARGET_NODE="22"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="27"
#!   SOURCE_NODE="22"
#!   TARGET_NODE="23"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="39"
#!   SOURCE_NODE="33"
#!   TARGET_NODE="35"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="40"
#!   SOURCE_NODE="34"
#!   TARGET_NODE="32"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="41"
#!   SOURCE_NODE="35"
#!   TARGET_NODE="36"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="42"
#!   SOURCE_NODE="36"
#!   TARGET_NODE="37"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="52"
#!   SOURCE_NODE="46"
#!   TARGET_NODE="48"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="53"
#!   SOURCE_NODE="47"
#!   TARGET_NODE="45"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="54"
#!   SOURCE_NODE="48"
#!   TARGET_NODE="49"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="55"
#!   SOURCE_NODE="49"
#!   TARGET_NODE="50"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="65"
#!   SOURCE_NODE="59"
#!   TARGET_NODE="61"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="66"
#!   SOURCE_NODE="60"
#!   TARGET_NODE="58"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="67"
#!   SOURCE_NODE="61"
#!   TARGET_NODE="62"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="68"
#!   SOURCE_NODE="62"
#!   TARGET_NODE="63"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="78"
#!   SOURCE_NODE="72"
#!   TARGET_NODE="74"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="79"
#!   SOURCE_NODE="73"
#!   TARGET_NODE="71"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="80"
#!   SOURCE_NODE="74"
#!   TARGET_NODE="75"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="81"
#!   SOURCE_NODE="75"
#!   TARGET_NODE="76"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="91"
#!   SOURCE_NODE="85"
#!   TARGET_NODE="87"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="92"
#!   SOURCE_NODE="86"
#!   TARGET_NODE="84"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="93"
#!   SOURCE_NODE="87"
#!   TARGET_NODE="88"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="94"
#!   SOURCE_NODE="88"
#!   TARGET_NODE="89"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 INITIATOR"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="10"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="9"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="8"
#!   SOURCE_NODE="5"
#!   TARGET_NODE="7"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="28"
#!   SOURCE_NODE="18"
#!   TARGET_NODE="19"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="31"
#!   SOURCE_NODE="29"
#!   TARGET_NODE="20"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="43"
#!   SOURCE_NODE="32"
#!   TARGET_NODE="33"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="44"
#!   SOURCE_NODE="38"
#!   TARGET_NODE="34"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="56"
#!   SOURCE_NODE="45"
#!   TARGET_NODE="46"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="57"
#!   SOURCE_NODE="51"
#!   TARGET_NODE="47"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="69"
#!   SOURCE_NODE="58"
#!   TARGET_NODE="59"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="70"
#!   SOURCE_NODE="64"
#!   TARGET_NODE="60"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="82"
#!   SOURCE_NODE="71"
#!   TARGET_NODE="72"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="83"
#!   SOURCE_NODE="77"
#!   TARGET_NODE="73"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="95"
#!   SOURCE_NODE="84"
#!   TARGET_NODE="85"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="96"
#!   SOURCE_NODE="90"
#!   TARGET_NODE="86"
#!   SOURCE_PORT_DESC="fo 1 RESULT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </WORKSPACE>

FME_PYTHON_VERSION 310
ARCGIS_COMPATIBILITY ARCGIS_AUTO
#! START_HEADER
#! START_WB_HEADER
READER_TYPE MULTI_READER
WRITER_TYPE NULL
WRITER_KEYWORD NULL_DEST
NULL_DEST_DATASET null
#! END_WB_HEADER
#! START_WB_HEADER
#! END_WB_HEADER
#! END_HEADER

LOG_FILENAME "$(FME_MF_DIR)parking_stats_daily.log"
LOG_APPEND NO
LOG_FILTER_MASK -1
LOG_MAX_FEATURES 200
LOG_MAX_RECORDED_FEATURES 200
FME_REPROJECTION_ENGINE FME
FME_IMPLICIT_CSMAP_REPROJECTION_MODE Auto
FME_GEOMETRY_HANDLING Enhanced
FME_STROKE_MAX_DEVIATION 0
FME_NAMES_ENCODING UTF-8
FME_BULK_MODE_THRESHOLD 2000
LAST_SAVE_BUILD "FME 2022.2.0.0 (20221103 - Build 22765 - WIN64)"
# -------------------------------------------------------------------------

MULTI_READER_CONTINUE_ON_READER_FAILURE No

# -------------------------------------------------------------------------

MACRO WORKSPACE_NAME parking_stats_daily
MACRO FME_VIEWER_APP fmedatainspector
DEFAULT_MACRO WB_CURRENT_CONTEXT
# -------------------------------------------------------------------------
Tcl2 proc Creator_CoordSysRemover {} {   global FME_CoordSys;   set FME_CoordSys {}; }
MACRO Creator_XML     NOT_ACTIVATED
MACRO Creator_CLASSIC NOT_ACTIVATED
MACRO Creator_2D3D    2D_GEOMETRY
MACRO Creator_COORDS  <Unused>
INCLUDE [ if { {Geometry Object} == {Geometry Object} } {            puts {MACRO Creator_XML *} } ]
INCLUDE [ if { {Geometry Object} == {2D Coordinate List} } {            puts {MACRO Creator_2D3D 2D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
INCLUDE [ if { {Geometry Object} == {3D Coordinate List} } {            puts {MACRO Creator_2D3D 3D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
INCLUDE [ if { {Geometry Object} == {2D Min/Max Box} } {            set comment {                We need to turn the COORDS which are                    minX minY maxX maxY                into a full polygon list of coordinates            };            set splitCoords [split [string trim {<Unused>}]];            if { [llength $splitCoords] > 4} {               set trimmedCoords {};               foreach item $splitCoords { if { $item != {} } {lappend trimmedCoords $item} };               set splitCoords $trimmedCoords;            };            if { [llength $splitCoords] != 4 } {                error {Creator: Coordinate list is expected to be a space delimited list of four numbers as 'minx miny maxx maxy' - `<Unused>' is invalid};            };            set minX [lindex $splitCoords 0];            set minY [lindex $splitCoords 1];            set maxX [lindex $splitCoords 2];            set maxY [lindex $splitCoords 3];            puts "MACRO Creator_COORDS $minX $minY $minX $maxY $maxX $maxY $maxX $minY $minX $minY";            puts {MACRO Creator_2D3D 2D_GEOMETRY};            puts {MACRO Creator_CLASSIC *} } ]
FACTORY_DEF {$(Creator_XML)} CreationFactory    FACTORY_NAME { Creator_XML_Creator }    CREATE_AT_END { no }    OUTPUT { FEATURE_TYPE _____CREATED______        @Geometry(FROM_ENCODED_STRING,<lt>?xml<space>version=<quote>1.0<quote><space>encoding=<quote>US_ASCII<quote><space>standalone=<quote>no<quote><space>?<gt><lt>geometry<space>dimension=<quote>2<quote><gt><lt>null<solidus><gt><lt><solidus>geometry<gt>) }
FACTORY_DEF {$(Creator_CLASSIC)} CreationFactory    FACTORY_NAME { Creator_CLASSIC_Creator }    $(Creator_2D3D) { $(Creator_COORDS) }    CREATE_AT_END { no }    OUTPUT { FEATURE_TYPE _____CREATED______ }
FACTORY_DEF {*} TeeFactory    FACTORY_NAME { Creator_Cloner }    INPUT FEATURE_TYPE _____CREATED______        @Tcl2(Creator_CoordSysRemover)        @CoordSys()    NUMBER_OF_COPIES { 1 }    COPY_NUMBER_ATTRIBUTE { "_creation_instance" }    OUTPUT { FEATURE_TYPE Creator_CREATED        fme_feature_type Creator         }
FACTORY_DEF * TeeFactory   FACTORY_NAME "Creator CREATED Splitter"   INPUT FEATURE_TYPE Creator_CREATED   OUTPUT FEATURE_TYPE Creator_CREATED_0_GJAgmIF9G6c=   OUTPUT FEATURE_TYPE Creator_CREATED_1_Exx7idfjvCA=   OUTPUT FEATURE_TYPE Creator_CREATED_2_goANeUpBIDA=   OUTPUT FEATURE_TYPE Creator_CREATED_3_T6a7qEGs3cw=   OUTPUT FEATURE_TYPE Creator_CREATED_4_kL0twIhQOd0=   OUTPUT FEATURE_TYPE Creator_CREATED_5_HlnuBgcITog=   OUTPUT FEATURE_TYPE Creator_CREATED_6_62VWAKFdvog=
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED_0_GJAgmIF9G6c= Brancher -1 4"   INPUT FEATURE_TYPE Creator_CREATED_0_GJAgmIF9G6c=   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED_1_Exx7idfjvCA= Brancher -1 30"   INPUT FEATURE_TYPE Creator_CREATED_1_Exx7idfjvCA=   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED_2_goANeUpBIDA= Brancher -1 97"   INPUT FEATURE_TYPE Creator_CREATED_2_goANeUpBIDA=   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED_3_T6a7qEGs3cw= Brancher -1 98"   INPUT FEATURE_TYPE Creator_CREATED_3_T6a7qEGs3cw=   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED_4_kL0twIhQOd0= Brancher -1 99"   INPUT FEATURE_TYPE Creator_CREATED_4_kL0twIhQOd0=   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED_5_HlnuBgcITog= Brancher -1 100"   INPUT FEATURE_TYPE Creator_CREATED_5_HlnuBgcITog=   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
FACTORY_DEF * BranchingFactory   FACTORY_NAME "Creator_CREATED_6_62VWAKFdvog= Brancher -1 101"   INPUT FEATURE_TYPE Creator_CREATED_6_62VWAKFdvog=   TARGET_FACTORY "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   MAXIMUM_COUNT None   OUTPUT PASSED FEATURE_TYPE *
# -------------------------------------------------------------------------
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(WB_CURRENT_CONTEXT)_CREATOR_BRANCH_TARGET"   INPUT FEATURE_TYPE *  OUTPUT FEATURE_TYPE *
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsWestParkade_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsWestParkade }    INPUT  FEATURE_TYPE Creator_CREATED_0_GJAgmIF9G6c=    QUERY_SQL            { "SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos>E10D7DB4-C792-42AC-BAE8-969FA63F198D<apos><lf>ORDER<space>BY<space>date<space>DESC<semicolon>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsWestParkade_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsWestParkade_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsWestParkade)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsWestParkade_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsWestParkade_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsWestParkade_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsWestParkade<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsWestParkade_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>date<apos><closeparen><comma><space><apos>%Y%m%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>day_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayWestParkade_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes NAMED_CONNECTION AWS_UBCParking APPLICATION_INTENT ReadWrite QUERY_TIMEOUT 60 CREATE_FEATURE_TABLES_FROM_DATA Yes
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayWestParkade }    INPUT  FEATURE_TYPE ConvertDayToUnix_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><openbracket>dbo<closebracket>.<openbracket>WestParkade_Occupancy<closebracket><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>day_unixtimestamp<closeparen>,GetAllDataFromLatestDayWestParkade)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayWestParkade_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayWestParkade_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayWestParkade)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayWestParkade_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayWestParkade_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayWestParkade_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayWestParkade<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayWestParkade_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf>import<space>pytz<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>UTC<lf><space><space><space><space><space><space><space><space>date_time_utc<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><comma><space>tz=pytz.utc<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>GMT-7<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>date_time_utc.astimezone<openparen>pytz.timezone<openparen><apos>Etc<solidus>GMT+7<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerDay }    GROUP_BY { Date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddDayHour_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self_capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.today<space>=<space>datetime.date.today<openparen><closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>date<apos><comma><space>self.date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerDay_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_WestParkade }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerDay_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>date<space>=<space>feature.getAttribute<openparen><apos>date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space><apos>E10D7DB4-C792-42AC-BAE8-969FA63F198D<apos><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self.accumulated_data<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_WestParkade_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_WestParkade_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_WestParkade }    INPUT  FEATURE_TYPE CreateSQL_WestParkade_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.date<space>=<space>source.date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon>,WriteNewStats_WestParkade)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_WestParkade_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_WestParkade_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_WestParkade_<Rejected> INPUT FEATURE_TYPE WriteNewStats_WestParkade_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_WestParkade<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsUnivWstBlvd_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsUnivWstBlvd }    INPUT  FEATURE_TYPE Creator_CREATED_1_Exx7idfjvCA=    QUERY_SQL            { "SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos>1B3D7D69-A1D0-4B8B-B86A-D31F8CFF2B2E<apos><lf>ORDER<space>BY<space>date<space>DESC<semicolon>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsUnivWstBlvd_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsUnivWstBlvd)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsUnivWstBlvd_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsUnivWstBlvd<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_2 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsUnivWstBlvd_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>date<apos><closeparen><comma><space><apos>%Y%m%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>day_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_2_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayUnivWstBlvd_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 60 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayUnivWstBlvd }    INPUT  FEATURE_TYPE ConvertDayToUnix_2_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><openbracket>dbo<closebracket>.<openbracket>UnivWstBlvdParkade_Occupancy<closebracket><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>day_unixtimestamp<closeparen>,GetAllDataFromLatestDayUnivWstBlvd)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayUnivWstBlvd_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayUnivWstBlvd)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayUnivWstBlvd_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayUnivWstBlvd<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_2 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayUnivWstBlvd_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf>import<space>pytz<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>UTC<lf><space><space><space><space><space><space><space><space>date_time_utc<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><comma><space>tz=pytz.utc<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>GMT-7<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>date_time_utc.astimezone<openparen>pytz.timezone<openparen><apos>Etc<solidus>GMT+7<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_2_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerDay_2 }    GROUP_BY { Date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddDayHour_2_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self_capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.today<space>=<space>datetime.date.today<openparen><closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>date<apos><comma><space>self.date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerDay_2_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_UnivWstBlvd }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerDay_2_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>date<space>=<space>feature.getAttribute<openparen><apos>date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space><apos>1B3D7D69-A1D0-4B8B-B86A-D31F8CFF2B2E<apos><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self.accumulated_data<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_UnivWstBlvd_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_UnivWstBlvd_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_UnivWstBlvd }    INPUT  FEATURE_TYPE CreateSQL_UnivWstBlvd_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.date<space>=<space>source.date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon>,WriteNewStats_UnivWstBlvd)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_UnivWstBlvd_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_UnivWstBlvd_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_UnivWstBlvd_<Rejected> INPUT FEATURE_TYPE WriteNewStats_UnivWstBlvd_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_UnivWstBlvd<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsThunderbird_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsThunderbird }    INPUT  FEATURE_TYPE Creator_CREATED_2_goANeUpBIDA=    QUERY_SQL            { "SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos>7A5B3916-AD6C-445E-A6C5-BC582EB20530<apos><lf>ORDER<space>BY<space>date<space>DESC<semicolon>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsThunderbird_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsThunderbird_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsThunderbird)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsThunderbird_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsThunderbird_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsThunderbird_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsThunderbird<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_3 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsThunderbird_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>date<apos><closeparen><comma><space><apos>%Y%m%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>day_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_3_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayThunderbird_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 60 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayThunderbird }    INPUT  FEATURE_TYPE ConvertDayToUnix_3_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><openbracket>dbo<closebracket>.<openbracket>ThunderbirdParkade_Occupancy<closebracket><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>day_unixtimestamp<closeparen>,GetAllDataFromLatestDayThunderbird)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayThunderbird_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayThunderbird_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayThunderbird)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayThunderbird_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayThunderbird_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayThunderbird_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayThunderbird<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_3 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayThunderbird_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf>import<space>pytz<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>UTC<lf><space><space><space><space><space><space><space><space>date_time_utc<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><comma><space>tz=pytz.utc<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>GMT-7<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>date_time_utc.astimezone<openparen>pytz.timezone<openparen><apos>Etc<solidus>GMT+7<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_3_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerDay_3 }    GROUP_BY { Date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddDayHour_3_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self_capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.today<space>=<space>datetime.date.today<openparen><closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>date<apos><comma><space>self.date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerDay_3_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_Thunderbird }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerDay_3_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>date<space>=<space>feature.getAttribute<openparen><apos>date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space><apos>7A5B3916-AD6C-445E-A6C5-BC582EB20530<apos><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self.accumulated_data<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_Thunderbird_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_Thunderbird_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_Thunderbird }    INPUT  FEATURE_TYPE CreateSQL_Thunderbird_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.date<space>=<space>source.date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon>,WriteNewStats_Thunderbird)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_Thunderbird_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_Thunderbird_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_Thunderbird_<Rejected> INPUT FEATURE_TYPE WriteNewStats_Thunderbird_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_Thunderbird<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsRoseGarden_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes NAMED_CONNECTION AWS_UBCParking APPLICATION_INTENT ReadWrite QUERY_TIMEOUT 30 CREATE_FEATURE_TABLES_FROM_DATA Yes
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsRoseGarden }    INPUT  FEATURE_TYPE Creator_CREATED_3_T6a7qEGs3cw=    QUERY_SQL            { "SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos>33B31206-E1F8-44CE-87A5-318C6D198416<apos><lf>ORDER<space>BY<space>date<space>DESC<semicolon>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsRoseGarden_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsRoseGarden_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsRoseGarden)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsRoseGarden_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsRoseGarden_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsRoseGarden_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsRoseGarden<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_4 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsRoseGarden_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>date<apos><closeparen><comma><space><apos>%Y%m%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>day_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_4_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayRoseGarden_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 60 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayRoseGarden }    INPUT  FEATURE_TYPE ConvertDayToUnix_4_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><openbracket>dbo<closebracket>.<openbracket>RoseGardenParkade_Occupancy<closebracket><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>day_unixtimestamp<closeparen>,GetAllDataFromLatestDayRoseGarden)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayRoseGarden_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayRoseGarden)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayRoseGarden_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayRoseGarden<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_4 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayRoseGarden_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf>import<space>pytz<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>UTC<lf><space><space><space><space><space><space><space><space>date_time_utc<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><comma><space>tz=pytz.utc<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>GMT-7<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>date_time_utc.astimezone<openparen>pytz.timezone<openparen><apos>Etc<solidus>GMT+7<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_4_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerDay_4 }    GROUP_BY { Date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddDayHour_4_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self_capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.today<space>=<space>datetime.date.today<openparen><closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>date<apos><comma><space>self.date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerDay_4_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_RoseGarden }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerDay_4_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>date<space>=<space>feature.getAttribute<openparen><apos>date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space><apos>33B31206-E1F8-44CE-87A5-318C6D198417<apos><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self.accumulated_data<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_RoseGarden_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_RoseGarden_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_RoseGarden }    INPUT  FEATURE_TYPE CreateSQL_RoseGarden_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.date<space>=<space>source.date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon>,WriteNewStats_RoseGarden)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_RoseGarden_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_RoseGarden_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_RoseGarden_<Rejected> INPUT FEATURE_TYPE WriteNewStats_RoseGarden_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_RoseGarden<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsNorth_DIRECTIVES QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes NAMED_CONNECTION AWS_UBCParking APPLICATION_INTENT ReadWrite QUERY_TIMEOUT 30 CREATE_FEATURE_TABLES_FROM_DATA Yes
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsNorth }    INPUT  FEATURE_TYPE Creator_CREATED_4_kL0twIhQOd0=    QUERY_SQL            { "SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos>ACF9CF85-6991-42B9-9467-6094008D1094<apos><lf>ORDER<space>BY<space>date<space>DESC<semicolon>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsNorth_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsNorth_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsNorth)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsNorth_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsNorth_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsNorth_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsNorth<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_5 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsNorth_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>date<apos><closeparen><comma><space><apos>%Y%m%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>day_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_5_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayNorth_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 60 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayNorth }    INPUT  FEATURE_TYPE ConvertDayToUnix_5_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><openbracket>dbo<closebracket>.<openbracket>NorthParkade_Occupancy<closebracket><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>day_unixtimestamp<closeparen>,GetAllDataFromLatestDayNorth)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayNorth_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayNorth_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayNorth)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayNorth_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayNorth_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayNorth_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayNorth<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_5 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayNorth_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf>import<space>pytz<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>UTC<lf><space><space><space><space><space><space><space><space>date_time_utc<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><comma><space>tz=pytz.utc<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>GMT-7<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>date_time_utc.astimezone<openparen>pytz.timezone<openparen><apos>Etc<solidus>GMT+7<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_5_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerDay_5 }    GROUP_BY { Date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddDayHour_5_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self_capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.today<space>=<space>datetime.date.today<openparen><closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>date<apos><comma><space>self.date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerDay_5_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_North }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerDay_5_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>date<space>=<space>feature.getAttribute<openparen><apos>date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space><apos>ACF9CF85-6991-42B9-9467-6094008D1094<apos><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self.accumulated_data<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_North_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_North_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_North }    INPUT  FEATURE_TYPE CreateSQL_North_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.date<space>=<space>source.date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon>,WriteNewStats_North)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_North_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_North_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_North_<Rejected> INPUT FEATURE_TYPE WriteNewStats_North_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_North<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsHealthSciences_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsHealthSciences }    INPUT  FEATURE_TYPE Creator_CREATED_5_HlnuBgcITog=    QUERY_SQL            { "SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos>859835AD-E855-4DBF-83ED-419DEF40537C<apos><lf>ORDER<space>BY<space>date<space>DESC<semicolon>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsHealthSciences_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsHealthSciences_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsHealthSciences)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsHealthSciences_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsHealthSciences_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsHealthSciences_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsHealthSciences<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_6 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsHealthSciences_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>date<apos><closeparen><comma><space><apos>%Y%m%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>day_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_6_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayHealthSciences_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 60 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayHealthSciences }    INPUT  FEATURE_TYPE ConvertDayToUnix_6_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><openbracket>dbo<closebracket>.<openbracket>HealthSciencesParkade_Occupancy<closebracket><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>day_unixtimestamp<closeparen>,GetAllDataFromLatestDayHealthSciences)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayHealthSciences_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayHealthSciences)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayHealthSciences_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayHealthSciences<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_6 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayHealthSciences_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf>import<space>pytz<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>UTC<lf><space><space><space><space><space><space><space><space>date_time_utc<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><comma><space>tz=pytz.utc<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>GMT-7<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>date_time_utc.astimezone<openparen>pytz.timezone<openparen><apos>Etc<solidus>GMT+7<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_6_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerDay_6 }    GROUP_BY { Date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddDayHour_6_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self_capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.today<space>=<space>datetime.date.today<openparen><closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>date<apos><comma><space>self.date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerDay_6_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_HealthSciences }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerDay_6_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>date<space>=<space>feature.getAttribute<openparen><apos>date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space><apos>859835AD-E855-4DBF-83ED-419DEF40537C<apos><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self.accumulated_data<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_HealthSciences_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_HealthSciences_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_HealthSciences }    INPUT  FEATURE_TYPE CreateSQL_HealthSciences_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.date<space>=<space>source.date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon>,WriteNewStats_HealthSciences)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_HealthSciences_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_HealthSciences_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_HealthSciences_<Rejected> INPUT FEATURE_TYPE WriteNewStats_HealthSciences_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_HealthSciences<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
MACRO GetLatestDayStatsFraser_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetLatestDayStatsFraser }    INPUT  FEATURE_TYPE Creator_CREATED_6_62VWAKFdvog=    QUERY_SQL            { "SELECT<space>TOP<space>1<space>*<lf>FROM<space><openbracket>Parking<closebracket>.<openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><lf>WHERE<space>zone_id<space>=<space><apos>3B3F3EC1-5D84-4C80-9CAD-2CCC9A9268A4<apos><lf>ORDER<space>BY<space>date<space>DESC<semicolon>" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetLatestDayStatsFraser_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetLatestDayStatsFraser_RESULT        @SupplyAttributes(fme_feature_type,GetLatestDayStatsFraser)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetLatestDayStatsFraser_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetLatestDayStatsFraser_<Rejected> INPUT FEATURE_TYPE GetLatestDayStatsFraser_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetLatestDayStatsFraser<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { ConvertDayToUnix_7 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetLatestDayStatsFraser_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>date<space>string<space>to<space>a<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>datetime.datetime.strptime<openparen>feature.getAttribute<openparen><apos>date<apos><closeparen><comma><space><apos>%Y%m%d<apos><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>the<space>datetime<space>object<space>to<space>a<space>UNIX<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>date_time.timestamp<openparen><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>print<openparen>f<quote>Date:<space><opencurly>feature.getAttribute<openparen><apos>date<apos><closeparen><closecurly><space>-<gt><space>UNIX<space>Timestamp:<space><opencurly>unix_timestamp<closecurly><quote><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>day_unixtimestamp<apos><comma><space>unix_timestamp<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Dictionary<space>to<space>store<space>timestamps<space>and<space>their<space>corresponding<space>indices<lf><lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE ConvertDayToUnix_7_OUTPUT         }
# -------------------------------------------------------------------------
MACRO GetAllDataFromLatestDayFraser_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 60 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { GetAllDataFromLatestDayFraser }    INPUT  FEATURE_TYPE ConvertDayToUnix_7_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,SELECT<space>DISTINCT<space>*<lf>FROM<space><openbracket>dbo<closebracket>.<openbracket>FraserParkade_Occupancy<closebracket><lf>WHERE<space>TimestampUnix<space><gt><space><at>Value<openparen>day_unixtimestamp<closeparen>,GetAllDataFromLatestDayFraser)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(GetAllDataFromLatestDayFraser_DIRECTIVES) }    OUTPUT { RESULT FEATURE_TYPE GetAllDataFromLatestDayFraser_RESULT        @SupplyAttributes(fme_feature_type,GetAllDataFromLatestDayFraser)         }    OUTPUT { READER_ERROR FEATURE_TYPE GetAllDataFromLatestDayFraser_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME GetAllDataFromLatestDayFraser_<Rejected> INPUT FEATURE_TYPE GetAllDataFromLatestDayFraser_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, GetAllDataFromLatestDayFraser<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { AddDayHour_7 }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE GetAllDataFromLatestDayFraser_RESULT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf>import<space>pytz<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.data<space>=<space><openbracket><closebracket><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>UTC<lf><space><space><space><space><space><space><space><space>date_time_utc<space>=<space>datetime.datetime.fromtimestamp<openparen>feature.getAttribute<openparen><apos>TimestampUnix<apos><closeparen><comma><space>tz=pytz.utc<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>datetime<space>in<space>GMT-7<lf><space><space><space><space><space><space><space><space>date_time<space>=<space>date_time_utc.astimezone<openparen>pytz.timezone<openparen><apos>Etc<solidus>GMT+7<apos><closeparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Format<space>the<space>datetime<space>object<space>to<space>a<space>string<space>in<space>yyyy-mm-dd<space>format<lf><space><space><space><space><space><space><space><space>formatted_date<space>=<space>date_time.strftime<openparen><apos>%Y-%m-%d<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>hour<space>and<space>minute<space>from<space>the<space>datetime<space>object<lf><space><space><space><space><space><space><space><space>hour_minute<space>=<space>date_time.strftime<openparen><apos>%H:%M<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>Date<apos><comma><space>formatted_date<closeparen><lf><space><space><space><space><space><space><space><space>feature.setAttribute<openparen><apos>hour_minute<apos><comma><space>hour_minute<closeparen><lf><lf><space><space><space><space><space><space><space><space>self.data.append<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE AddDayHour_7_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CalculateStatsPerDay_7 }    GROUP_BY { Date }    FLUSH_WHEN_GROUPS_CHANGE { No }    INPUT  FEATURE_TYPE AddDayHour_7_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf><lf>def<space>datetime_to_unixtimestamp<openparen>date_str<comma><space>time_str<closeparen>:<lf><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space>#<space>Parse<space>date<space>and<space>time<space>strings<lf><space><space><space><space><space><space><space><space>date_obj<space>=<space>datetime.datetime.strptime<openparen>date_str<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><lf><space><space><space><space><space><space><space><space>time_obj<space>=<space>datetime.datetime.strptime<openparen>time_str<comma><space><quote>%H:%M<quote><closeparen>.time<openparen><closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Combine<space>date<space>and<space>time<lf><space><space><space><space><space><space><space><space>datetime_combined<space>=<space>datetime.datetime.combine<openparen>date_obj<comma><space>time_obj<closeparen><lf><lf><space><space><space><space><space><space><space><space>#<space>Convert<space>to<space>Unix<space>timestamp<lf><space><space><space><space><space><space><space><space>unix_timestamp<space>=<space>int<openparen>datetime_combined.timestamp<openparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>unix_timestamp<lf><space><space><space><space>except<space>ValueError:<lf><space><space><space><space><space><space><space><space>return<space>None<lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.norm_occ<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.n<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>0<lf><space><space><space><space><space><space><space><space>self_capacity<space>=<space>0<lf><space><space><space><space><space><space><space><space>self.date<space>=<space><quote><quote><lf><space><space><space><space><space><space><space><space>self.today<space>=<space>datetime.date.today<openparen><closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.date<space>=<space>feature.getAttribute<openparen><apos>Date<apos><closeparen><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.norm_occ<space>+=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.n<space>+=<space>1<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>if<openparen>self.peak_occupancy<space><lt><space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>Vehicles<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>hour_minute<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>for<space>each<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>PythonCaller.<space>If<space>knowledge<space>of<space>all<space>input<space>Features<space>is<space>not<space>required<space>for<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>processing<comma><space>then<space>the<space>processed<space>Feature<space>can<space>be<space>emitted<space>from<space>this<space>method<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<space>Otherwise<comma><space>the<space>input<space>FME<space>Feature<space>should<space>be<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>cached<space>to<space>a<space>list<space>class<space>member<space>and<space>processed<space>in<space>process_group<openparen><closeparen><space>when<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><apos>Group<space>by<apos><space>attributes<openparen>s<closeparen><space>are<space>specified<comma><space>or<space>the<space>close<openparen><closeparen><space>method.<lf><lf><space><space><space><space><space><space><space><space><space><space><space><space>:param<space>fmeobjects.FMEFeature<space>feature:<space>FME<space>Feature<space>entering<space>the<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>transformer.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<space>datetime.datetime.strptime<openparen>self.date<comma><space><quote>%Y-%m-%d<quote><closeparen>.date<openparen><closeparen><space>!=<space>self.today:<space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.average_occupancy<space>=<space>self.norm_occ<space><solidus><space>self.n<lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>average_occupancy<apos><comma><space>int<openparen>self.average_occupancy<closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy<apos><comma><space>self.peak_occupancy<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>peak_occupancy_time<apos><comma><space>datetime_to_unixtimestamp<openparen>str<openparen>self.date<closeparen><comma><space>str<openparen>self.peak_occupancy_time<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>Capacity<apos><comma><space>self.capacity<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>date<apos><comma><space>self.date<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.peak_occupancy<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CalculateStatsPerDay_7_OUTPUT         }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { CreateSQL_Fraser }    FLUSH_WHEN_GROUPS_CHANGE { <Unused> }    INPUT  FEATURE_TYPE CalculateStatsPerDay_7_OUTPUT    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { import<space>fme<lf>import<space>fmeobjects<lf>import<space>datetime<lf>import<space>time<lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote>Template<space>Class<space>Interface:<lf><space><space><space><space>When<space>using<space>this<space>class<comma><space>make<space>sure<space>its<space>name<space>is<space>set<space>as<space>the<space>value<space>of<space>the<space><apos>Class<lf><space><space><space><space>to<space>Process<space>Features<apos><space>transformer<space>parameter.<lf><space><space><space><space><quote><quote><quote><lf><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Base<space>constructor<space>for<space>class<space>members.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>self.counter<space>=<space>self.counter<space>+<space>1<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Get<space>the<space>required<space>attributes<space>from<space>the<space>feature<lf><space><space><space><space><space><space><space><space>average_occupancy<space>=<space>feature.getAttribute<openparen><apos>average_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>capacity<space>=<space>feature.getAttribute<openparen><apos>Capacity<apos><closeparen><lf><space><space><space><space><space><space><space><space>date<space>=<space>feature.getAttribute<openparen><apos>date<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy<apos><closeparen><lf><space><space><space><space><space><space><space><space>peak_occupancy_time<space>=<space>feature.getAttribute<openparen><apos>peak_occupancy_time<apos><closeparen><lf><space><space><space><space><space><space><space><space>zone_id<space>=<space><apos>3B3F3EC1-5D84-4C80-9CAD-2CCC9A9268A4<apos><lf><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Concatenate<space>the<space>attributes<space>into<space>a<space>single<space>string<lf><space><space><space><space><space><space><space><space>feature_string<space>=<space>f<quote><apos><opencurly>date<closecurly><apos><comma><apos><opencurly>zone_id<closecurly><apos><comma><opencurly>average_occupancy<closecurly><comma><opencurly>peak_occupancy<closecurly><comma><opencurly>peak_occupancy_time<closecurly><comma><opencurly>capacity<closecurly><quote><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>#<space>Append<space>the<space>feature<space>string<space>to<space>the<space>accumulated<space>string<lf><space><space><space><space><space><space><space><space>if<space>self.accumulated_data:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>+=<space>f<quote><opencurly>feature_string<closecurly><closeparen><comma><space><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>if<openparen>self.counter<space>==<space>999<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space><quote><openparen><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.counter<space>=<space>0<lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>if<openparen>self.accumulated_data<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>is<space>called<space>once<space>all<space>the<space>FME<space>Features<space>have<space>been<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>from<space>input<openparen><closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.accumulated_data<space>=<space>self.accumulated_data<openbracket>:-3<closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>output<space>feature<space>with<space>accumulated<space>data<lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>out_feature.setAttribute<openparen><apos>accumulated_data<apos><comma><space>self.accumulated_data.strip<openparen><closeparen><closeparen><space><space>#<space>Remove<space>trailing<space>space<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>out_feature<closeparen><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>When<space><apos>Group<space>By<apos><space>attribute<openparen>s<closeparen><space>are<space>specified<comma><space>this<space>method<space>is<space>called<space><lf><space><space><space><space><space><space><space><space>once<space>all<space>the<space>FME<space>Features<space>in<space>a<space>current<space>group<space>have<space>been<space>sent<space>to<space>input<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>Features<space>sent<space>to<space>input<openparen><closeparen><space>should<space>generally<space>be<space>cached<space>for<space>group-by<space><lf><space><space><space><space><space><space><space><space>processing<space>in<space>this<space>method<space>when<space>knowledge<space>of<space>all<space>Features<space>is<space>required.<space><lf><space><space><space><space><space><space><space><space>The<space>resulting<space>Feature<openparen>s<closeparen><space>from<space>the<space>group-by<space>processing<space>should<space>be<space>emitted<space><lf><space><space><space><space><space><space><space><space>through<space>self.pyoutput<openparen><closeparen>.<lf><lf><space><space><space><space><space><space><space><space>FME<space>will<space>continue<space>calling<space>input<openparen><closeparen><space>a<space>number<space>of<space>times<space>followed<lf><space><space><space><space><space><space><space><space>by<space>process_group<openparen><closeparen><space>for<space>each<space><apos>Group<space>By<apos><space>attribute<comma><space>so<space>this<space><lf><space><space><space><space><space><space><space><space>implementation<space>should<space>reset<space>any<space>class<space>members<space>for<space>the<space>next<space>group.<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>has_support_for<openparen>self<comma><space>support_type<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>This<space>method<space>returns<space>whether<space>this<space>PythonCaller<space>supports<space>a<space>certain<space>type.<lf><space><space><space><space><space><space><space><space>The<space>only<space>supported<space>type<space>is<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM.<lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>:param<space>int<space>support_type:<space>The<space>support<space>type<space>being<space>queried.<lf><space><space><space><space><space><space><space><space>:returns:<space>True<space>if<space>the<space>passed<space>in<space>support<space>type<space>is<space>supported.<lf><space><space><space><space><space><space><space><space>:rtype:<space>bool<lf><space><space><space><space><space><space><space><space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>support_type<space>==<space>fmeobjects.FME_SUPPORT_FEATURE_TABLE_SHIM:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>this<space>is<space>set<space>to<space>return<space>True<comma><space>FME<space>will<space>pass<space>features<space>to<space>the<space>input<openparen><closeparen><space>method<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>come<space>from<space>a<space>feature<space>table<space>object.<space>This<space>allows<space>for<space>significant<space>performance<space>gains<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>when<space>processing<space>large<space>numbers<space>of<space>features.<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>To<space>enable<space>this<comma><space>the<space>following<space>conditions<space>must<space>be<space>met:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>1<closeparen><space>features<space>passed<space>into<space>the<space>input<openparen><closeparen><space>method<space>cannot<space>be<space>copied<space>or<space>cached<space>for<space>later<space>use<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>2<closeparen><space>features<space>cannot<space>be<space>read<space>or<space>modified<space>after<space>being<space>passed<space>to<space>self.pyoutput<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space>3<closeparen><space>Group<space>Processing<space>must<space>not<space>be<space>enabled<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Violations<space>will<space>cause<space>undefined<space>behavior.<lf><space><space><space><space><space><space><space><space><space><space><space><space>return<space>False<lf><space><lf><space><space><space><space><space><space><space><space>return<space>False<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE CreateSQL_Fraser_OUTPUT         }
# -------------------------------------------------------------------------
MACRO WriteNewStats_Fraser_DIRECTIVES NAMED_CONNECTION AWS_UBCParking QUERY_FEATURE_TYPES_FOR_MERGE_FILTERS Yes CREATE_FEATURE_TABLES_FROM_DATA Yes QUERY_TIMEOUT 30 APPLICATION_INTENT ReadWrite
FACTORY_DEF {*} QueryFactory    FACTORY_NAME { WriteNewStats_Fraser }    INPUT  FEATURE_TYPE CreateSQL_Fraser_OUTPUT    QUERY_SQL            { "@EvaluateExpression(FDIV,STRING_ENCODED,<semicolon>WITH<space>UniqueSource<space>AS<space><openparen><lf><space><space><space><space>SELECT<space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<lf><space><space><space><space>FROM<space><openparen><lf><space><space><space><space><space><space><space><space>SELECT<space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<comma><lf><space><space><space><space><space><space><space><space><space><space><space><space>ROW_NUMBER<openparen><closeparen><space>OVER<space><openparen>PARTITION<space>BY<space>date<comma><space>zone_id<space>ORDER<space>BY<space>peak_occupancy<closeparen><space>AS<space>row_num<lf><space><space><space><space><space><space><space><space>FROM<space><openparen>VALUES<lf><space><space><space><space><space><space><space><space><space><space><space><space><at>Value<openparen>accumulated_data<closeparen><lf><space><space><space><space><space><space><space><space><closeparen><space>AS<space>source<openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<closeparen><lf><space><space><space><space><closeparen><space>AS<space>ranked<lf><space><space><space><space>WHERE<space>row_num<space>=<space>1<lf><closeparen><lf><lf><lf>MERGE<space>INTO<space><openbracket>dbo<closebracket>.<openbracket>Daily_Occupancy_Stats<closebracket><space>AS<space>target<lf>USING<space>UniqueSource<space>AS<space>source<lf>ON<space><openparen>target.date<space>=<space>source.date<space>AND<space>target.zone_id<space>=<space>source.zone_id<closeparen><lf>WHEN<space>MATCHED<space>THEN<lf><space><space><space><space>UPDATE<space>SET<lf><space><space><space><space><space><space><space><space>target.average_occupancy<space>=<space>source.average_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy<space>=<space>source.peak_occupancy<comma><lf><space><space><space><space><space><space><space><space>target.peak_occupancy_time<space>=<space>source.peak_occupancy_time<lf>WHEN<space>NOT<space>MATCHED<space>THEN<lf><space><space><space><space>INSERT<space><openparen><space>date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>Capacity<space><closeparen><lf><space><space><space><space>VALUES<space><openparen><space>source.date<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.zone_id<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.average_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.peak_occupancy_time<comma><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space>source.Capacity<closeparen><semicolon>,WriteNewStats_Fraser)" }    READER_TYPE          { MSSQL_JDBC_NONSPATIAL_2 }    READER_DATASET       { "AWS_UBCParking" }    COMBINE_ATTRIBUTES   { RESULT_ONLY }    IGNORE_NULLS         { <Unused> }    COMBINE_GEOMETRY     { QUERY_ONLY }    QUERYFCT_OUTPUT      { "BASED_ON_CONNECTIONS" }    CONTINUE_ON_READER_ERROR YES    QUERYFCT_PROPAGATE_IDS_ON_SQL_EXECUTE YES    READER_PARAMS        { $(WriteNewStats_Fraser_DIRECTIVES) }    OUTPUT { READER_ERROR FEATURE_TYPE WriteNewStats_Fraser_<REJECTED>         }
DEFAULT_MACRO _WB_BYPASS_TERMINATION No
FACTORY_DEF * TeeFactory FACTORY_NAME WriteNewStats_Fraser_<Rejected> INPUT FEATURE_TYPE WriteNewStats_Fraser_<REJECTED>  NO_LOGGING   OUTPUT FAILED FEATURE_TYPE * @Abort(ENCODED, WriteNewStats_Fraser<space>output<space>a<space><lt>Rejected<gt><space>feature.<space><space>To<space>continue<space>translation<space>when<space>features<space>are<space>rejected<comma><space>change<space><apos>Workspace<space>Parameters<apos><space><gt><space>Translation<space><gt><space><apos>Rejected<space>Feature<space>Handling<apos><space>to<space><apos>Continue<space>Translation<apos>)
# -------------------------------------------------------------------------

FACTORY_DEF * RoutingFactory FACTORY_NAME "Destination Feature Type Routing Correlator"   COMMAND_PARM_EVALUATION SINGLE_PASS   INPUT FEATURE_TYPE *   FEATURE_TYPE_ATTRIBUTE __wb_out_feat_type__   OUTPUT ROUTED FEATURE_TYPE *    OUTPUT NOT_ROUTED FEATURE_TYPE __nuke_me__ @Tcl2("FME_StatMessage 818059 [FME_GetAttribute fme_template_feature_type] 818060 818061 fme_warn")
# -------------------------------------------------------------------------

FACTORY_DEF * TeeFactory   FACTORY_NAME "Final Output Nuker"   INPUT FEATURE_TYPE __nuke_me__

